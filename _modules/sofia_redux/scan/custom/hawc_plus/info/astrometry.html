<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sofia_redux.scan.custom.hawc_plus.info.astrometry &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/plot_directive.css" />
    
    <script src="../../../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../../../../../" id="documentation_options" src="../../../../../../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../../../../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../../../../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../../../../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../../../../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sofia_redux.scan.custom.hawc_plus.info.astrometry</h1><div class="highlight"><pre>
<span></span># Licensed under a 3-clause BSD style license - see LICENSE.rst

from astropy import log

from sofia_redux.scan.custom.sofia.info.astrometry import SofiaAstrometryInfo
from sofia_redux.scan.coordinate_systems.equatorial_coordinates import \
    EquatorialCoordinates
from sofia_redux.scan.coordinate_systems.epoch.epoch import Epoch

__all__ = [&#39;HawcPlusAstrometryInfo&#39;]


<div class="viewcode-block" id="HawcPlusAstrometryInfo"><a class="viewcode-back" href="../../../../../../api/sofia_redux.scan.custom.hawc_plus.info.astrometry.HawcPlusAstrometryInfo.html#sofia_redux.scan.custom.hawc_plus.info.astrometry.HawcPlusAstrometryInfo">[docs]</a>class HawcPlusAstrometryInfo(SofiaAstrometryInfo):

    def __init__(self):
        &quot;&quot;&quot;
        Initialize astrometry information for HAWC+ observations.

        An extension of the SOFIA astrometry information with additional
        handling for nonsidereal coordinates.
        &quot;&quot;&quot;
        super().__init__()

<div class="viewcode-block" id="HawcPlusAstrometryInfo.apply_configuration"><a class="viewcode-back" href="../../../../../../api/sofia_redux.scan.custom.hawc_plus.info.astrometry.HawcPlusAstrometryInfo.html#sofia_redux.scan.custom.hawc_plus.info.astrometry.HawcPlusAstrometryInfo.apply_configuration">[docs]</a>    def apply_configuration(self):
        &quot;&quot;&quot;
        Update astrometry information with the FITS header configuration data.

        Additionally populates the object coordinates from the OBJRA and
        OBJDEC keywords in the configuration the EQUINOX epoch from the FITS
        header.  Non-sidereal observations may be flagged using the NONSIDE
        keyword or by setting rtoc=True in the configuration.

        Returns
        -------
        None
        &quot;&quot;&quot;
        if self.configuration is None:
            return
        options = self.options
        if options is None:  # pragma: no cover
            return

        if &#39;OBJRA&#39; in self.configuration and &#39;OBJDEC&#39; in self.configuration:
            self.object_coordinates = EquatorialCoordinates(
                epoch=Epoch.get_epoch(options.get_float(&quot;EQUINOX&quot;)))
            self.object_coordinates.ra = options.get_hms_time(
                &quot;OBJRA&quot;, angle=True)
            self.object_coordinates.dec = options.get_dms_angle(&quot;OBJDEC&quot;)

        super().apply_configuration()

        self.is_nonsidereal |= options.get_bool(&quot;NONSIDE&quot;)
        self.is_nonsidereal |= self.configuration.get_bool(&#39;rtoc&#39;)</div>

<div class="viewcode-block" id="HawcPlusAstrometryInfo.is_requested_valid"><a class="viewcode-back" href="../../../../../../api/sofia_redux.scan.custom.hawc_plus.info.astrometry.HawcPlusAstrometryInfo.html#sofia_redux.scan.custom.hawc_plus.info.astrometry.HawcPlusAstrometryInfo.is_requested_valid">[docs]</a>    def is_requested_valid(self, header=None):
        &quot;&quot;&quot;
        Check whether the requested OBSRA/DEC values in the header are valid.

        Parameters
        ----------
        header : astropy.io.fits.header.Header, optional
            The header to read.  If not supplied, the FITS header for the scan
            will be read instead.

        Returns
        -------
        valid : bool
        &quot;&quot;&quot;
        if not super().is_requested_valid(header=header):
            return False
        if header is None:
            if self.options is None:  # pragma: no cover
                return False
            ra = self.options.get_float(&#39;OBSRA&#39;)
            dec = self.options.get_float(&#39;OBSDEC&#39;)
        else:
            ra = header.get(&#39;OBSRA&#39;)
            dec = header.get(&#39;OBSDEC&#39;)

        if ra == 1 and dec == 2:
            return False
        return True</div>

<div class="viewcode-block" id="HawcPlusAstrometryInfo.guess_reference_coordinates"><a class="viewcode-back" href="../../../../../../api/sofia_redux.scan.custom.hawc_plus.info.astrometry.HawcPlusAstrometryInfo.html#sofia_redux.scan.custom.hawc_plus.info.astrometry.HawcPlusAstrometryInfo.guess_reference_coordinates">[docs]</a>    def guess_reference_coordinates(self, header=None, telescope=None):
        &quot;&quot;&quot;
        Guess the reference coordinates of a scan.

        Parameters
        ----------
        header : astropy.io.fits.Header, optional
            The header to read.  The default is to read stored OBSRA/OBSDEC
            values in the configuration.
        telescope : SofiaTelescopeInfo, optional
            A telescope object to extract the boresight equatorial coordinates
            if all other avenues to the coordinates failed.

        Returns
        -------
        coordinates : EquatorialCoordinates
        &quot;&quot;&quot;
        if self.is_nonsidereal:
            log.info(&quot;Referencing images to real-time object coordinates.&quot;)
            return
        return super().guess_reference_coordinates(header=header,
                                                   telescope=telescope)</div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>