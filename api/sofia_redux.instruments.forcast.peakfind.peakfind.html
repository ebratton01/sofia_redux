<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>peakfind &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PeakFinder" href="sofia_redux.instruments.forcast.peakfind.PeakFinder.html" />
    <link rel="prev" title="hdmerge" href="sofia_redux.instruments.forcast.hdmerge.hdmerge.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.instruments.forcast.peakfind.PeakFinder.html" title="PeakFinder">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.instruments.forcast.hdmerge.hdmerge.html" title="hdmerge">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/flitecam/developers/developers.html" accesskey="U">FLITECAM Redux Developer’s Manual</a> &#187;</li>
      
      <li>peakfind</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="peakfind">
<h1>peakfind<a class="headerlink" href="#peakfind" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.instruments.forcast.peakfind.peakfind">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.instruments.forcast.peakfind.</span></span><span class="sig-name descname"><span class="pre">peakfind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coadded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newimage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npeaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharplo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharphi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roundlo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roundhi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chopnoddist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_object</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/forcast/peakfind.html#peakfind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.forcast.peakfind.peakfind" title="Permalink to this definition">¶</a></dt>
<dd><p>Find peaks (stars) in FORCAST images</p>
<p>Identifies the desired number of peaks in the image using the DAO
search algorithm followed by optional (default=True) Levenberg-
Marquardt least squares fitting of a gaussian psf to refine the
fit.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>coadded</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Reference image to find peak positions</p>
</dd>
<dt><strong>newimage</strong><span class="classifier">numpy.ndarray, optional</span></dt><dd><p>Secondary image to compare to coadded.  If provided, the return
value will be the shifts required to move the sources in newimage
onto the sources in coadded.  If not provided, the return value
is the positions of the peaks in coadded</p>
</dd>
<dt><strong>refine</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, the x, y coordinates are fine tuned by fitting a
Gaussian to the profile of each found center</p>
</dd>
<dt><strong>npeaks</strong><span class="classifier">int, optional</span></dt><dd><p>Number of peaks to find; usually determined from the chop/nod
mode</p>
</dd>
<dt><strong>fwhm</strong><span class="classifier">float, optional</span></dt><dd><p>Expected FWHM in pixels</p>
</dd>
<dt><strong>roundlo</strong><span class="classifier">float, optional</span></dt><dd><p>The lower bound on roundness for object detection</p>
</dd>
<dt><strong>roundhi</strong><span class="classifier">float, optional</span></dt><dd><p>The upper bound on roundness for object detection</p>
</dd>
<dt><strong>sharplo</strong><span class="classifier">float, optional</span></dt><dd><p>The lower bound on sharpness for object detection</p>
</dd>
<dt><strong>sharphi</strong><span class="classifier">float, optional</span></dt><dd><p>The upper bound on sharpness for object detection</p>
</dd>
<dt><strong>silent</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, output will be suppressed</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum number of iterations for iteratefind</p>
</dd>
<dt><strong>epsilon</strong><span class="classifier">int or float, optional</span></dt><dd><p>Maximum nod/chop deviation for exclusion in chopnod_sort</p>
</dd>
<dt><strong>eps</strong><span class="classifier">float, optional</span></dt><dd><p>Precision to terminate iteration</p>
</dd>
<dt><strong>ncut</strong><span class="classifier">int, optional</span></dt><dd><p>Positive integer cutout region used for Gaussian fitting
(pixels)</p>
</dd>
<dt><strong>chopnoddist</strong><span class="classifier">(list or tuple) of float, optional</span></dt><dd><p>If provided, will be used to identify the expected positions of the
peaks and prioritize those that are nearest to where they should be.
Format is [chop distance, nod distance]</p>
</dd>
<dt><strong>positive</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, only positive peaks will be returned.</p>
</dd>
<dt><strong>smooth</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, the data will be smoothed before searching for peaks.</p>
</dd>
<dt><strong>return_object</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, return the PeakFinder object rather than the DataFrame</p>
</dd>
<dt><strong>coordinates</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, return tuples of (x, y) coordinates as a list</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt>pandas.DataFrame or PeakFinder or list</dt><dd><p>The default DataFrame represents either shift_image distances to
move newimage on top of coadded, or positions of the peaks
in coadded if newimage was not supplied as an input parameter.
The PeakFinder object contains lots of useful little attributes
such as the fits, tables and models of coadded and newimage.</p>
<p>If coordinates=True, a list of (x, y) coordinates will be
returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">peakfind</a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.forcast.peakfind.peakfind"><code class="docutils literal notranslate"><span class="pre">peakfind()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.instruments.forcast.peakfind.peakfind.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>