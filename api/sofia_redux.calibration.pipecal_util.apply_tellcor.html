<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>apply_tellcor &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="run_photometry" href="sofia_redux.calibration.pipecal_util.run_photometry.html" />
    <link rel="prev" title="get_tellcor_factor" href="sofia_redux.calibration.pipecal_util.get_tellcor_factor.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.calibration.pipecal_util.run_photometry.html" title="run_photometry">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.calibration.pipecal_util.get_tellcor_factor.html" title="get_tellcor_factor">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/flitecam/developers/developers.html" accesskey="U">FLITECAM Redux Developer’s Manual</a> &#187;</li>
      
      <li>apply_tellcor</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="apply-tellcor">
<h1>apply_tellcor<a class="headerlink" href="#apply-tellcor" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.calibration.pipecal_util.apply_tellcor">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.calibration.pipecal_util.</span></span><span class="sig-name descname"><span class="pre">apply_tellcor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_wv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/calibration/pipecal_util.html#apply_tellcor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.calibration.pipecal_util.apply_tellcor" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a telluric correction factor to an image.</p>
<p>The image is corrected as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>corrected = flux * tel_factor
</pre></div>
</div>
<p>If provided, the variance and/or covariance are propagated
as well, as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>corrected_variance = variance * tel_factor^2
corrected_covariance = covariance / tel_factor^2
</pre></div>
</div>
<p>The provided header is also updated with relevant keywords and
a history message.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>data</strong><span class="classifier">array</span></dt><dd><p>Image to correct.</p>
</dd>
<dt><strong>header</strong><span class="classifier"><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v5.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits.header.Header</span></code></a></span></dt><dd><p>FITS header to update.</p>
</dd>
<dt><strong>config</strong><span class="classifier">dict-like</span></dt><dd><p>Calibration configuration values, as produced by
<code class="xref py py-obj docutils literal notranslate"><span class="pre">pipecal.pipecal_config.pipecal_config</span></code>.</p>
</dd>
<dt><strong>variance</strong><span class="classifier">array, optional</span></dt><dd><p>Variance image to propagate, if desired.</p>
</dd>
<dt><strong>covariance</strong><span class="classifier">array, optional</span></dt><dd><p>Covariance image to propagate, if desired.</p>
</dd>
<dt><strong>use_wv</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, precipitable water vapor will be used as the
reference value, instead of altitude.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>array, or 2- or 3-length tuple</dt><dd><p>If only data is provided, it is returned as an array.
If variance is provided, the return value is (data, variance).
If covariance is provided, the return value is
(data, variance, covariance); if the variance was not provided,
it will be set to None.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>PipeCalError</dt><dd><p>If no valid telluric correction factor is found.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">apply_tellcor</a><ul>
<li><a class="reference internal" href="#sofia_redux.calibration.pipecal_util.apply_tellcor"><code class="docutils literal notranslate"><span class="pre">apply_tellcor()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.calibration.pipecal_util.apply_tellcor.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>