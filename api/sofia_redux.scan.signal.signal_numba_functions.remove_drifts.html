<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>remove_drifts &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="get_covariance" href="sofia_redux.scan.signal.signal_numba_functions.get_covariance.html" />
    <link rel="prev" title="level" href="sofia_redux.scan.signal.signal_numba_functions.level.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.scan.signal.signal_numba_functions.get_covariance.html" title="get_covariance">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.scan.signal.signal_numba_functions.level.html" title="level">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../sofia_redux/scan/index.html" accesskey="U">sofia_redux.scan: Scan Mode Algorithms for SOFIA Pipelines</a> &#187;</li>
      
      <li>remove_drifts</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="remove-drifts">
<h1>remove_drifts<a class="headerlink" href="#remove-drifts" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal_numba_functions.remove_drifts">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.scan.signal.signal_numba_functions.</span></span><span class="sig-name descname"><span class="pre">remove_drifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal_numba_functions.html#remove_drifts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal_numba_functions.remove_drifts" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove drifts (average signal levels in a frame block) from the signal.</p>
<p>Performs <a class="reference internal" href="sofia_redux.scan.signal.signal_numba_functions.level.html#sofia_redux.scan.signal.signal_numba_functions.level" title="sofia_redux.scan.signal.signal_numba_functions.level"><code class="xref py py-func docutils literal notranslate"><span class="pre">level()</span></code></a> sequentially over <code class="xref py py-obj docutils literal notranslate"><span class="pre">n_frames</span></code> length blocks of the
signal and updates the drift values accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>signal_values</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The signal values of shape (n_signal,)</p>
</dd>
<dt><strong>drifts</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The drift values.  These will be updated by incrementing the given
values by the average signal value removed in each drift.  The number
of drifts is also determined by the size of this array (n_drifts,).</p>
</dd>
<dt><strong>n_frames</strong><span class="classifier">int</span></dt><dd><p>The number of frames in each drift.</p>
</dd>
<dt><strong>resolution</strong><span class="classifier">int</span></dt><dd><p>The number of frames applicable to each signal value.</p>
</dd>
<dt><strong>integration_size</strong><span class="classifier">int</span></dt><dd><p>The total number of frames in the integration belonging to the signal.</p>
</dd>
<dt><strong>signal_weights</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>The optional signal weights.  If supplied, these will be used to
determine a weighted mean/median values for each drift.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, determine average signal values using the median value.
Otherwise, uses the mean value.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">remove_drifts</a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal_numba_functions.remove_drifts"><code class="docutils literal notranslate"><span class="pre">remove_drifts()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.scan.signal.signal_numba_functions.remove_drifts.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>