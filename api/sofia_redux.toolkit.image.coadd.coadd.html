<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>coadd &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="combine_images" href="sofia_redux.toolkit.image.combine.combine_images.html" />
    <link rel="prev" title="upsampled_dft" href="sofia_redux.toolkit.image.adjust.upsampled_dft.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.toolkit.image.combine.combine_images.html" title="combine_images">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.toolkit.image.adjust.upsampled_dft.html" title="upsampled_dft">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/exes/developers/developers.html" accesskey="U">EXES Redux Developer’s Manual</a> &#187;</li>
      
      <li>coadd</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="coadd">
<h1>coadd<a class="headerlink" href="#coadd" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.toolkit.image.coadd.coadd">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.toolkit.image.coadd.</span></span><span class="sig-name descname"><span class="pre">coadd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cube</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcskey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'first'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/image/coadd.html#coadd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.image.coadd.coadd" title="Permalink to this definition">¶</a></dt>
<dd><p>Coadd total intensity or spectral images.</p>
<p>The WCS is used to transform images into a common coordinate
system.  By default, the reference field is the WCS for the first
data set provided.  Optionally, the reference may be corrected
for target position motion, as for a non-sidereal target.</p>
<p>For coadd methods ‘mean’ or ‘median’, each image is interpolated into
the reference frame, then all images are combined using the chosen
statistic.  Note that this method may be memory-intensive for large
fields.  The coadd method ‘resample’ uses locally weighted polynomial
surface fits to resample data onto the output grid
(see <a class="reference internal" href="../sofia_redux/toolkit/index.html#module-sofia_redux.toolkit.resampling" title="sofia_redux.toolkit.resampling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.toolkit.resampling</span></code></a> for more information).  Exposure
maps are always generated by interpolating and summing individual maps.</p>
<p>The output may be either a 2D image, for either spectral or imaging
data, or a 3D spectral cube (cube = True).  If cube is set, then the
method is always ‘resample’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>hdr_list</strong><span class="classifier">list of astropy.io.fits.Header</span></dt><dd><p>List of headers associated with the data to combine.
The first header in the list is used as the reference.</p>
</dd>
<dt><strong>data_list</strong><span class="classifier">list of numpy.ndarray of float</span></dt><dd><p>List of flux arrays to combine.</p>
</dd>
<dt><strong>var_list</strong><span class="classifier">list of numpy.ndarray of float</span></dt><dd><p>List of variance arrays associated with flux arrays.</p>
</dd>
<dt><strong>exp_list</strong><span class="classifier">list of numpy.ndarray of float</span></dt><dd><p>List of exposure time maps associated with the flux arrays.</p>
</dd>
<dt><strong>method</strong><span class="classifier">{‘mean’, ‘median’, ‘resample’}, optional</span></dt><dd><p>Method for combining data into the output map.  For ‘mean’ or
‘median’, data is interpolated into the output grid, then
combined with the selected statistic.  For ‘resample’, data
are sampled onto the output grid with locally weighted polynomial
fits.</p>
</dd>
<dt><strong>weighted</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, input flux values will be weighted by the variance values,
for ‘mean’ or ‘resample’ methosds.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, input flux values will be sigma-clipped before combining,
for ‘mean’ or ‘median’ methods.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">float, optional</span></dt><dd><p>The sigma value to use for clipping if the <code class="xref py py-obj docutils literal notranslate"><span class="pre">robust</span></code> option is set.</p>
</dd>
<dt><strong>maxiters</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum number of sigma-clipping iterations to use if the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">robust</span></code> option is set.</p>
</dd>
<dt><strong>spectral</strong><span class="classifier">bool, optional</span></dt><dd><p>If not set, any dimensions higher than 2 in the input WCS will
be ignored. This is required for compatibility with old-style
FORCAST imaging data (pipeline version &lt; 2.0).</p>
</dd>
<dt><strong>cube</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, spectral data is assembled into a 3D cube (nw, ny, nx)
instead of a 2D spectral image (nw, ny).</p>
</dd>
<dt><strong>wcskey</strong><span class="classifier">str, optional</span></dt><dd><p>Indicates the WCS to use for assembling data.  If ‘ ‘, the primary
WCS is used.  For spectral data, the alternate WCS with key ‘A’
is expected.</p>
</dd>
<dt><strong>rotate</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, data is rotated to set North up and East left, in RA/Dec
coordinates.  This option is not recommended for 2D spectral images.</p>
</dd>
<dt><strong>fit_order</strong><span class="classifier">int, optional</span></dt><dd><p>The polynomial fit order to use with the ‘resample’ method.</p>
</dd>
<dt><strong>window</strong><span class="classifier">float, optional</span></dt><dd><p>The local fitting window (in pixels) to use  with the ‘resample’
method.</p>
</dd>
<dt><strong>smoothing</strong><span class="classifier">float, optional</span></dt><dd><p>The Gaussian smoothing radius (in pixels) to use  with the ‘resample’
method.</p>
</dd>
<dt><strong>adaptive_algorithm</strong><span class="classifier">{‘scaled’, ‘shaped’, None}, optional</span></dt><dd><p>Algorithm for adaptive smoothing kernel.  If scaled, only the
size is allowed to vary.  If shaped, the kernel shape and
rotation may also vary.</p>
</dd>
<dt><strong>edge_threshold</strong><span class="classifier">float, optional</span></dt><dd><p>Used to determine how much of the image edges should be masked,
Specified as a fraction of the fit window; lower values clip more
pixels.</p>
</dd>
<dt><strong>reference</strong><span class="classifier">{‘first’, ‘target’}, optional</span></dt><dd><p>If set to ‘target’, the output coordinates for each input file
will be corrected for target motion, as recorded in the TGTRA
and TGTDEC keywords. This is necessary to correct for the motion
of non-sidereal targets.  If TGTRA/DEC are not found, no correction
will be made.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>header</strong><span class="classifier">astropy.io.fits.Header</span></dt><dd><p>The output header with appropriate WCS.</p>
</dd>
<dt><strong>flux</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>The output flux image or cube.</p>
</dd>
<dt><strong>variance</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>The output variance image or cube.</p>
</dd>
<dt><strong>expmap</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>The exposure map associated with the flux. This array
will always be 2D, even for cube outputs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">coadd</a><ul>
<li><a class="reference internal" href="#sofia_redux.toolkit.image.coadd.coadd"><code class="docutils literal notranslate"><span class="pre">coadd()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.toolkit.image.coadd.coadd.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>