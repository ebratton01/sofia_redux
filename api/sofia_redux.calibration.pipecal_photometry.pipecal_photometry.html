<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pipecal_photometry &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reduction" href="sofia_redux.scan.reduction.reduction.Reduction.html" />
    <link rel="prev" title="ResamplePolynomial" href="sofia_redux.toolkit.resampling.ResamplePolynomial.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.scan.reduction.reduction.Reduction.html" title="Reduction">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.ResamplePolynomial.html" title="ResamplePolynomial">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/fifils/developers/developers.html" accesskey="U">FIFI-LS Redux Developer’s Manual</a> &#187;</li>
      
      <li>pipecal_photometry</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="pipecal-photometry">
<h1>pipecal_photometry<a class="headerlink" href="#pipecal-photometry" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.calibration.pipecal_photometry.pipecal_photometry">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.calibration.pipecal_photometry.</span></span><span class="sig-name descname"><span class="pre">pipecal_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srcpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">138</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stampsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'moffat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aprad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skyrad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">runits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Me/s'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stamp_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_badfit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/calibration/pipecal_photometry.html#pipecal_photometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.calibration.pipecal_photometry.pipecal_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform aperture photometry and profile fits on image data.</p>
<dl class="simple">
<dt>Procedure:</dt><dd><ol class="arabic simple">
<li><p>Take a small stamp image near the source position and fit a
profile to it to get a centroid position of the source. The
fit is performed by pipecal_fitpeak.</p></li>
<li><p>Refit a larger subimage (set by <code class="xref py py-obj docutils literal notranslate"><span class="pre">fitsize</span></code>) with pipecal_fitpeak to
get fit parameters with associated errors.</p></li>
<li><p>Call photutils to perform aperture photometry at the centroid
position.</p></li>
<li><p>Return calculated values in list of dictionaries.</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image</strong><span class="classifier">array</span></dt><dd><p>2D image array containing an object to perform photometry on.</p>
</dd>
<dt><strong>variance</strong><span class="classifier">array</span></dt><dd><p>2D variance array corresponding to image values.</p>
</dd>
<dt><strong>srcpos</strong><span class="classifier">array-like, optional</span></dt><dd><p>Initial guess at source position (x,y), zero-indexed.
Defaults to the center of the image if not provided.</p>
</dd>
<dt><strong>fitsize</strong><span class="classifier">int, optional</span></dt><dd><p>Size of subimage to fit.</p>
</dd>
<dt><strong>stampsize</strong><span class="classifier">‘auto’, int, or float, optional</span></dt><dd><p>Size of initial stamp, for peak location.  If ‘auto’, the
stamp will be derived from the fitsize.</p>
</dd>
<dt><strong>fwhm</strong><span class="classifier">float, optional</span></dt><dd><p>Initial guess at PSF FWHM.</p>
</dd>
<dt><strong>profile</strong><span class="classifier">{‘moffat’, ‘gaussian’, ‘lorentzian’}, optional</span></dt><dd><p>Type of profile to fit to image.</p>
</dd>
<dt><strong>aprad</strong><span class="classifier">float, optional</span></dt><dd><p>Aperture radius for aperture photometry.</p>
</dd>
<dt><strong>skyrad</strong><span class="classifier">array-like, optional</span></dt><dd><p>Sky radii (inner, outer) for aperture photometry. Defaults
to [15.,25.] if not provided.</p>
</dd>
<dt><strong>runits</strong><span class="classifier">string, optional</span></dt><dd><p>Raw data units, before flux calibration. Used in
comment strings for some output keywords.</p>
</dd>
<dt><strong>stamp_center</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, the initial centroid position will be adjusted by
the centroid in the stamp fit. This is usually desirable,
but may sometimes result in the fit being pulled away from
the intended target, in the case of crowded fields.  If
False, the starting source position is not adjusted by
the centroid in the stamp fit before doing the full image
profile fit.</p>
</dd>
<dt><strong>allow_badfit</strong><span class="classifier">bool, optional</span></dt><dd><p>If False, failed profile fits will raise PipeCalErrors.
If True, an error will be logged, but an exception will not be
raised, and aperture photometry will still be attempted at
the initial source position.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>phot</strong><span class="classifier">list</span></dt><dd><p>List containing photometric measurements values. Each value
stored in a dictionary with fields ‘key’, ‘value’, and
‘comment’. If the value has an associated error, it is stored
in ‘value’ as a two-element array, where the first element is
the value and the second element is the error.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>PipeCalError</dt><dd><p>For any improperly set parameters or for failed fit.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">pipecal_photometry</a><ul>
<li><a class="reference internal" href="#sofia_redux.calibration.pipecal_photometry.pipecal_photometry"><code class="docutils literal notranslate"><span class="pre">pipecal_photometry()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.calibration.pipecal_photometry.pipecal_photometry.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>