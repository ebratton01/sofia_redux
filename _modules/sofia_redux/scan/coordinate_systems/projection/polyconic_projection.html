<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sofia_redux.scan.coordinate_systems.projection.polyconic_projection &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/plot_directive.css" />
    
    <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../../../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../../../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../../../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../../../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sofia_redux.scan.coordinate_systems.projection.polyconic_projection</h1><div class="highlight"><pre>
<span></span># Licensed under a 3-clause BSD style license - see LICENSE.rst

from astropy import units
import numpy as np

from sofia_redux.scan.coordinate_systems.projection.spherical_projection \
    import SphericalProjection
from sofia_redux.scan.coordinate_systems.coordinate_2d import Coordinate2D

__all__ = [&#39;PolyconicProjection&#39;]


<div class="viewcode-block" id="PolyconicProjection"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.polyconic_projection.PolyconicProjection.html#sofia_redux.scan.coordinate_systems.projection.polyconic_projection.PolyconicProjection">[docs]</a>class PolyconicProjection(SphericalProjection):

    def __init__(self):
        &quot;&quot;&quot;
        Initialize a polyconic projection.

        The polyconic projection is also known as the American polyconic
        projection.  Each parallel is a circular arc at true scale with a
        straight equator and the center of each circle lying on the central
        axis.  The longitude of the central meridian lies at zero, with the
        latitude of the origin at the central meridian also equal to zero.

        Notes
        -----
        Deprojection is not possible for the polyconic projection.
        &quot;&quot;&quot;
        super().__init__()

<div class="viewcode-block" id="PolyconicProjection.get_fits_id"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.polyconic_projection.PolyconicProjection.html#sofia_redux.scan.coordinate_systems.projection.polyconic_projection.PolyconicProjection.get_fits_id">[docs]</a>    @classmethod
    def get_fits_id(cls):
        &quot;&quot;&quot;
        Return the FITS ID for the projection.

        Returns
        -------
        str
        &quot;&quot;&quot;
        return &quot;PCO&quot;</div>

<div class="viewcode-block" id="PolyconicProjection.get_full_name"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.polyconic_projection.PolyconicProjection.html#sofia_redux.scan.coordinate_systems.projection.polyconic_projection.PolyconicProjection.get_full_name">[docs]</a>    @classmethod
    def get_full_name(cls):
        &quot;&quot;&quot;
        Return the full name of the projection.

        Returns
        -------
        str
        &quot;&quot;&quot;
        return &#39;Polyconic&#39;</div>

<div class="viewcode-block" id="PolyconicProjection.get_phi_theta"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.polyconic_projection.PolyconicProjection.html#sofia_redux.scan.coordinate_systems.projection.polyconic_projection.PolyconicProjection.get_phi_theta">[docs]</a>    def get_phi_theta(self, offset, phi_theta=None):
        &quot;&quot;&quot;
        Return the phi (longitude) and theta (latitude) coordinates.

        The phi and theta coordinates refer to the inverse projection
        (deprojection) of projected offsets about the native pole.  phi is
        the deprojected longitude, and theta is the deprojected latitude of
        the offsets.  This method is not implemented for the polyconic
        projection.

        Parameters
        ----------
        offset : Coordinate2D
        phi_theta : SphericalCoordinates, optional
            An optional output coordinate system in which to place the results.

        Returns
        -------
        coordinates : SphericalCoordinates
        &quot;&quot;&quot;
        raise NotImplementedError(
            f&quot;Deprojection not implemented for {self.__class__} projection.&quot;)</div>

<div class="viewcode-block" id="PolyconicProjection.get_offsets"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.polyconic_projection.PolyconicProjection.html#sofia_redux.scan.coordinate_systems.projection.polyconic_projection.PolyconicProjection.get_offsets">[docs]</a>    def get_offsets(self, theta, phi, offsets=None):
        &quot;&quot;&quot;
        Get the offsets given theta and phi.

        Takes the theta (latitude) and phi (longitude) coordinates about the
        celestial pole and converts them to offsets from a reference position.
        For the polyconic projection when theta is non-zero, this is given by:

            x = cot(theta) * sin(phi * sin(theta))
            y = theta + cot(theta) * (1 - cos(phi * sin(theta)))

        If theta is equal to zero, then to avoid zero division:

            x = phi
            y = 0

        Parameters
        ----------
        theta : units.Quantity or float
            The theta (latitude) angle.  If a float value is provided, it
            should be in radians.
        phi : units.Quantity or float
            The phi (longitude) angle.  If a float value is provided, it should
            be in radians.
        offsets : Coordinate2D, optional
            An optional coordinate system in which to place the results.

        Returns
        -------
        offsets : Coordinate2D
        &quot;&quot;&quot;
        if offsets is None:
            offsets = Coordinate2D(unit=&#39;degree&#39;)

        phi, theta = self.phi_theta_to_radians(phi, theta)
        rad = units.Unit(&#39;radian&#39;)
        if theta == 0:
            x = phi
            y = 0 * rad
        else:
            cot_theta = 1 / np.tan(theta)
            t = phi * np.sin(theta)
            x = cot_theta * np.sin(t) * rad
            dy = cot_theta * (1.0 - np.cos(t)) * rad
            y = theta + dy

        offsets.set([x, y])
        return offsets</div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>