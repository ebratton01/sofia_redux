<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ResamplePolynomial &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pipecal_photometry" href="sofia_redux.calibration.pipecal_photometry.pipecal_photometry.html" />
    <link rel="prev" title="ResampleKernel" href="sofia_redux.toolkit.resampling.ResampleKernel.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.calibration.pipecal_photometry.pipecal_photometry.html" title="pipecal_photometry">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.ResampleKernel.html" title="ResampleKernel">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/fifils/developers/developers.html" accesskey="U">FIFI-LS Redux Developer’s Manual</a> &#187;</li>
      
      <li>ResamplePolynomial</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="resamplepolynomial">
<h1>ResamplePolynomial<a class="headerlink" href="#resamplepolynomial" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResamplePolynomial">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sofia_redux.toolkit.resampling.</span></span><span class="sig-name descname"><span class="pre">ResamplePolynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negthresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_estimate_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_estimate_percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_estimate_oversample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">large_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_buffer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">distance_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_polynomial.html#ResamplePolynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResamplePolynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ResampleBase</span></code></p>
<p>Class to resample data using local polynomial fits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>coordinates</strong><span class="classifier">array_like of float</span></dt><dd><p>(n_features, n_samples) array of independent values.  A local
internal copy will be created if it is not a numpy.float64
type.</p>
</dd>
<dt><strong>data</strong><span class="classifier">array_like of float</span></dt><dd><p>(n_sets, n_samples) or (n_samples,) array of dependent values.
multiple (n_sets) sets of data are supplied, then n_sets solutions
will be calculated at each resampling point.</p>
</dd>
<dt><strong>error</strong><span class="classifier">array_like of float, optional</span></dt><dd><p>(n_sets, n_samples) or (n_samples,) array of error (1-sigma) values
associated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code> array.  <code class="xref py py-obj docutils literal notranslate"><span class="pre">error</span></code> will be used to
weight fits, and be propagated to the output error values.  If not
supplied, the error may still be calculated from residuals to the
fit during <a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.__call__" title="sofia_redux.toolkit.resampling.ResamplePolynomial.__call__"><code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.__call__()</span></code></a>.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">array_like of bool, optional</span></dt><dd><p>(n_sets, n_data) or (n_data,) array of bool where <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>
indicates a valid data point that can be included the fitting
and <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> indicates data points that should be excluded from
the fit.  Masked points will be reflected in the output counts
array.  If not supplied, all samples are considered valid.</p>
</dd>
<dt><strong>window</strong><span class="classifier">array_like or float or int, optional</span></dt><dd><p>(n_features,) array or single value specifying the maximum
distance (distance definition is handled by <code class="xref py py-obj docutils literal notranslate"><span class="pre">distance_kwargs</span></code>) of a
data sample from a resampling point such that it can be included in
a local fit.  <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code> may be declared for each feature.  For
example, when fitting 2-dimensional (x, y) data, a window of 1.0
would create a circular fitting window around each resampling
point, whereas a window of (1.0, 0.5) would create an elliptical
fitting window with a semi-major axis of 1.0 in x and semi-minor
axis of 0.5 in y.  If not supplied, <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code> is estimated via
<code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.estimate_feature_windows()</span></code>.</p>
</dd>
<dt><strong>order</strong><span class="classifier">array_like or int, optional</span></dt><dd><p>(n_features,) array or single integer value specifying the
polynomial fit order for each feature.</p>
</dd>
<dt><strong>fix_order</strong><span class="classifier">bool, optional</span></dt><dd><p>In order for local polynomial fitting to occur, the basic
requirement is that n_samples &gt;= (order + 1) ** n_features,
where n_samples is the number of data samples within <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code>.
If <code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_order</span></code> is True and this condition is not met, then
local fitting will be aborted for that point, and a value of
<code class="xref py py-obj docutils literal notranslate"><span class="pre">cval</span></code> will be returned instead.  If <code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_order</span></code> is False,
then <a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.order" title="sofia_redux.toolkit.resampling.ResamplePolynomial.order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code></a> will be reduced to the maximum value where this
condition can be met.  NOTE: this is only available if
<a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.order" title="sofia_redux.toolkit.resampling.ResamplePolynomial.order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code></a> is symmetrical. i.e. it was passed in as a single
integer to be applied across all features.  Otherwise, it is
unclear as to which feature order should be reduced to meet
the condition.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">float, optional</span></dt><dd><p>Specifies an outlier rejection threshold for <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code>. A data point
is identified as an outlier if abs(x_i - x_med)/MAD &gt; robust, where
x_med is the median, and MAD is the Median Absolute Deviation
defined as 1.482 * median(abs(x_i - x_med)).</p>
</dd>
<dt><strong>negthresh</strong><span class="classifier">float, optional</span></dt><dd><p>Specifies a negative value rejection threshold such that
data &lt; (-stddev(data) * negthresh) will be excluded from the fit.</p>
</dd>
<dt><strong>window_estimate_bins</strong><span class="classifier">int, optional</span></dt><dd><p>Used to estimate the <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code> if not supplied using
<code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.estimate_feature_windows()</span></code>.</p>
</dd>
<dt><strong>window_estimate_percentile</strong><span class="classifier">int or float, optional</span></dt><dd><p>Used to estimate the <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code> if not supplied using
<code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.estimate_feature_windows()</span></code>.</p>
</dd>
<dt><strong>window_estimate_oversample</strong><span class="classifier">int or float, optional</span></dt><dd><p>Used to estimate the <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code> if not supplied using
<code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.estimate_feature_windows()</span></code>.</p>
</dd>
<dt><strong>leaf_size</strong><span class="classifier">int, optional</span></dt><dd><p>Number of points at which to switch to brute-force during the
ball tree query algorithm.  See <code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.neighbours.BallTree</span></code>
for further details.</p>
</dd>
<dt><strong>large_data</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that this resampling algorithm will run on
a large set of data, and the ball tree should be created on
subsets of the data.</p>
</dd>
<dt><strong>check_memory</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, check the memory requirements for resampling the
supplied data.</p>
</dd>
<dt><strong>memory_buffer</strong><span class="classifier">float, optional</span></dt><dd><p>A fraction (positive or negative) with which to modify the memory
estimates for the process memory requirements.  Memory estimates
are scaled by the factor 1 + memory_buffer.</p>
</dd>
<dt><strong>distance_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Optional keyword arguments passed into
<code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.neighbors.DistanceMetric()</span></code>.  The default is to use
the “minkowski” definition with <code class="xref py py-obj docutils literal notranslate"><span class="pre">p=2</span></code>, i.e., the Euclidean
definition.  This is important in determining which samples lie
inside the window region of a resampling point, and when deriving
distance weighting factors.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ValueError</strong><span class="classifier">Invalid inputs to __init__ or __call__</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Attributes Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.fit_tree" title="sofia_redux.toolkit.resampling.ResamplePolynomial.fit_tree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_tree</span></code></a></p></td>
<td><p>Return the fitting tree representative of points to fit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.order" title="sofia_redux.toolkit.resampling.ResamplePolynomial.order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code></a></p></td>
<td><p>Return the order of polynomial fit.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.__call__" title="sofia_redux.toolkit.resampling.ResamplePolynomial.__call__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code></a>(*args[, smoothing, ...])</p></td>
<td><p>Resample data defined during initialization to new coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.calculate_adaptive_smoothing" title="sofia_redux.toolkit.resampling.ResamplePolynomial.calculate_adaptive_smoothing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_adaptive_smoothing</span></code></a>(settings)</p></td>
<td><p>Calculate the adaptive distance weighting kernel.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.calculate_minimum_points" title="sofia_redux.toolkit.resampling.ResamplePolynomial.calculate_minimum_points"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_minimum_points</span></code></a>()</p></td>
<td><p>Return the minimum number of points for a polynomial fit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.check_order" title="sofia_redux.toolkit.resampling.ResamplePolynomial.check_order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_order</span></code></a>(order, n_features, n_samples)</p></td>
<td><p>Check the order is of correct format and enough samples exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.pre_fit" title="sofia_redux.toolkit.resampling.ResamplePolynomial.pre_fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pre_fit</span></code></a>(settings, *args[, ...])</p></td>
<td><p>Perform pre-fitting steps and build the fitting tree.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.process_block" title="sofia_redux.toolkit.resampling.ResamplePolynomial.process_block"><code class="xref py py-obj docutils literal notranslate"><span class="pre">process_block</span></code></a>(args, block)</p></td>
<td><p>Run <a class="reference internal" href="sofia_redux.toolkit.resampling.solve_fits.html#sofia_redux.toolkit.resampling.solve_fits" title="sofia_redux.toolkit.resampling.solve_fits"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_fits()</span></code></a> on each block.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.reduction_settings" title="sofia_redux.toolkit.resampling.ResamplePolynomial.reduction_settings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reduction_settings</span></code></a>([smoothing, ...])</p></td>
<td><p>Define a set of reduction instructions based on user input.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.set_sample_tree" title="sofia_redux.toolkit.resampling.ResamplePolynomial.set_sample_tree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_sample_tree</span></code></a>(coordinates[, radius, ...])</p></td>
<td><p>Build the sample tree from input coordinates.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResamplePolynomial.fit_tree">
<span class="sig-name descname"><span class="pre">fit_tree</span></span><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.fit_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fitting tree representative of points to fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>PolynomialTree</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResamplePolynomial.order">
<span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of polynomial fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>order</strong><span class="classifier">int or numpy.ndarray (int)</span></dt><dd><p>A symmetrical order, or the order for each feature.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResamplePolynomial.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scaled'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'distribution'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bounded'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_weighting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_threading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_processes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_region_coordinates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_distance_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_rchi2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_cross_derivatives</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_offset_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_polynomial.html#ResamplePolynomial.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample data defined during initialization to new coordinates.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>args</strong><span class="classifier">array_like or n-tuple of array_like</span></dt><dd><p>args can take one of the following formats:</p>
<blockquote>
<div><ul class="simple">
<li><p>grid : n-tuple of array_like
Here <code class="xref py py-obj docutils literal notranslate"><span class="pre">n</span></code> is the number of dimensions and each array should
be of shape (n_data,).  This indicates that resampling
should occur on a grid where the first argument
corresponds to the coordinates along the first dimension.</p></li>
<li><p>single point : n-tuple of float
<code class="xref py py-obj docutils literal notranslate"><span class="pre">n</span></code> is the number of dimensions.  The coordinate to
resample onto.</p></li>
<li><p>irregular : array_like
An array of shape (n_dimensions, n_ndata) defining a
set of coordinates onto which to resample.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>smoothing</strong><span class="classifier">float or array_like of float, optional</span></dt><dd><p>If set, weights the polynomial fitting by distance from the
resampling coordinate to the sample coordinate.  The weighting
factor applied is exp(-dx^2 / <code class="xref py py-obj docutils literal notranslate"><span class="pre">smoothing</span></code>).  A value may be
defined for each dimension by providing <code class="xref py py-obj docutils literal notranslate"><span class="pre">smoothing</span></code> as an array of
shape (n_dimensions,).  However, if <code class="xref py py-obj docutils literal notranslate"><span class="pre">adaptive_threshold</span></code> &gt; 0 for a
certain feature, the corresponding smoothing element has a
different meaning.  In this case, it gives the 1-sigma uncertainty
in the coordinate position for that feature.  As a reference, for
astronomical observations using a Gaussian beam with known FWHM,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">smoothing</span></code> should be set to <code class="xref py py-obj docutils literal notranslate"><span class="pre">FWHM</span> <span class="pre">/</span> <span class="pre">(2</span> <span class="pre">*</span> <span class="pre">sqrt(2</span> <span class="pre">*</span> <span class="pre">log(2)))</span></code>
so long as adaptive weighting is enabled.</p>
</dd>
<dt><strong>relative_smooth</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the supplied <code class="xref py py-obj docutils literal notranslate"><span class="pre">smoothing</span></code> value is defined in units
of <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code>.  Otherwise, <code class="xref py py-obj docutils literal notranslate"><span class="pre">smoothing</span></code> is in the same units as the
supplied coordinates.</p>
</dd>
<dt><strong>adaptive_threshold</strong><span class="classifier">float or array_like (n_features,)</span></dt><dd><p>If a single value is supplied, each feature will use this value.
Otherwise, each feature should specify an adaptive threshold
as an element of <code class="xref py py-obj docutils literal notranslate"><span class="pre">adaptive_threshold</span></code>.  If a non-zero value is
supplied, adaptive weighting will be enabled for that feature.
These values define the size of the initial weighting kernel
used during fitting.  The nominal value is 1.</p>
</dd>
<dt><strong>adaptive_algorithm</strong><span class="classifier">str, optional</span></dt><dd><p>May be one of {‘scaled’, ‘shaped’, None}. <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> disables adaptive
weighting.  The “scaled” algorithm allows the weighting kernel
to change in size only.  The “shaped” algorithm allows the kernel
to change in size, rotate, and stretch each primary axis.  Please
see <code class="xref py py-func docutils literal notranslate"><span class="pre">resample_utils.scaled_adaptive_weight_matrix()</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">resample_utils.shaped_adaptive_weight_matrix()</span></code> for further
details.</p>
</dd>
<dt><strong>fit_threshold</strong><span class="classifier">float, optional</span></dt><dd><p>If nonzero, rejects a polynomial fit if it deviates by
<code class="xref py py-obj docutils literal notranslate"><span class="pre">|fit_threshold|</span></code> * the RMS of the samples.  If it is rejected,
that value will be replaced by the mean (error weighted if set),
if <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_threshold</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> or NaN if <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_threshold</span> <span class="pre">&lt;</span> <span class="pre">0</span></code>.</p>
</dd>
<dt><strong>cval</strong><span class="classifier">float, optional</span></dt><dd><p>During fitting, any fit that does not meet the <code class="xref py py-obj docutils literal notranslate"><span class="pre">order_algorithm</span></code>
requirement will be set to this value. This will be NaN by default.</p>
</dd>
<dt><strong>edge_threshold</strong><span class="classifier">float or array_like or float</span></dt><dd><p>If set to a value &gt; 0, edges of the fit will be masked out
according to <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_algorithm</span></code>. Values close to zero will result in
a low degree of edge clipping, while values close to 1 clip edges
to a greater extent.  The exact definition of <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_threshold</span></code>
depends on the algorithm.  For further details, please see
<code class="xref py py-func docutils literal notranslate"><span class="pre">resampling.resample_utils.check_edges()</span></code>.</p>
</dd>
<dt><strong>edge_algorithm</strong><span class="classifier">str, optional</span></dt><dd><p>Describes how to clip edges if edge_threshold is non-zero. The
available algorithms are:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘distribution’ (default): Statistics on sample distributions
are calculated, and if the resampling point is &gt; 1/threshold
standard deviations away from the sample mean, it will be
clipped.</p></li>
<li><p>‘ellipsoid’: If the samples used to fit a
resampling point deviate from the resampling point
location by more than this amount, it will be clipped.</p></li>
<li><p>‘box’: If the flattened 1-dimensional distribution
of samples center-of-mass deviates from the resampling
point location in any dimension, it will be clipped.</p></li>
<li><p>‘range’: Over each dimension, check the distribution of
points is greater than edge_threshold to the “left” and
“right” of the resampling point.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>order_algorithm</strong><span class="classifier">str, optional</span></dt><dd><p>The type of check to perform on whether the sample distribution
for each resampling point is adequate to derive a polynomial fit.
Depending on <a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.order" title="sofia_redux.toolkit.resampling.ResamplePolynomial.order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code></a> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_order</span></code>, if the distribution does
not meet the criteria for <code class="xref py py-obj docutils literal notranslate"><span class="pre">order_algorithm</span></code>, either the fit will
be aborted, returning a value of <code class="xref py py-obj docutils literal notranslate"><span class="pre">cval</span></code>, or the fit order will be
reduced.  Available algorithms are:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘bounded’: Require that there are <a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.order" title="sofia_redux.toolkit.resampling.ResamplePolynomial.order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code></a> samples in both
the negative and positive directions of each feature
from the resampling point.</p></li>
<li><p>‘counts’: Require that there are (order + 1) ** n_features
samples within the <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code> of each resampling point.</p></li>
<li><p>‘extrapolate’: Attempt to fit regardless of the sample
distribution.</p></li>
</ul>
</div></blockquote>
<p>Note that ‘bounded’ is the most robust mode as it ensures
that no singular values will be encountered during the
least-squares fitting of polynomial coefficients.</p>
</dd>
<dt><strong>error_weighting</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> (default), weight polynomial fitting by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">error</span></code>
values of each sample.</p>
</dd>
<dt><strong>estimate_covariance</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, calculate errors on the fit using
<code class="xref py py-func docutils literal notranslate"><span class="pre">resample_utils.estimated_covariance_matrix_inverse()</span></code>.
Otherwise, use <code class="xref py py-func docutils literal notranslate"><span class="pre">resample_utils.covariance_matrix_inverse()</span></code>.</p>
</dd>
<dt><strong>is_covar</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, the input data is treated as a covariance instead of
a flux, and is propagated as if through a weighted mean.</p>
</dd>
<dt><strong>jobs</strong><span class="classifier">int, optional</span></dt><dd><p>Specifies the maximum number of concurrently running jobs.  An
attempt will be made to parallel process using a thread-pool if
available, but will otherwise revert to the “loky” backend.
Values of 0 or 1 will result in serial processing.  A negative
value sets jobs to <code class="xref py py-obj docutils literal notranslate"><span class="pre">n_cpus</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">jobs</span></code> such that -1 would use
all cpus, and -2 would use all but one cpu.</p>
</dd>
<dt><strong>use_threading</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, force use of threads during multiprocessing.</p>
</dd>
<dt><strong>use_processes</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, force use of sub-processes during multiprocessing.</p>
</dd>
<dt><strong>get_error</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, If True returns the error which is given as the weighted
RMS of the samples used for each resampling point.</p>
</dd>
<dt><strong>get_counts</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> returns the number of samples used to fit each resampling
point.</p>
</dd>
<dt><strong>get_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, returns the sum of all sample weights (error and
distance) used in the fit at each resampling point.</p>
</dd>
<dt><strong>get_distance_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, returns the sum of all sample distance weights (not
including error) used in the fit at each resampling point.</p>
</dd>
<dt><strong>get_rchi2</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, returns the reduced chi-squared statistic of the fit
at each resampling point.  Note that this is only valid if errors
were supplied during <code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.__init__()</span></code>.</p>
</dd>
<dt><strong>get_cross_derivatives</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, returns the derivative mean-squared-cross-product of
the fit derivatives at each resampling point.</p>
</dd>
<dt><strong>get_offset_variance</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, returns the offset of the resampling point from the
center of the sample distribution used to generate the fit as
a variance.  i.e., a return value of 9 indicates a 3-sigma
deviation of the resampling point from the sample distribution.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>fit_data, [fit_error], [fit_counts]</dt><dd><p>The data fit at <code class="xref py py-obj docutils literal notranslate"><span class="pre">args</span></code> and optionally, the error associated with
the fit, and the number of samples used to generate each point.
Will be of a shape determined by <code class="xref py py-obj docutils literal notranslate"><span class="pre">args</span></code>.  <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_data</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_error</span></code> will be of type np.float64, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_counts</span></code> will
be of type np.int64.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResamplePolynomial.calculate_adaptive_smoothing">
<span class="sig-name descname"><span class="pre">calculate_adaptive_smoothing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_polynomial.html#ResamplePolynomial.calculate_adaptive_smoothing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.calculate_adaptive_smoothing" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the adaptive distance weighting kernel.</p>
<p>Calculates a weighting kernel for each sample in the reduction.  i.e,
each sample will have a different weighting factor based on its
distance (and optionally, direction) from each point at which a fit
is required.  This is done by performing a fit centered on each sample,
and measuring how that fit deviates from the actual observed sample
value.  The first step is to decide upon the distance weighting factor
used to perform the initial fit.</p>
<p>It is assumed that the coordinate error is known (or approximately
known), and supplied as a <span class="math notranslate nohighlight">\(1 \sigma\)</span> error as the ‘alpha’
keyword in <code class="xref py py-obj docutils literal notranslate"><span class="pre">settings</span></code>.  For example, the error in astronomical
observations taken using a Gaussian beam with known FWHM is:</p>
<div class="math notranslate nohighlight">
\[\sigma = \frac{\text{FWHM}}{2 \sqrt{2 \ln{2}}}\]</div>
<p>However, adaptive weighting may be calculated over select dimensions,
leaving some fixed.  In this case, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">alpha</span></code> keyword will always
apply a weighting factor in a “fixed” dimension <span class="math notranslate nohighlight">\(k\)</span> as:</p>
<div class="math notranslate nohighlight">
\[w_k = exp \left(
      \frac{-\Delta x_k^2}{\alpha_{fixed, k} \Omega_k^2}
      \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta x_k\)</span> is the distance from the resampling point to
the sample in question, and <span class="math notranslate nohighlight">\(\Omega_k\)</span> is the window principle
axis in dimension <span class="math notranslate nohighlight">\(k\)</span>.  Note that in the weighting function,
<span class="math notranslate nohighlight">\(\sigma\)</span> is related to <span class="math notranslate nohighlight">\(\alpha\)</span> by:</p>
<div class="math notranslate nohighlight">
\[\alpha_k = 2 \sigma_k^2\]</div>
<p>and weighting is applied using the definition of <span class="math notranslate nohighlight">\(w_k\)</span> above.  To
signify that <span class="math notranslate nohighlight">\(\alpha_{fixed, k}\)</span> should be used instead of
<span class="math notranslate nohighlight">\(\sigma\)</span> for dimension <span class="math notranslate nohighlight">\(k\)</span>, the “adaptive_threshold” array
in <code class="xref py py-obj docutils literal notranslate"><span class="pre">settings</span></code> should be set to zero for the corresponding dimension.
For example, if we had:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>settings[&#39;alpha&#39;] = [0.3, 0.3]
settings[&#39;adaptive_threshold&#39;] = [1, 0]
</pre></div>
</div>
<p>the first dimension would have <span class="math notranslate nohighlight">\(\alpha_0=0.18\)</span>
(<span class="math notranslate nohighlight">\(2 \times 0.3^2\)</span>), and the second would have
<span class="math notranslate nohighlight">\(\alpha_1=0.3\)</span>.  In this example, <span class="math notranslate nohighlight">\(\alpha_0\)</span> would be
allowed to vary per sample, while <span class="math notranslate nohighlight">\(\alpha_1\)</span> would be fixed for
each sample at 0.3.  An initial fit is then performed at each sample
coordinate using a test distance weighting parameter:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\sigma_{test, k} = \frac{\pi \sigma_k}{\sqrt{2 ln{2}}}\\\alpha_{test, k} = 2 \sigma_{test, k}^2\end{aligned}\end{align} \]</div>
<p>Using this initial weighting parameter, the adaptive kernels are
derived using either
<code class="xref py py-func docutils literal notranslate"><span class="pre">resample_utils.shaped_adaptive_weight_matrix()</span></code> or
<code class="xref py py-func docutils literal notranslate"><span class="pre">resample_utils.scaled_adaptive_weight_matrix()</span></code> depending on
whether the “shaped” keyword in <code class="xref py py-obj docutils literal notranslate"><span class="pre">settings</span></code> is set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>
respectively.</p>
<p>The weighting kernels are stored in the “adaptive_alpha” keyword value
in <code class="xref py py-obj docutils literal notranslate"><span class="pre">settings</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>settings</strong><span class="classifier">dict</span></dt><dd><p>Reduction settings, as returned by
<a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.reduction_settings" title="sofia_redux.toolkit.resampling.ResamplePolynomial.reduction_settings"><code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.reduction_settings()</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResamplePolynomial.calculate_minimum_points">
<span class="sig-name descname"><span class="pre">calculate_minimum_points</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_polynomial.html#ResamplePolynomial.calculate_minimum_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.calculate_minimum_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the minimum number of points for a polynomial fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>minimum_points</strong><span class="classifier">int</span></dt><dd><p>The minimum number of points for a polynomial fit</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResamplePolynomial.check_order">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">check_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_polynomial.html#ResamplePolynomial.check_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.check_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the order is of correct format and enough samples exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>order</strong><span class="classifier">int or array_like of int (n_features,)</span></dt><dd><p>The polynomial order to fit, either supplied as an integer to be
applied over all dimensions, or as an array to give the order
in each dimension.</p>
</dd>
<dt><strong>n_features</strong><span class="classifier">int</span></dt><dd><p>The number of features (dimensions) of the sample coordinates.</p>
</dd>
<dt><strong>n_samples</strong><span class="classifier">int</span></dt><dd><p>The number of samples.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>order</strong><span class="classifier">int or numpy.ndarray of int (n_features,)</span></dt><dd><p>The formatted polynomial order.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If there are too few samples for the desired order, or <a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.order" title="sofia_redux.toolkit.resampling.ResamplePolynomial.order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code></a> is
not formatted correctly.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResamplePolynomial.pre_fit">
<span class="sig-name descname"><span class="pre">pre_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_region_coordinates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_polynomial.html#ResamplePolynomial.pre_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.pre_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform pre-fitting steps and build the fitting tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>settings</strong><span class="classifier">dict</span></dt><dd><p>Settings calculated via <a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.reduction_settings" title="sofia_redux.toolkit.resampling.ResamplePolynomial.reduction_settings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reduction_settings</span></code></a> to be applied
if necessary.</p>
</dd>
<dt><strong>args</strong><span class="classifier">n-tuple</span></dt><dd><p>The call input arguments.</p>
</dd>
<dt><strong>adaptive_region_coordinates</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>The coordinates determined from a previous adaptive smoothing
algorithm.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResamplePolynomial.process_block">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">process_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_polynomial.html#ResamplePolynomial.process_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.process_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Run <a class="reference internal" href="sofia_redux.toolkit.resampling.solve_fits.html#sofia_redux.toolkit.resampling.solve_fits" title="sofia_redux.toolkit.resampling.solve_fits"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_fits()</span></code></a> on each block.</p>
<p>Utility function that parses the settings and tree objects to something
usable by the numba JIT compiled resampling functions.  This is not
meant to be called directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>args</strong><span class="classifier">2-tuple</span></dt><dd><p>A tuple of form (filename, iteration) where the filename is a
string pointing towards a previously saved pickle file containing
the relevant information for the reduction if required.  If set to
<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, the arguments are retrieved from the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">_global_resampling_values</span></code> global parameter.</p>
</dd>
<dt><strong>block</strong><span class="classifier">int</span></dt><dd><p>The block index to process.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>results</strong><span class="classifier">9-tuple of numpy.ndarray</span></dt><dd><p>The first element contains the fit point indices to be fit.  For
the remaining elements, please see <a class="reference internal" href="sofia_redux.toolkit.resampling.solve_fits.html#sofia_redux.toolkit.resampling.solve_fits" title="sofia_redux.toolkit.resampling.solve_fits"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_fits()</span></code></a> return
values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResamplePolynomial.reduction_settings">
<span class="sig-name descname"><span class="pre">reduction_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scaled'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_weighting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'distribution'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bounded'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_region_coordinates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_threading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_processes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_polynomial.html#ResamplePolynomial.reduction_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.reduction_settings" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a set of reduction instructions based on user input.</p>
<p>This method is responsible for determining, formatting, and checking
a number variables required for the resampling algorithm based on
user input.  For detailed descriptions of user options, please see
<a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.__call__" title="sofia_redux.toolkit.resampling.ResamplePolynomial.__call__"><code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.__call__()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>smoothing</strong><span class="classifier">float or array_like (n_features,), optional</span></dt><dd></dd>
<dt><strong>relative_smooth</strong><span class="classifier">bool, optional</span></dt><dd></dd>
<dt><strong>adaptive_threshold</strong><span class="classifier">float or array_like (n_features,), optional</span></dt><dd></dd>
<dt><strong>adaptive_algorithm</strong><span class="classifier">str, optional</span></dt><dd></dd>
<dt><strong>error_weighting</strong><span class="classifier">bool, optional</span></dt><dd></dd>
<dt><strong>fit_threshold</strong><span class="classifier">float, optional</span></dt><dd></dd>
<dt><strong>cval</strong><span class="classifier">float, optional</span></dt><dd></dd>
<dt><strong>edge_threshold</strong><span class="classifier">float or array_like (n_features,), optional</span></dt><dd></dd>
<dt><strong>edge_algorithm</strong><span class="classifier">str, optional</span></dt><dd></dd>
<dt><strong>order_algorithm</strong><span class="classifier">str, optional</span></dt><dd></dd>
<dt><strong>is_covar</strong><span class="classifier">bool, optional</span></dt><dd></dd>
<dt><strong>estimate_covariance</strong><span class="classifier">bool, optional</span></dt><dd></dd>
<dt><strong>jobs</strong><span class="classifier">int, optional</span></dt><dd></dd>
<dt><strong>adaptive_region_coordinates</strong><span class="classifier">array_like, optional</span></dt><dd></dd>
<dt><strong>use_threading</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, force use of threads during multiprocessing.</p>
</dd>
<dt><strong>use_processes</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, force use of sub-processes during multiprocessing.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>settings</strong><span class="classifier">dict</span></dt><dd><p>The reduction settings.  Also, stored as
<code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.fit_settings()</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResamplePolynomial.set_sample_tree">
<span class="sig-name descname"><span class="pre">set_sample_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_estimate_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_estimate_percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_estimate_oversample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">large_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_buffer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">distance_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_polynomial.html#ResamplePolynomial.set_sample_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.set_sample_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the sample tree from input coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>coordinates</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The input coordinates of shape (n_features, n_samples).</p>
</dd>
<dt><strong>radius</strong><span class="classifier">float or sequence (float), optional</span></dt><dd><p>The radius of the window around each fitting point used to
determine sample selection for fit.  If not supplied, will be
estimated using
<code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.estimate_feature_windows()</span></code>.</p>
</dd>
<dt><strong>window_estimate_bins</strong><span class="classifier">int, optional</span></dt><dd><p>Used to estimate the <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code> if not supplied using
<code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.estimate_feature_windows()</span></code>.</p>
</dd>
<dt><strong>window_estimate_percentile</strong><span class="classifier">int or float, optional</span></dt><dd><p>Used to estimate the <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code> if not supplied using
<code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.estimate_feature_windows()</span></code>.</p>
</dd>
<dt><strong>window_estimate_oversample</strong><span class="classifier">int or float, optional</span></dt><dd><p>Used to estimate the <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code> if not supplied using
<code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.estimate_feature_windows()</span></code>.</p>
</dd>
<dt><strong>leaf_size</strong><span class="classifier">int, optional</span></dt><dd><p>Number of points at which to switch to brute-force during the
ball tree query algorithm.  See <code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.neighbours.BallTree</span></code>
for further details.</p>
</dd>
<dt><strong>large_data</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that this resampling algorithm will run on
a large set of data, and the ball tree should be created on
subsets of the data.</p>
</dd>
<dt><strong>check_memory</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, check the memory requirements for resampling the
supplied data.</p>
</dd>
<dt><strong>memory_buffer</strong><span class="classifier">float, optional</span></dt><dd><p>A fraction (positive or negative) with which to modify the memory
estimates for the process memory requirements.  Memory estimates
are scaled by the factor 1 + memory_buffer.</p>
</dd>
<dt><strong>distance_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Optional keyword arguments passed into
<code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.neighbors.DistanceMetric()</span></code>.  The default is to use
the “minkowski” definition with <code class="xref py py-obj docutils literal notranslate"><span class="pre">p=2</span></code>, i.e., the Euclidean
definition.  This is important in determining which samples lie
inside the window region of a resampling point, and when deriving
distance weighting factors.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">ResamplePolynomial</a><ul>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial"><code class="docutils literal notranslate"><span class="pre">ResamplePolynomial</span></code></a><ul>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.fit_tree"><code class="docutils literal notranslate"><span class="pre">ResamplePolynomial.fit_tree</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.order"><code class="docutils literal notranslate"><span class="pre">ResamplePolynomial.order</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.__call__"><code class="docutils literal notranslate"><span class="pre">ResamplePolynomial.__call__()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.calculate_adaptive_smoothing"><code class="docutils literal notranslate"><span class="pre">ResamplePolynomial.calculate_adaptive_smoothing()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.calculate_minimum_points"><code class="docutils literal notranslate"><span class="pre">ResamplePolynomial.calculate_minimum_points()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.check_order"><code class="docutils literal notranslate"><span class="pre">ResamplePolynomial.check_order()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.pre_fit"><code class="docutils literal notranslate"><span class="pre">ResamplePolynomial.pre_fit()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.process_block"><code class="docutils literal notranslate"><span class="pre">ResamplePolynomial.process_block()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.reduction_settings"><code class="docutils literal notranslate"><span class="pre">ResamplePolynomial.reduction_settings()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResamplePolynomial.set_sample_tree"><code class="docutils literal notranslate"><span class="pre">ResamplePolynomial.set_sample_tree()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.toolkit.resampling.ResamplePolynomial.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>