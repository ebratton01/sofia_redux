<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>smooth_value_at &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="point_aligned_smooth" href="sofia_redux.scan.utilities.numba_functions.point_aligned_smooth.html" />
    <link rel="prev" title="smooth_values_at" href="sofia_redux.scan.utilities.numba_functions.smooth_values_at.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.scan.utilities.numba_functions.point_aligned_smooth.html" title="point_aligned_smooth">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.scan.utilities.numba_functions.smooth_values_at.html" title="smooth_values_at">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../sofia_redux/scan/index.html" accesskey="U">sofia_redux.scan: Scan Mode Algorithms for SOFIA Pipelines</a> &#187;</li>
      
      <li>smooth_value_at</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="smooth-value-at">
<h1>smooth_value_at<a class="headerlink" href="#smooth-value-at" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.scan.utilities.numba_functions.smooth_value_at">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.scan.utilities.numba_functions.</span></span><span class="sig-name descname"><span class="pre">smooth_value_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_reference_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degrees</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">panel_mapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">panel_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knot_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nk1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spline_mapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validated</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/utilities/numba_functions.html#smooth_value_at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.utilities.numba_functions.smooth_value_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the convolution of data with a kernel at a single point.</p>
<p>This low-level function basically sorts a convolution of <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code> with
<code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel</span></code> at a single point (<code class="xref py py-obj docutils literal notranslate"><span class="pre">index</span></code>) into processing by one of two
algorithms.  If the index aligns perfectly with a point on the kernel,
the direct convolution is calculated via <a class="reference internal" href="sofia_redux.scan.utilities.numba_functions.point_aligned_smooth.html#sofia_redux.scan.utilities.numba_functions.point_aligned_smooth" title="sofia_redux.scan.utilities.numba_functions.point_aligned_smooth"><code class="xref py py-func docutils literal notranslate"><span class="pre">point_aligned_smooth()</span></code></a>.
Otherwise, a slightly shifted version of the kernel is generated using
spline interpolation so that the shifted kernel indices align with those
of the data array, and direct convolution is possible.  In this case,
convolution is performed using <a class="reference internal" href="sofia_redux.scan.utilities.numba_functions.point_smooth.html#sofia_redux.scan.utilities.numba_functions.point_smooth" title="sofia_redux.scan.utilities.numba_functions.point_smooth"><code class="xref py py-func docutils literal notranslate"><span class="pre">point_smooth()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The data from which to calculate smoothed values.  Must be an array
of arbitrary shape, but have n_dimensions.</p>
</dd>
<dt><strong>kernel</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The kernel to smooth with.  Must be an array of arbitrary shape, but
match the same number of dimensions as <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code>.</p>
</dd>
<dt><strong>index</strong><span class="classifier">numpy.ndarray (int or float)</span></dt><dd><p>The index on <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code> at which to calculate the smooth value.  This
should be an array of shape (n_dimensions,) using numpy (y, x)
ordering.</p>
</dd>
<dt><strong>kernel_indices</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>An array of shape (n_dimensions, kernel.size) as returned by
<code class="xref py py-func docutils literal notranslate"><span class="pre">spline_utils.flat_index_mapping()</span></code>.  This gives the N-dimensional
kernel index for a flat kernel.  I.e., kernel.ravel()[i] is the same
as kernel[kernel_indices[i]].  Note that dimensions are ordered using
the Numpy (y, x) convention.</p>
</dd>
<dt><strong>kernel_reference_index</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The kernel reference index specifying the center of the kernel.
Must be of shape (n_dimensions,) and use numpy dimensional ordering
(y, x).</p>
</dd>
<dt><strong>knots</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The knots as calculated by the <code class="xref py py-class docutils literal notranslate"><span class="pre">Spline</span></code> object on <code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel</span></code>.
These should be of shape (n_dimensions, max_knots) where max_knots is
the maximum possible number of knots for a spline representation of
<code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel</span></code> over all dimensions.  Dimensions should be ordered as (x, y).</p>
</dd>
<dt><strong>coefficients</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The spline coefficients of shape (n_coefficients,).</p>
</dd>
<dt><strong>degrees</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><dl class="simple">
<dt>The spline degrees for each dimension of shape (n_dimensions,).</dt><dd><p>Dimensions should be ordered as (x, y).</p>
</dd>
</dl>
</dd>
<dt><strong>panel_mapping</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The panel mapping translation for the spline fit.  Should be of shape
(n_dimensions, n_panels).   Dimensions should be ordered as (x, y).</p>
</dd>
<dt><strong>panel_steps</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The panel steps translation for the spline fit.  Should be of shape
(n_dimensions,).   Dimensions should be ordered as (x, y).</p>
</dd>
<dt><strong>knot_steps</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The spline knot steps translation for the spline fit.  Should be of
shape (n_dimensions,).   Dimensions should be ordered as (x, y).</p>
</dd>
<dt><strong>nk1</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>Another spline mapping parameter which is equal to
n_knots - degrees - 1 for the spline.  Should be of shape
(n_dimensions,).   Dimensions should be ordered as (x, y).</p>
</dd>
<dt><strong>spline_mapping</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>A spline mapping translation for the spline knots.  Should be of shape
(n_dimensions, max_knots).   Dimensions should be ordered as (x, y).</p>
</dd>
<dt><strong>data_shape</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The shape of <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code> as an array of shape (n_dimensions,) in
Numpy (y, x) order.</p>
</dd>
<dt><strong>kernel_shape</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The shape of <code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel</span></code> as an array of shape (n_dimensions,) in Numpy
(y, x) order.</p>
</dd>
<dt><strong>data_steps</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>An array of shape (n_dimensions,) in Numpy (y, x) order giving the
number of elements one would need to jump on a flattened <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code> for
a single increment along a given dimension on the ND-array.  Please
see <code class="xref py py-func docutils literal notranslate"><span class="pre">spline_utils.flat_index_mapping()</span></code> for further details.</p>
</dd>
<dt><strong>flat_weight</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The associated weight values for data, flattened to a single dimension
array of shape (data.size,).  I.e., <code class="xref py py-obj docutils literal notranslate"><span class="pre">flat_weight</span></code> = weight.ravel().
If no weighting is required, this should be an empty array of
shape (0,).</p>
</dd>
<dt><strong>flat_valid</strong><span class="classifier">numpy.ndarray (bool)</span></dt><dd><p>An array marking data values as valid (<a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>) or invalid (<a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>).
Any invalid data will not be included in the calculation.  This should
be a flattened singular dimension array taken from one that was
originally the same shape as <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code> and be of shape (data.size,).
I.e., <code class="xref py py-obj docutils literal notranslate"><span class="pre">flat_valid</span></code> = valid.ravel().  If no validity checking is
required (assumes all data points are valid), set this to an empty
array of shape (0,).</p>
</dd>
<dt><strong>weighted</strong><span class="classifier">bool</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that weighting is required and <code class="xref py py-obj docutils literal notranslate"><span class="pre">flat_weight</span></code>
should be of shape (data.size,).  Otherwise, no weighting is required,
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">flat_weight</span></code> may be of shape (0,).</p>
</dd>
<dt><strong>validated</strong><span class="classifier">bool</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that validity checking is required and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">flat_valid</span></code> should be of shape (data.size,).  Otherwise, <code class="xref py py-obj docutils literal notranslate"><span class="pre">flat_valid</span></code>
may be of shape (0,).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>smooth_value, smooth_weight</strong><span class="classifier">float, float</span></dt><dd><p>The derived smooth value and associated weight by convolving <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code>
with <code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel</span></code> at <code class="xref py py-obj docutils literal notranslate"><span class="pre">index</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">smooth_value_at</a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.utilities.numba_functions.smooth_value_at"><code class="docutils literal notranslate"><span class="pre">smooth_value_at()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.scan.utilities.numba_functions.smooth_value_at.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>