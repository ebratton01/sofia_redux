<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>solve_polynomial_fit &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="solve_rchi2_from_error" href="sofia_redux.toolkit.resampling.solve_rchi2_from_error.html" />
    <link rel="prev" title="solve_mean_fit" href="sofia_redux.toolkit.resampling.solve_mean_fit.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.solve_rchi2_from_error.html" title="solve_rchi2_from_error">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.solve_mean_fit.html" title="solve_mean_fit">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/fifils/developers/developers.html" accesskey="U">FIFI-LS Redux Developer’s Manual</a> &#187;</li>
      
      <li>solve_polynomial_fit</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="solve-polynomial-fit">
<h1>solve_polynomial_fit<a class="headerlink" href="#solve-polynomial-fit" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.solve_polynomial_fit">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.toolkit.resampling.</span></span><span class="sig-name descname"><span class="pre">solve_polynomial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">derivative_term_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_rchi2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_derivative_mscp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_weighting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_utils.html#solve_polynomial_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.solve_polynomial_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Derive a polynomial fit from samples, then calculate fit at single point.</p>
<p>The fit to the sample distribution is given as</p>
<div class="math notranslate nohighlight">
\[f(\Phi) = \hat{c} \cdot \Phi\]</div>
<p>where <span class="math notranslate nohighlight">\(\Phi\)</span> contains products of the sample coordinates for each
coefficient term.  The coefficients <span class="math notranslate nohighlight">\(\hat{c}\)</span> are solved for using
least-squares fitting and then applied to calculate the fitted value at a
single point <span class="math notranslate nohighlight">\(f(\Phi_{fit})\)</span>.</p>
<p>It is also possible to return an on the fit as a variance.  If a valid
error is supplied, it will be propagated.  If no valid errors are
available, they will be calculated from residuals on the fit.</p>
<p>The reduced chi-squared (<span class="math notranslate nohighlight">\(\chi^2\)</span>) statistic may also be calculated,
but is only really meaningful if valid errors were supplied.  Otherwise,
<span class="math notranslate nohighlight">\(\chi^2 \equiv 1\)</span>.</p>
<p>Finally, the covariance of gradients between dimensions may also be
returned.  Note that these are the weighted mean of all sample gradients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>phi_samples</strong><span class="classifier">numpy.ndarray (n_terms, n_samples)</span></dt><dd><p>The array of independent terms for each sample.</p>
</dd>
<dt><strong>phi_point</strong><span class="classifier">numpy.ndarray (n_terms,)</span></dt><dd><p>The array containing the independent terms at the fitting point.</p>
</dd>
<dt><strong>data</strong><span class="classifier">numpy.ndarray (n_samples,)</span></dt><dd><p>The array of sample values.</p>
</dd>
<dt><strong>error</strong><span class="classifier">numpy.ndarray (n_samples,)</span></dt><dd><p>The array of error values for each sample.  Note that if errors are
unavailable, an array of size 0 may be supplied.  If this is the case,
and an error on the fit is required, it will be derived from the
residuals of the fit from the data.  In addition, the reduced
chi-squared statistic will always be 1.0 if derived from residuals.</p>
</dd>
<dt><strong>distance_weight</strong><span class="classifier">numpy.ndarray (n_samples,)</span></dt><dd><p>The distance weighting factor (not including any error weighting)
applied to each sample in the fit.</p>
</dd>
<dt><strong>weight</strong><span class="classifier">numpy.ndarray (n_samples,)</span></dt><dd><p>The full weighting factor applied to each sample in the fit.</p>
</dd>
<dt><strong>derivative_term_map</strong><span class="classifier">numpy.ndarray, optional</span></dt><dd><p>A mapping array for the determination of derivatives from the
coefficients of the fit, and available terms in “phi”.  The shape of
the array is (n_dimensions, 3, n_derivative_terms).  This is only
required if the gradient is required as an output.  For a full
description of the derivative map, please see
<a class="reference internal" href="sofia_redux.toolkit.resampling.polynomial_derivative_map.html#sofia_redux.toolkit.resampling.polynomial_derivative_map" title="sofia_redux.toolkit.resampling.polynomial_derivative_map"><code class="xref py py-func docutils literal notranslate"><span class="pre">polynomial_derivative_map()</span></code></a>.</p>
</dd>
<dt><strong>calculate_variance</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, calculate the variance on the fit.  The variance will be
calculated irrespectively if a valid error was supplied, and the
reduced chi-squared statistic is required as a return value.</p>
</dd>
<dt><strong>calculate_rchi2</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, calculate the reduced chi-squared statistic of the fit.
Note that valid errors must be supplied for this to be meaningful.</p>
</dd>
<dt><strong>calculate_derivative_mscp</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, calculate the covariance of the derivatives at the fit
point.</p>
</dd>
<dt><strong>error_weighting</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that <code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code> includes an error weighting
factor of 1/sigma^2.  This allows for a slight speed increase when
performing the fit as some mathematical terms will not need to be
recalculated.</p>
</dd>
<dt><strong>estimate_covariance</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, uses <a class="reference internal" href="sofia_redux.toolkit.resampling.estimated_covariance_matrix_inverse.html#sofia_redux.toolkit.resampling.estimated_covariance_matrix_inverse" title="sofia_redux.toolkit.resampling.estimated_covariance_matrix_inverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">estimated_covariance_matrix_inverse()</span></code></a> instead
of <a class="reference internal" href="sofia_redux.toolkit.resampling.covariance_matrix_inverse.html#sofia_redux.toolkit.resampling.covariance_matrix_inverse" title="sofia_redux.toolkit.resampling.covariance_matrix_inverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">covariance_matrix_inverse()</span></code></a> when determining the variance.
This is suggested if the errors are not well-behaved.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fit_value, variance, rchi2, gradients</strong><span class="classifier">float, float, float, numpy.ndarray</span></dt><dd><p>The value of the fit at the fit point.  The variance and reduced
chi-squared will only be calculated if <code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_variance</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_rchi2</span></code> are respectively set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.  The <code class="xref py py-obj docutils literal notranslate"><span class="pre">gradients</span></code>
matrix is an (n_dimensions, n_dimensions) array where
gradients[i, j] = dx_i * dx_j.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">solve_polynomial_fit</a><ul>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.solve_polynomial_fit"><code class="docutils literal notranslate"><span class="pre">solve_polynomial_fit()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.toolkit.resampling.solve_polynomial_fit.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>