<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>coadd &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="correct_row_gains" href="sofia_redux.instruments.exes.correct_row_gains.correct_row_gains.html" />
    <link rel="prev" title="clean" href="sofia_redux.instruments.exes.clean.clean.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.instruments.exes.correct_row_gains.correct_row_gains.html" title="correct_row_gains">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.instruments.exes.clean.clean.html" title="clean">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/exes/developers/developers.html" accesskey="U">EXES Redux Developer’s Manual</a> &#187;</li>
      
      <li>coadd</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="coadd">
<h1>coadd<a class="headerlink" href="#coadd" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.instruments.exes.coadd.coadd">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.instruments.exes.coadd.</span></span><span class="sig-name descname"><span class="pre">coadd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">good_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_wt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/exes/coadd.html#coadd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.exes.coadd.coadd" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine individual frames to increase signal-to-noise.</p>
<p>First, a template of the spectrum is created from all frames,
averaging in the spectral direction. By default, all input frames
are weighted by their correlation with this spatial template,
so that if a frame is unusually noisy had some other error, it will
not contribute significantly to the coadded frame. If this is not
desired, an unweighted coadd can be performed, or the user can
directly specify the weights to use.</p>
<p>The weighted frames are then summed to effect a weighted mean of the
input data. If the threshold parameter is provided, outlier rejection
is additionally performed before the weighted mean. If provided, the
variance is propagated accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>3D data cube [nframe, ny, nx].  Input data is assumed to
be distortion corrected and rotated as needed to align the spectral
direction along the x-axis.</p>
</dd>
<dt><strong>header</strong><span class="classifier">fits.Header</span></dt><dd><p>Header of FITS file. Will be updated in place.</p>
</dd>
<dt><strong>flat</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D processed flat, as produced by makeflat [ny, nx].</p>
</dd>
<dt><strong>variance</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>3D variance cube [nframe, ny, nx]. Will be updated in place.</p>
</dd>
<dt><strong>illum</strong><span class="classifier">numpy.ndarray of int, optional</span></dt><dd><p>Indicates illuminated regions of the frame [ny, nx].
1=illuminated, 0=unilluminated, -1=pixel that does not
correspond to any region in the raw frame.</p>
</dd>
<dt><strong>weights</strong><span class="classifier">array-like, optional</span></dt><dd><p>Array [nframe] of fractional weights to use for input frames. If
a weight is set to zero the frame will be skipped. Must add
up to 1.0. If not provided, weights will be calculated for all
frames.</p>
</dd>
<dt><strong>good_frames</strong><span class="classifier">array-like, optional</span></dt><dd><p>Array of indices of good frames, max <code class="xref py py-obj docutils literal notranslate"><span class="pre">nframe</span></code> length. If
provided, any frame not in <code class="xref py py-obj docutils literal notranslate"><span class="pre">good_frames</span></code> will be skipped.</p>
</dd>
<dt><strong>weight_mode</strong><span class="classifier">{‘unweighted’, ‘useweights’, None}, optional</span></dt><dd><p>If ‘unweighted’, all good frames will be given equal weight.
If ‘useweights’, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code> array will be used to weight the
frames. Otherwise, weights will be calculated from a correlation
with the spatial template.</p>
</dd>
<dt><strong>std_wt</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, frames will be weighted by the square root of their
variance planes. Otherwise, they will be weighted by the flat.</p>
</dd>
<dt><strong>threshold</strong><span class="classifier">float, optional</span></dt><dd><p>If &gt;0, will be used as an outlier rejection threshold in the
mean combination.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>coadded_data, coadded_variance</strong><span class="classifier">numpy.ndarray, numpy.ndarray</span></dt><dd><p>The coadded data and variance, both [ny,nx].</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">coadd</a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.exes.coadd.coadd"><code class="docutils literal notranslate"><span class="pre">coadd()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.instruments.exes.coadd.coadd.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>