<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>flux_calibrate &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="wrap_flux_calibrate" href="sofia_redux.instruments.fifi_ls.flux_calibrate.wrap_flux_calibrate.html" />
    <link rel="prev" title="apply_response" href="sofia_redux.instruments.fifi_ls.flux_calibrate.apply_response.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.instruments.fifi_ls.flux_calibrate.wrap_flux_calibrate.html" title="wrap_flux_calibrate">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.instruments.fifi_ls.flux_calibrate.apply_response.html" title="apply_response">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/fifils/developers/developers.html" accesskey="U">FIFI-LS Redux Developer’s Manual</a> &#187;</li>
      
      <li>flux_calibrate</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="flux-calibrate">
<h1>flux_calibrate<a class="headerlink" href="#flux-calibrate" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.instruments.fifi_ls.flux_calibrate.flux_calibrate">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.instruments.fifi_ls.flux_calibrate.</span></span><span class="sig-name descname"><span class="pre">flux_calibrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/fifi_ls/flux_calibrate.html#flux_calibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.fifi_ls.flux_calibrate.flux_calibrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert spectra to physical flux units.</p>
<p>The procedure is:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Identify response file to use.  Smooth it to the spectral resolution
of the input file.</p></li>
<li><p>Read the spectral data from the input file.</p></li>
<li><p>Loop over the spaxels.</p></li>
<li><p>For each spaxel, interpolate the response data onto the wavelengths
of the spexels and multiply the data at each point by the response
value and its associated wavelength.</p></li>
<li><p>Create a FITS file and (optionally) write results to disk.</p></li>
</ol>
</div></blockquote>
<p>The output FITS file matches the extensions and dimensions of the
input FITS file, with an additional RESPONSE extension attached,
containing the interpolated response correction.  The dimensions of
the RESPONSE array match the dimensions of the LAMBDA array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>FITS file to be flux calibrated.  Should have been created by
fifi_ls.combine_grating_scans or fifi_ls.telluric_correct.</p>
</dd>
<dt><strong>response_file</strong><span class="classifier">str, optional</span></dt><dd><p>Response file to be used.  If not provided, a default file will
be used.  If provided, should be a FITS image file containing
wavelength, response data, and response error in an array
of three rows in the primary extension.</p>
</dd>
<dt><strong>write</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, write to disk and return the path to the output
file.  If False, return the HDUList.  The output filename is
created from the input filename, with the suffix ‘SCM’ or ‘TEL’
replaced with ‘CAL’.</p>
</dd>
<dt><strong>outdir</strong><span class="classifier">str, optional</span></dt><dd><p>Directory path to write output.  If None, output files
will be written to the same directory as the input files.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>fits.HDUList or str</dt><dd><p>Either the HDU (if write is False) or the filename of the output file
(if write is True)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">flux_calibrate</a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.fifi_ls.flux_calibrate.flux_calibrate"><code class="docutils literal notranslate"><span class="pre">flux_calibrate()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.instruments.fifi_ls.flux_calibrate.flux_calibrate.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>