<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>apply_gain_increments &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="calculate_filtering" href="sofia_redux.scan.signal.signal_numba_functions.calculate_filtering.html" />
    <link rel="prev" title="resync_gains" href="sofia_redux.scan.signal.signal_numba_functions.resync_gains.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.scan.signal.signal_numba_functions.calculate_filtering.html" title="calculate_filtering">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.scan.signal.signal_numba_functions.resync_gains.html" title="resync_gains">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../sofia_redux/scan/index.html" accesskey="U">sofia_redux.scan: Scan Mode Algorithms for SOFIA Pipelines</a> &#187;</li>
      
      <li>apply_gain_increments</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="apply-gain-increments">
<h1>apply_gain_increments<a class="headerlink" href="#apply-gain-increments" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal_numba_functions.apply_gain_increments">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.scan.signal.signal_numba_functions.</span></span><span class="sig-name descname"><span class="pre">apply_gain_increments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeling_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_dependents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_fwg2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_dependents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increment_weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal_numba_functions.html#apply_gain_increments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal_numba_functions.apply_gain_increments" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the gain increments to frame data and signals.</p>
<p>Updates the frame data, frame and channel dependents, and signal values and
weights by the given correlated gain increments.  Frame data are updated
by:</p>
<blockquote>
<div><p>d -= g * dc</p>
</div></blockquote>
<p>where g is the channel gain and dc is the increment.  Frame and channel
dependents are updated by the dependent increment of:</p>
<blockquote>
<div><p>dp = cf * cw * fw  * g^2 / dw</p>
</div></blockquote>
<p>where cf is the channel filtering, cw is the channel weight, fw is the
frame weights, and dw is the gain increment weight.  Channel dependents are
incremented by dp summed over all frames for each channel, and frame
dependents are incremented by dp summed over all channels for each frame.
The signal (s) and signal weight (sw) are incremented by:</p>
<blockquote>
<div><p>s += dc
sw += dw</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame_data</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The frame data of shape (n_frames, all_channels).  Will be updated
in-place.</p>
</dd>
<dt><strong>frame_weight</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The relative frame weight of shape (n_frames,).</p>
</dd>
<dt><strong>frame_valid</strong><span class="classifier">numpy.ndarray (bool)</span></dt><dd><p>A boolean mask where <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> excludes a given frame from
all processing.</p>
</dd>
<dt><strong>modeling_frames</strong><span class="classifier">numpy.ndarray (bool)</span></dt><dd><p>A boolean mask where <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> indicates that a given frame is used for
modeling.  While frame data values will still be updated for modeling
frames, they will not be used to update dependents.</p>
</dd>
<dt><strong>frame_dependents</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The frame dependents of shape (n_frames,).  Will be incremented by
channel_{fwg2} * frame_{w} / increment_weight.</p>
</dd>
<dt><strong>channel_g</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The channel mode gains of shape (n_channels,) where n_channels are the
number of channels in the signal mode.</p>
</dd>
<dt><strong>channel_fwg2</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The product of channel (filtering * weight * gain^2) of shape
(n_channels,).</p>
</dd>
<dt><strong>channel_indices</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The channel indices in the mode channel group of shape (n_channels,)
mapping each channel onto (all_channels,) for frame data.</p>
</dd>
<dt><strong>channel_dependents</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The channel dependents of shape (all_channels,).  Will be incremented
by channel_{fwg2} * frame_{w} / increment_weight.</p>
</dd>
<dt><strong>sample_flags</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The frame/channel sample flags of shape (n_frames, all_channels).  Non-
zero sample flags will not add to frame of channel dependents.</p>
</dd>
<dt><strong>signal_values</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The signal values of the correlated signal of shape (n_signal,).  Will
be incremented in-place by the increment values.</p>
</dd>
<dt><strong>signal_weights</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The signal weights of the correlated signal of shape (n_signal,).  Will
be updated in-place to the increment weights.</p>
</dd>
<dt><strong>resolution</strong><span class="classifier">int</span></dt><dd><p>The resolution (in frames) of the correlated signal.</p>
</dd>
<dt><strong>increment</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The signal increment values of shape (n_signal,).</p>
</dd>
<dt><strong>increment_weight</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The signal increment weight value of shape (n_signal,).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">apply_gain_increments</a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal_numba_functions.apply_gain_increments"><code class="docutils literal notranslate"><span class="pre">apply_gain_increments()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.scan.signal.signal_numba_functions.apply_gain_increments.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>