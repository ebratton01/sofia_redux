<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>StepShift &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="StepSkycal" href="sofia_redux.instruments.hawc.steps.stepskycal.StepSkycal.html" />
    <link rel="prev" title="StepScanStokes" href="sofia_redux.instruments.hawc.steps.stepscanstokes.StepScanStokes.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.instruments.hawc.steps.stepskycal.StepSkycal.html" title="StepSkycal">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.instruments.hawc.steps.stepscanstokes.StepScanStokes.html" title="StepScanStokes">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/hawc/developers/developers.html" accesskey="U">HAWC+ DRP Developer’s Manual</a> &#187;</li>
      
      <li>StepShift</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="stepshift">
<h1>StepShift<a class="headerlink" href="#stepshift" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sofia_redux.instruments.hawc.steps.stepshift.StepShift">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sofia_redux.instruments.hawc.steps.stepshift.</span></span><span class="sig-name descname"><span class="pre">StepShift</span></span><a class="reference internal" href="../_modules/sofia_redux/instruments/hawc/steps/stepshift.html#StepShift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.hawc.steps.stepshift.StepShift" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sofia_redux.instruments.hawc.stepparent.StepParent.html#sofia_redux.instruments.hawc.stepparent.StepParent" title="sofia_redux.instruments.hawc.stepparent.StepParent"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepParent</span></code></a></p>
<p>Align the R and T arrays.</p>
<p>This step performs various array manipulations to trim and
align the detector subarrays. First, the last row is removed,
since it is unilluminated. Then, the R1 and T1 subarrays are
rotated to align with R0 and T0, and all subarrays are flipped
over the y-axis. The first and last chops in the demodulated
data are removed. Finally, the R array is shifted to align with
the T array.</p>
<p>Only linear pixel shifts between R and T are performed here. Any
additional misalignment (e.g. rotation) is handled in later
mapping steps. The parameters passed here are set as header keywords,
to be applied as needed by <code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.hawc.steps.StepMerge</span></code>.</p>
<p>This step will also check for the TRCKSTAT keyword in the FITS header.
If it has been set to BAD, this step will issue an error and halt
processing.</p>
<p>Input for this step is a flat-fielded file, where the R Array,
T Array, and their variances are now images instead of columns in the
data table. This step is typically run after
<code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.hawc.steps.StepFlat</span></code>.</p>
<p>Output from this step is the same as the input file, except that
the R and T images, variances, and masks have been trimmed and
shifted. Additionally, some unneeded columns are removed from the
DEMODULATED DATA table, and header keywords are set to describe
R and T relative geometry. These keywords are ALNANG1, ALNANG2,
ALNMAGX, ALNMAGY, ALNGAPX, ALNGAPY, and ALNROTA.</p>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepshift.StepShift.run" title="sofia_redux.instruments.hawc.steps.stepshift.StepShift.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>()</p></td>
<td><p>Run the data reduction algorithm.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepshift.StepShift.setup" title="sofia_redux.instruments.hawc.steps.stepshift.StepShift.setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code></a>()</p></td>
<td><p>Set parameters and metadata for the pipeline step.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.instruments.hawc.steps.stepshift.StepShift.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/hawc/steps/stepshift.html#StepShift.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.hawc.steps.stepshift.StepShift.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the data reduction algorithm.</p>
<p>Because this step is single-in, single-out (SISO),
self.datain must be a DataFits object. The output
is also a DataFits object, stored in self.dataout.</p>
<p>The process is:</p>
<ol class="arabic simple">
<li><p>Check for tracking status problems.</p></li>
<li><p>Remove unneeded data table columns.</p></li>
<li><p>Rotate, flip, and trim data arrays.</p></li>
<li><p>Store alignment keywords.</p></li>
<li><p>Shift the R array to match the T array.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If TRCKSTAT is BAD.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.instruments.hawc.steps.stepshift.StepShift.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/hawc/steps/stepshift.html#StepShift.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.hawc.steps.stepshift.StepShift.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameters and metadata for the pipeline step.</p>
<p>Output files have PRODTYPE = ‘shift’, and are named with
the step abbreviation ‘SFT’.</p>
<p>Parameters defined for this step are:</p>
<dl class="simple">
<dt>angle1<span class="classifier">float</span></dt><dd><p>Rotation angle of R0 relative to T0, in degrees
counter-clockwise, to be stored in keyword ALNANG1.</p>
</dd>
<dt>angle2<span class="classifier">float</span></dt><dd><p>Rotation angle of R1 relative to T1, in degrees
counterclockwise, to be stored in keyword ALNANG2.</p>
</dd>
<dt>mag<span class="classifier">list of float</span></dt><dd><p>Magnification of R relative to T, in the x, y pixel
direction, given as [mx, my]. This will be stored
in keywords ALNMAGX, ALNMAGY.</p>
</dd>
<dt>disp1<span class="classifier">list of float</span></dt><dd><p>Pixel displacement of R0 relative to T0, in the x, y
directions, given as [dx, dy]. This will be applied
to the data with a linearly interpolated shift.</p>
</dd>
<dt>disp2<span class="classifier">list of float</span></dt><dd><p>Pixel displacement of R1 relative to T1, in the x, y
directions, given as [dx, dy]. This will be applied
to the data with a linearly interpolated shift.</p>
</dd>
<dt>gapx<span class="classifier">float</span></dt><dd><p>Displacement in x pixels between T0 and T1. This
will be stored in keyword ALNGAPX.</p>
</dd>
<dt>gapy<span class="classifier">float</span></dt><dd><p>Displacement in y pixels between T0 and T1. This
will be stored in keyword ALNGAPY.</p>
</dd>
<dt>gapangle<span class="classifier">float</span></dt><dd><p>Rotation angle in degrees counter-clockwise between
T0 and T1. This will be stored in keyword ALNROTA.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">StepShift</a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepshift.StepShift"><code class="docutils literal notranslate"><span class="pre">StepShift</span></code></a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepshift.StepShift.run"><code class="docutils literal notranslate"><span class="pre">StepShift.run()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepshift.StepShift.setup"><code class="docutils literal notranslate"><span class="pre">StepShift.setup()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.instruments.hawc.steps.stepshift.StepShift.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>