<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>StepWcs &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="StepZeroLevel" href="sofia_redux.instruments.hawc.steps.stepzerolevel.StepZeroLevel.html" />
    <link rel="prev" title="StepStokes" href="sofia_redux.instruments.hawc.steps.stepstokes.StepStokes.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.instruments.hawc.steps.stepzerolevel.StepZeroLevel.html" title="StepZeroLevel">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.instruments.hawc.steps.stepstokes.StepStokes.html" title="StepStokes">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/hawc/developers/developers.html" accesskey="U">HAWC+ DRP Developer’s Manual</a> &#187;</li>
      
      <li>StepWcs</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="stepwcs">
<h1>StepWcs<a class="headerlink" href="#stepwcs" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sofia_redux.instruments.hawc.steps.stepwcs.StepWcs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sofia_redux.instruments.hawc.steps.stepwcs.</span></span><span class="sig-name descname"><span class="pre">StepWcs</span></span><a class="reference internal" href="../_modules/sofia_redux/instruments/hawc/steps/stepwcs.html#StepWcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sofia_redux.instruments.hawc.stepparent.StepParent.html#sofia_redux.instruments.hawc.stepparent.StepParent" title="sofia_redux.instruments.hawc.stepparent.StepParent"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepParent</span></code></a></p>
<p>Add world coordinate system definitions.</p>
<p>This pipeline step will add WCS keywords to the header, accounting for
vertical position angle (VPA) and position offsets. The reference
position is taken to be the boresight pixel position (SIBS_X, SIBS_Y) with
RA and Dec coordinates taken from TELRA and TELDEC.</p>
<p>The following header keywords are set by this step:</p>
<blockquote>
<div><ul class="simple">
<li><p>TEL_AZ : telescope azimuth</p></li>
<li><p>TEL_ELEV : telescope elevation</p></li>
<li><p>VPOS_ANG : array VPA</p></li>
<li><p>CROTA2 : image rotation, relative to North (set from -1 * VPA)</p></li>
<li><p>CRVAL1 : boresight RA (set from TELRA)</p></li>
<li><p>CRVAL2 : boresight Dec (set from TELDEC)</p></li>
<li><p>CRPIX1 : boresight x position (set from SIBS_X)</p></li>
<li><p>CRPIX2 : boresight y position (set from SIBS_Y)</p></li>
<li><p>CDELT1 : pixel scale (set from PIXSCAL)</p></li>
<li><p>CDELT2 : pixel scale (set from PIXSCAL)</p></li>
<li><p>CTYPE1 : WCS projection (set to ‘RA—TAN’)</p></li>
<li><p>CTYPE2 : WCS projection (set to ‘DEC–TAN’)</p></li>
</ul>
</div></blockquote>
<p>Input for this step is a DataFits containing Stokes images and
associated errors, as produced by
<code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.hawc.steps.StepStokes</span></code>.</p>
<p>Output is the same as the input file, with the above header keywords
set in the primary header.</p>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.compute_wcs" title="sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.compute_wcs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_wcs</span></code></a>()</p></td>
<td><p>Compute WCS parameters from telescope data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.read_sibs" title="sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.read_sibs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_sibs</span></code></a>()</p></td>
<td><p>Read an offset value from the parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.run" title="sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>()</p></td>
<td><p>Run the data reduction algorithm.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.setup" title="sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code></a>()</p></td>
<td><p>Set parameters and metadata for the pipeline step.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.compute_wcs">
<span class="sig-name descname"><span class="pre">compute_wcs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/hawc/steps/stepwcs.html#StepWcs.compute_wcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.compute_wcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute WCS parameters from telescope data.</p>
<p>Corrects for chop offsets between SIBS and source
position.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>crval1, crval2, crpix1, crpix2</strong><span class="classifier">tuple of float</span></dt><dd><p>WCS reference position values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.read_sibs">
<span class="sig-name descname"><span class="pre">read_sibs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/hawc/steps/stepwcs.html#StepWcs.read_sibs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.read_sibs" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an offset value from the parameters.</p>
<p>The parameters are expected to be defined as a list, with
one entry for each HAWC band. The correct value for the
input data is selected from the list.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>float</dt><dd><p>The SIBS offset value.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/hawc/steps/stepwcs.html#StepWcs.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the data reduction algorithm.</p>
<p>Because this step is single-in, single-out (SISO),
self.datain must be a DataFits object. The output
is also a DataFits object, stored in self.dataout.</p>
<p>The process is:</p>
<ol class="arabic simple">
<li><p>Compute the VPA from the ‘Array VPA’ data column.
Add 180 degrees if necessary.</p></li>
<li><p>Compute reference positions from SIBS boresight
and chop offset information.</p></li>
<li><p>Store header keywords.</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/hawc/steps/stepwcs.html#StepWcs.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameters and metadata for the pipeline step.</p>
<p>Output files have PRODTYPE = ‘wcs’, and are named with
the step abbreviation ‘WCS’.</p>
<p>Parameters defined for this step are:</p>
<dl class="simple">
<dt>add180vpa<span class="classifier">bool</span></dt><dd><p>If set, 180 degrees is added to the VPA derived from
the ‘Array VPA’ data column, before setting VPOS_ANG.</p>
</dd>
<dt>offsibs_x<span class="classifier">list of float</span></dt><dd><p>Offset in pixels to add to SIBS_X to correct for
actual target position. One value for each HAWC waveband.</p>
</dd>
<dt>offsibs_y<span class="classifier">list of float</span></dt><dd><p>Offset in pixels to add to SIBS_Y to correct for
actual target position. One value for each HAWC waveband.</p>
</dd>
<dt>labmode<span class="classifier">bool</span></dt><dd><p>If set, telescope data will be ignored and placeholder
astrometry values will be added to the header.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">StepWcs</a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs"><code class="docutils literal notranslate"><span class="pre">StepWcs</span></code></a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.compute_wcs"><code class="docutils literal notranslate"><span class="pre">StepWcs.compute_wcs()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.read_sibs"><code class="docutils literal notranslate"><span class="pre">StepWcs.read_sibs()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.run"><code class="docutils literal notranslate"><span class="pre">StepWcs.run()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.setup"><code class="docutils literal notranslate"><span class="pre">StepWcs.setup()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.instruments.hawc.steps.stepwcs.StepWcs.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>