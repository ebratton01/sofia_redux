<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ResampleKernel &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ResamplePolynomial" href="sofia_redux.toolkit.resampling.ResamplePolynomial.html" />
    <link rel="prev" title="Resample" href="sofia_redux.toolkit.resampling.Resample.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.ResamplePolynomial.html" title="ResamplePolynomial">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.Resample.html" title="Resample">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/fifils/developers/developers.html" accesskey="U">FIFI-LS Redux Developer’s Manual</a> &#187;</li>
      
      <li>ResampleKernel</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="resamplekernel">
<h1>ResampleKernel<a class="headerlink" href="#resamplekernel" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sofia_redux.toolkit.resampling.</span></span><span class="sig-name descname"><span class="pre">ResampleKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negthresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degrees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knot_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_knots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_degrees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imperfect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">large_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">distance_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_kernel.html#ResampleKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ResampleBase</span></code></p>
<p>Class to resample data using kernel convolution.</p>
<p>The kernel resampler may take regular or irregular spaced data, an
irregular or regular kernel, and use kernel convolution to resample
onto arbitrary coordinates where each output value is the convolution
of the original sample data and the given kernel.  Here, irregular
refers values that have specified coordinates.  i.e., they do not
necessarily fall onto a regular grid.</p>
<p>Generally, this class was designed to process irregular data when
convolution is required.  If both the kernel and samples exist on
regularly spaced grids, there are many alternatives that could be used
to perform such a convolution much more quickly such as
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.convolve.html#scipy.ndimage.convolve" title="(in SciPy v1.11.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.ndimage.convolve()</span></code></a>.</p>
<p>Convolution is achieved by creating a spline representation of the
kernel which is then used to interpolate values of the kernel at the
required locations.  Note that while the default settings assume that
the kernel is perfect, noisy kernels may also be supplied and smoothed
if required.  Please see the <code class="xref py py-class docutils literal notranslate"><span class="pre">Spline</span></code> class for further details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>coordinates</strong><span class="classifier">array_like of float</span></dt><dd><p>(n_features, n_samples) array of independent values.  A local
internal copy will be created if it is not a numpy.float64
type.</p>
</dd>
<dt><strong>data</strong><span class="classifier">array_like of float</span></dt><dd><p>(n_sets, n_samples) or (n_samples,) array of dependent values.
multiple (n_sets) sets of data are supplied, then n_sets solutions
will be calculated at each resampling point.</p>
</dd>
<dt><strong>kernel</strong><span class="classifier">array_like of float</span></dt><dd><p>An n_features-dimensional array containing a regularly spaced
resampling kernel or an irregular 1-D kernel array.  If the kernel
is irregular, <a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel_offsets" title="sofia_redux.toolkit.resampling.ResampleKernel.kernel_offsets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel_offsets</span></code></a> must be provided.</p>
</dd>
<dt><strong>error</strong><span class="classifier">array_like of float, optional</span></dt><dd><p>(n_sets, n_samples) or (n_samples,) array of error (1-sigma) values
associated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code> array.  <code class="xref py py-obj docutils literal notranslate"><span class="pre">error</span></code> will be used to
weight fits, and be propagated to the output error values.  If not
supplied, the error may still be calculated from residuals to the
fit during <a class="reference internal" href="sofia_redux.toolkit.resampling.ResamplePolynomial.html#sofia_redux.toolkit.resampling.ResamplePolynomial.__call__" title="sofia_redux.toolkit.resampling.ResamplePolynomial.__call__"><code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.__call__()</span></code></a>.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">array_like of bool, optional</span></dt><dd><p>(n_sets, n_data) or (n_data,) array of bool where <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>
indicates a valid data point that can be included the fitting
and <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> indicates data points that should be excluded from
the fit.  Masked points will be reflected in the output counts
array.  If not supplied, all samples are considered valid.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">float, optional</span></dt><dd><p>Specifies an outlier rejection threshold for <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code>. A data point
is identified as an outlier if abs(x_i - x_med)/MAD &gt; robust, where
x_med is the median, and MAD is the Median Absolute Deviation
defined as 1.482 * median(abs(x_i - x_med)).</p>
</dd>
<dt><strong>negthresh</strong><span class="classifier">float, optional</span></dt><dd><p>Specifies a negative value rejection threshold such that
data &lt; (-stddev(data) * negthresh) will be excluded from the fit.</p>
</dd>
<dt><strong>kernel_spacing</strong><span class="classifier">float or numpy.ndarray (float), optional</span></dt><dd><p>The spacing between kernel elements for all or each feature.  If
an array is supplied, should be of shape (n_features,).  This
feature may only be used for regular grids with n_features
dimensions.  Either <a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel_spacing" title="sofia_redux.toolkit.resampling.ResampleKernel.kernel_spacing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel_spacing</span></code></a> or <a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel_offsets" title="sofia_redux.toolkit.resampling.ResampleKernel.kernel_offsets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel_offsets</span></code></a> must be
supplied.</p>
</dd>
<dt><strong>kernel_offsets</strong><span class="classifier">tuple or array_like, optional</span></dt><dd><p>If the kernel is regular, should be an n-dimensional tuple
containing the grid indices in each dimension.  Otherwise, should
be an array of shape (n_dimensions, kernel.size).  Either
<a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel_spacing" title="sofia_redux.toolkit.resampling.ResampleKernel.kernel_spacing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel_spacing</span></code></a> or <a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel_offsets" title="sofia_redux.toolkit.resampling.ResampleKernel.kernel_offsets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel_offsets</span></code></a> must be supplied.</p>
</dd>
<dt><strong>kernel_weights</strong><span class="classifier">numpy.ndarray, optional</span></dt><dd><p>Optional weights to supply to the spline fit for each data point.
Should be the same shape as the supplied kernel.</p>
</dd>
<dt><strong>limits</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>An array of shape (n_dimensions, 2) that may be supplied to set the
minimum and maximum coordinate values used during the spline fit.
For example, limits[1, 0] sets the minimum knot value in the second
dimensions and limits[1, 1] sets the maximum knot value in the
second dimension.  By default this is set to the minimum and
maximum values of the coordinates in each dimension.</p>
</dd>
<dt><strong>degrees</strong><span class="classifier">int or numpy.ndarray (int), optional</span></dt><dd><p>The degree of spline to fit in each dimension.  Either a scalar can
be supplied pertaining to all dimensions, or an array of shape
(n_dimensions,) can be used.</p>
</dd>
<dt><strong>smoothing</strong><span class="classifier">float, optional</span></dt><dd><p>Used to specify the smoothing factor.  If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, the
smoothing will be determined based on user settings or input data.
If <code class="xref py py-obj docutils literal notranslate"><span class="pre">exact</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, smoothing will be disabled (zero).  If
<code class="xref py py-obj docutils literal notranslate"><span class="pre">exact`is</span> <span class="pre">`False</span></code>, smoothing will be set to n - sqrt(2 * n) where
n is the number of data values.  If supplied, smoothing must be
greater than zero.  See above for further details.  Note that if
smoothing is zero, and the degrees are not equal over each
dimension, smoothing will be set to <code class="xref py py-obj docutils literal notranslate"><span class="pre">eps</span></code> due to numerical
instabilities.</p>
</dd>
<dt><strong>knots</strong><span class="classifier">list or tuple or numpy.ndarray, optional</span></dt><dd><p>A set of starting knot coordinates for each dimension.  If a list
or tuple is supplied it should be of length n_dimensions where
element i is an array of shape (n_knots[i]) for dimension i.  If
an array is supplied, it should be of shape
(n_dimension, max(n_knots)). Note that there must be at least
2 * (degree + 1) knots for each dimension.  Unused or invalid
knots may be set to NaN, at the end of each array.  Knot
coordinates must also be monotonically increasing in each
dimension.</p>
</dd>
<dt><strong>knot_estimate</strong><span class="classifier">numpy.ndarray (int), optional</span></dt><dd><p>The maximum number of knots required for the spline fit in each
dimension and of shape (n_dimensions,).  If not supplied, the knot
estimate will be set to
int((n / n_dimensions) ** n_dimensions^(-1)) or n_knots if
knots were supplied and fixed.</p>
</dd>
<dt><strong>eps</strong><span class="classifier">float, optional</span></dt><dd><p>A value where 0 &lt; eps &lt; 1.  This defines the magnitude used to
identify singular values in the spline observation matrix (A).  If
any row of A[:, 0] &lt; (eps * max(A[:,0])) it will be considered
singular.</p>
</dd>
<dt><strong>fix_knots</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, do not attempt to modify or add knots to the spline fit.
Only the initial supplied user knots will be used.</p>
</dd>
<dt><strong>tolerance</strong><span class="classifier">float, optional</span></dt><dd><p>A value in the range 0 &lt; tolerance &lt; 1 used to determine the exit
criteria for the spline fit.  See above for further details.</p>
</dd>
<dt><strong>max_iteration</strong><span class="classifier">int, optional</span></dt><dd><p>The maximum number of iterations to perform when solving for the
spline fit.</p>
</dd>
<dt><strong>exact</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the initial knots used will coincide with the actual
input coordinates and smoothing will be set to zero.  No knots
should be supplied by the user in this instance.</p>
</dd>
<dt><strong>reduce_degrees</strong><span class="classifier">bool, optional</span></dt><dd><p>Only relevant if <code class="xref py py-obj docutils literal notranslate"><span class="pre">exact</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.  If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the maximum
allowable degree in each dimension will be limited to
(len(unique(x)) // 2) - 1 where x are the coordinate values in any
dimension.</p>
</dd>
<dt><strong>leaf_size</strong><span class="classifier">int, optional</span></dt><dd><p>Number of points at which to switch to brute-force during the
ball tree query algorithm.  See <code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.neighbours.BallTree</span></code>
for further details.</p>
</dd>
<dt><strong>large_data</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that this resampling algorithm will run on
a large set of data, and the ball tree should be created on
subsets of the data.</p>
</dd>
<dt><strong>distance_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Optional keyword arguments passed into
<code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.neighbors.DistanceMetric()</span></code>.  The default is to use
the “minkowski” definition with <code class="xref py py-obj docutils literal notranslate"><span class="pre">p=2</span></code>, i.e., the Euclidean
definition.  This is important in determining which samples lie
inside the window region of a resampling point, and when deriving
distance weighting factors.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ValueError</strong><span class="classifier">Invalid inputs to __init__ or __call__</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Attributes Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.degrees" title="sofia_redux.toolkit.resampling.ResampleKernel.degrees"><code class="xref py py-obj docutils literal notranslate"><span class="pre">degrees</span></code></a></p></td>
<td><p>Return the degrees of the spline fit to the kernel.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.exit_code" title="sofia_redux.toolkit.resampling.ResampleKernel.exit_code"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exit_code</span></code></a></p></td>
<td><p>Return the exit code of the spline fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.exit_message" title="sofia_redux.toolkit.resampling.ResampleKernel.exit_message"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exit_message</span></code></a></p></td>
<td><p>Return the spline exit message.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel" title="sofia_redux.toolkit.resampling.ResampleKernel.kernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel</span></code></a></p></td>
<td><p>Return the resampling kernel.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel_offsets" title="sofia_redux.toolkit.resampling.ResampleKernel.kernel_offsets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel_offsets</span></code></a></p></td>
<td><p>Return the coordinate offsets for the kernel.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel_spacing" title="sofia_redux.toolkit.resampling.ResampleKernel.kernel_spacing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel_spacing</span></code></a></p></td>
<td><p>Return the spacing between kernel grid points.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.spline" title="sofia_redux.toolkit.resampling.ResampleKernel.spline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spline</span></code></a></p></td>
<td><p>Return the spline object for the kernel fit.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.__call__" title="sofia_redux.toolkit.resampling.ResampleKernel.__call__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code></a>(*args[, cval, edge_threshold, ...])</p></td>
<td><p>Resample data defined during initialization onto new coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.block_loop" title="sofia_redux.toolkit.resampling.ResampleKernel.block_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">block_loop</span></code></a>(sample_values, error, mask, ...)</p></td>
<td><p>Perform resampling reduction in parallel or series.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.combine_blocks" title="sofia_redux.toolkit.resampling.ResampleKernel.combine_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">combine_blocks</span></code></a>(blocks, n_sets, n_fits, ...)</p></td>
<td><p>Combines the results from multiple reductions into one set.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.estimate_feature_windows" title="sofia_redux.toolkit.resampling.ResampleKernel.estimate_feature_windows"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_feature_windows</span></code></a>(*args, **kwargs)</p></td>
<td><p>Estimates the radius of the fitting window for each feature.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.process_block" title="sofia_redux.toolkit.resampling.ResampleKernel.process_block"><code class="xref py py-obj docutils literal notranslate"><span class="pre">process_block</span></code></a>(args, block)</p></td>
<td><p>Run <a class="reference internal" href="sofia_redux.toolkit.resampling.solve_fits.html#sofia_redux.toolkit.resampling.solve_fits" title="sofia_redux.toolkit.resampling.solve_fits"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_fits()</span></code></a> on each block.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.reduction_settings" title="sofia_redux.toolkit.resampling.ResampleKernel.reduction_settings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reduction_settings</span></code></a>([error_weighting, ...])</p></td>
<td><p>Define a set of reduction instructions based on user input.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.set_kernel" title="sofia_redux.toolkit.resampling.ResampleKernel.set_kernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_kernel</span></code></a>(kernel[, kernel_spacing, ...])</p></td>
<td><p>Set the kernel for subsequent fitting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.set_sample_tree" title="sofia_redux.toolkit.resampling.ResampleKernel.set_sample_tree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_sample_tree</span></code></a>(coordinates[, leaf_size, ...])</p></td>
<td><p>Build the sample tree from input coordinates.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.degrees">
<span class="sig-name descname"><span class="pre">degrees</span></span><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.degrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degrees of the spline fit to the kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>numpy.ndarray (int)</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.exit_code">
<span class="sig-name descname"><span class="pre">exit_code</span></span><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.exit_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the exit code of the spline fit.</p>
<p>Please see the <code class="xref py py-class docutils literal notranslate"><span class="pre">Spline</span></code> class for further details on
the meanings of each code.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.exit_message">
<span class="sig-name descname"><span class="pre">exit_message</span></span><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.exit_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the spline exit message.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>str</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the resampling kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>numpy.ndarray (float)</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.kernel_offsets">
<span class="sig-name descname"><span class="pre">kernel_offsets</span></span><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coordinate offsets for the kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>numpy.ndarray (float)</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.kernel_spacing">
<span class="sig-name descname"><span class="pre">kernel_spacing</span></span><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel_spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the spacing between kernel grid points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>numpy.ndarray (float)</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.spline">
<span class="sig-name descname"><span class="pre">spline</span></span><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.spline" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the spline object for the kernel fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Spline</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'distribution'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_weighting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_threading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_processes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_distance_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_rchi2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_offset_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_kernel.html#ResampleKernel.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample data defined during initialization onto new coordinates.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>args</strong><span class="classifier">array_like or n-tuple of array_like</span></dt><dd><p>args can take one of the following formats:</p>
<blockquote>
<div><ul class="simple">
<li><p>grid : n-tuple of array_like
Here <code class="xref py py-obj docutils literal notranslate"><span class="pre">n</span></code> is the number of dimensions and each array should
be of shape (n_data,).  This indicates that resampling
should occur on a grid where the first argument
corresponds to the coordinates along the first dimension.</p></li>
<li><p>single point : n-tuple of float
<code class="xref py py-obj docutils literal notranslate"><span class="pre">n</span></code> is the number of dimensions.  The coordinate to
resample onto.</p></li>
<li><p>irregular : array_like
An array of shape (n_dimensions, n_ndata) defining a
set of coordinates onto which to resample.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>cval</strong><span class="classifier">float, optional</span></dt><dd><p>During fitting, any fit that does not meet the <code class="xref py py-obj docutils literal notranslate"><span class="pre">order_algorithm</span></code>
requirement will be set to this value. This will be NaN by default.</p>
</dd>
<dt><strong>edge_threshold</strong><span class="classifier">float or array_like or float</span></dt><dd><p>If set to a value &gt; 0, edges of the fit will be masked out
according to <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_algorithm</span></code>. Values close to zero will result in
a low degree of edge clipping, while values close to 1 clip edges
to a greater extent.  The exact definition of <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_threshold</span></code>
depends on the algorithm.  For further details, please see
<code class="xref py py-func docutils literal notranslate"><span class="pre">resampling.resample_utils.check_edges()</span></code>.</p>
</dd>
<dt><strong>edge_algorithm</strong><span class="classifier">str, optional</span></dt><dd><p>Describes how to clip edges if edge_threshold is non-zero. The
available algorithms are:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘distribution’ (default): Statistics on sample distributions
are calculated, and if the resampling point is &gt; 1/threshold
standard deviations away from the sample mean, it will be
clipped.</p></li>
<li><p>‘ellipsoid’: If the samples used to fit a
resampling point deviate from the resampling point
location by more than this amount, it will be clipped.</p></li>
<li><p>‘box’: If the flattened 1-dimensional distribution
of samples center-of-mass deviates from the resampling
point location in any dimension, it will be clipped.</p></li>
<li><p>‘range’: Over each dimension, check the distribution of
points is greater than edge_threshold to the “left” and
“right” of the resampling point.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>error_weighting</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> (default), weight polynomial fitting by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">error</span></code>
values of each sample.</p>
</dd>
<dt><strong>absolute_weight</strong><span class="classifier">bool, optional</span></dt><dd><p>If the kernel weights are negative, can lead to almost zero-like
divisions in many of the algorithms.  If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the sum of
the absolute weights are used for normalization.</p>
</dd>
<dt><strong>normalize</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the data will be convolved with a normalized kernel
such that sum(kernel) = 1.  Note that this may be sum(abs(kernel))
if <code class="xref py py-obj docutils literal notranslate"><span class="pre">absolute_weight</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.</p>
</dd>
<dt><strong>is_covar</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, the input data is treated as a covariance instead of
a flux, and is propagated as if through a weighted mean.</p>
</dd>
<dt><strong>jobs</strong><span class="classifier">int, optional</span></dt><dd><p>Specifies the maximum number of concurrently running jobs.  An
attempt will be made to parallel process using a thread-pool if
available, but will otherwise revert to the “loky” backend.
Values of 0 or 1 will result in serial processing.  A negative
value sets jobs to <code class="xref py py-obj docutils literal notranslate"><span class="pre">n_cpus</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">jobs</span></code> such that -1 would use
all cpus, and -2 would use all but one cpu.</p>
</dd>
<dt><strong>use_threading</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, force use of threads during multiprocessing.</p>
</dd>
<dt><strong>use_processes</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, force use of sub-processes during multiprocessing.</p>
</dd>
<dt><strong>get_error</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, If True returns the error which is given as the weighted
RMS of the samples used for each resampling point.</p>
</dd>
<dt><strong>get_counts</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> returns the number of samples used to fit each resampling
point.</p>
</dd>
<dt><strong>get_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, returns the sum of all sample weights (error and
distance) used in the fit at each resampling point.</p>
</dd>
<dt><strong>get_distance_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, returns the sum of all sample distance weights (not
including error) used in the fit at each resampling point.</p>
</dd>
<dt><strong>get_rchi2</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, returns the reduced chi-squared statistic of the fit
at each resampling point.  Note that this is only valid if errors
were supplied during <code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.__init__()</span></code>.</p>
</dd>
<dt><strong>get_offset_variance</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, returns the offset of the resampling point from the
center of the sample distribution used to generate the fit as
a variance.  i.e., a return value of 9 indicates a 3-sigma
deviation of the resampling point from the sample distribution.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>fit, [optional return values]</dt><dd><p>The data fit at <code class="xref py py-obj docutils literal notranslate"><span class="pre">args</span></code>.  Optional return values may also be
returned if any of the get_* options are <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.  If all are set
to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the return order is: fit, error, counts, weights,
distance_weights, rchi2, cross_derivatives, offset_variance.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.block_loop">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">block_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_distance_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_rchi2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_offset_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_kernel.html#ResampleKernel.block_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.block_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform resampling reduction in parallel or series.</p>
<p>Utility function to allow the resampling algorithm to process blocks
of data in series or parallel, recombining the data once complete.
Please see <a class="reference internal" href="sofia_redux.toolkit.resampling.ResamplePolynomial.html#sofia_redux.toolkit.resampling.ResamplePolynomial.__call__" title="sofia_redux.toolkit.resampling.ResamplePolynomial.__call__"><code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.__call__()</span></code></a> for descriptions of the
arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sample_values</strong><span class="classifier">numpy.ndarray</span></dt><dd></dd>
<dt><strong>error</strong><span class="classifier">numpy.ndarray</span></dt><dd></dd>
<dt><strong>mask</strong><span class="classifier">numpy.ndarray</span></dt><dd></dd>
<dt><strong>fit_tree</strong><span class="classifier">resampling.tree.PolynomialTree object</span></dt><dd></dd>
<dt><strong>sample_tree</strong><span class="classifier">resampling.tree.PolynomialTree object</span></dt><dd></dd>
<dt><strong>settings</strong><span class="classifier">dict</span></dt><dd></dd>
<dt><strong>iteration</strong><span class="classifier">int</span></dt><dd></dd>
<dt><strong>get_error</strong><span class="classifier">bool, optional</span></dt><dd></dd>
<dt><strong>get_counts</strong><span class="classifier">bool, optional</span></dt><dd></dd>
<dt><strong>get_weights</strong><span class="classifier">bool, optional</span></dt><dd></dd>
<dt><strong>get_distance_weights</strong><span class="classifier">bool, optional</span></dt><dd></dd>
<dt><strong>get_rchi2</strong><span class="classifier">bool, optional</span></dt><dd></dd>
<dt><strong>get_offset_variance</strong><span class="classifier">bool, optional</span></dt><dd></dd>
<dt><strong>jobs</strong><span class="classifier">int, optional</span></dt><dd></dd>
<dt><strong>kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>For consistency with the resampler base only.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>combined_results</strong><span class="classifier">8-tuple of numpy.ndarray</span></dt><dd><dl class="simple">
<dt>In order: fit, error, counts, weights, distance weights,</dt><dd><p>reduced chi-squared, MSCP derivatives, distribution offset.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.combine_blocks">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">combine_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_fits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_distance_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_rchi2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_offset_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_kernel.html#ResampleKernel.combine_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.combine_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines the results from multiple reductions into one set.</p>
<p>The resampling reduction may be performed in serial or parallel over
multiple “blocks”, where each block contains a set of spatially
close fit coordinates and all samples necessary to perform a fit
over all points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>blocks</strong><span class="classifier">n-tuple of processed reductions for n blocks.</span></dt><dd></dd>
<dt><strong>n_sets</strong><span class="classifier">int</span></dt><dd><p>The number of data sets in the reduction.  Each set is contains
the same sample coordinates as all other sets, but the sample
values may vary.</p>
</dd>
<dt><strong>n_fits</strong><span class="classifier">int</span></dt><dd><p>The number of fitting points over all blocks.</p>
</dd>
<dt><strong>n_dimensions</strong><span class="classifier">int</span></dt><dd><p>The number of coordinate dimensions.</p>
</dd>
<dt><strong>cval</strong><span class="classifier">float</span></dt><dd><p>The fill value for missing data in the output fit value arrays.</p>
</dd>
<dt><strong>get_error</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that errors on the fit were calculated.</p>
</dd>
<dt><strong>get_counts</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that the number of samples used for each
fit should be returned.</p>
</dd>
<dt><strong>get_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that the total weight sum of all samples used
in each fit should be returned.</p>
</dd>
<dt><strong>get_distance_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that the distance weight sum of all samples
used in each fit should be returned.</p>
</dd>
<dt><strong>get_rchi2</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that the reduced chi-squared statistic for
each fit should be returned.</p>
</dd>
<dt><strong>get_offset_variance</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that the offset variance of the fit from the
sample distribution should be returned.</p>
</dd>
<dt><strong>kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>For consistency with ResampleBase only (not used).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>results</strong><span class="classifier">7-tuple of numpy.ndarray</span></dt><dd><p>results[0] = fitted values
results[1] = error on the fit
results[2] = counts
results[3] = total weight sums
results[4] = total distance weight sums
results[5] = reduced chi-squared statistic
results[6] = offset variance</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The return value is always an 8-tuple, and the get_* keywords indicate
whether the calculated values in the block reductions are valid.  If
<a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the corresponding output array will have the correct number of
axes, but be of zero size.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.estimate_feature_windows">
<span class="sig-name descname"><span class="pre">estimate_feature_windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_kernel.html#ResampleKernel.estimate_feature_windows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.estimate_feature_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the radius of the fitting window for each feature.</p>
<p>The window for the resampling algorithm will be set to encompass the
kernel extent over all dimensions.  Unlike the standard resampling
algorithm, the coordinates of the data samples are irrelevant.</p>
<p>The window radius is based on the kernel extent in this implementation.</p>
<p>Since the resampling algorithm uses an ellipsoid window to determine
possible candidates for fitting, the window is determined as an
ellipsoid which circumscribes the cuboid kernel array.  Although there
are an infinite number of possible ellipsoids, this particular method
uses the constraints that principle axes of the ellipsoid and cuboid
widths are at a constant ratio.  For example, in two dimensions where
a and b are the principle axes of an ellipsoid, and w and h are the
widths of the kernel:</p>
<p>a/w = b/h; (w / 2a)^2 + (h / 2b)^2 = 1.</p>
<p>This leads to us setting the principle axes as:</p>
<p>a_i = sqrt(n / 4) * w_i + delta</p>
<p>where w_i is the width of the kernel in dimension i in n-dimensions,
and delta = spacing/1e6 so that any edge cases can be included safely.
This is also valid in one dimension (a_i = w_i / 2).  Note that kernels
are assumed to be exactly centered, so the width of a kernel in any
dimension will be:</p>
<p>w_i = spacing_i * (kernel.shape[i] - 1)</p>
<p>Note that this implementation takes the width as 2 * the maximum
absolute offset of the kernel for each dimension, so that irregular
kernels may be safely used.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>window</strong><span class="classifier">numpy.ndarray (n_features,)</span></dt><dd><p>The principle axes of an ellipsoid used to create a fitting
region around each resampling point.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.process_block">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">process_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_kernel.html#ResampleKernel.process_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.process_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Run <a class="reference internal" href="sofia_redux.toolkit.resampling.solve_fits.html#sofia_redux.toolkit.resampling.solve_fits" title="sofia_redux.toolkit.resampling.solve_fits"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_fits()</span></code></a> on each block.</p>
<p>Utility function that parses the settings and tree objects to something
usable by the numba JIT compiled resampling functions.  This is not
meant to be called directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>args</strong><span class="classifier">2-tuple</span></dt><dd><p>A tuple of form (filename, iteration) where the filename is a
string pointing towards a previously saved pickle file containing
the relevant information for the reduction if required.  If set to
<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, the arguments are retrieved from the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">_global_resampling_values</span></code> global parameter.</p>
</dd>
<dt><strong>block</strong><span class="classifier">int</span></dt><dd><p>The block index to process.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>results</strong><span class="classifier">9-tuple of numpy.ndarray</span></dt><dd><p>The first element contains the fit point indices to be fit.  For
the remaining elements, please see <a class="reference internal" href="sofia_redux.toolkit.resampling.solve_fits.html#sofia_redux.toolkit.resampling.solve_fits" title="sofia_redux.toolkit.resampling.solve_fits"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_fits()</span></code></a> return
values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.reduction_settings">
<span class="sig-name descname"><span class="pre">reduction_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error_weighting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'distribution'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_threading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_processes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_kernel.html#ResampleKernel.reduction_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.reduction_settings" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a set of reduction instructions based on user input.</p>
<p>This method is responsible for determining, formatting, and checking
a number variables required for the resampling algorithm based on
user input.  For detailed descriptions of user options, please see
<a class="reference internal" href="sofia_redux.toolkit.resampling.ResamplePolynomial.html#sofia_redux.toolkit.resampling.ResamplePolynomial.__call__" title="sofia_redux.toolkit.resampling.ResamplePolynomial.__call__"><code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.__call__()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>error_weighting</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> (default), weight polynomial fitting by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">error</span></code>
values of each sample.</p>
</dd>
<dt><strong>absolute_weight</strong><span class="classifier">bool, optional</span></dt><dd><p>If the kernel weights are negative, can lead to almost zero-like
divisions in many of the algorithms.  If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the sum of
the absolute weights are used for normalization.</p>
</dd>
<dt><strong>fit_threshold</strong><span class="classifier">float, optional</span></dt><dd><p>Not implemented for kernel fitting.</p>
</dd>
<dt><strong>cval</strong><span class="classifier">float, optional</span></dt><dd><p>During fitting, any fit that does not meet the <code class="xref py py-obj docutils literal notranslate"><span class="pre">order_algorithm</span></code>
requirement will be set to this value. This will be NaN by default.</p>
</dd>
<dt><strong>edge_threshold</strong><span class="classifier">float or array_like or float</span></dt><dd><p>If set to a value &gt; 0, edges of the fit will be masked out
according to <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_algorithm</span></code>. Values close to zero will result in
a low degree of edge clipping, while values close to 1 clip edges
to a greater extent.  The exact definition of <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_threshold</span></code>
depends on the algorithm.  For further details, please see
<code class="xref py py-func docutils literal notranslate"><span class="pre">resampling.resample_utils.check_edges()</span></code>.</p>
</dd>
<dt><strong>edge_algorithm</strong><span class="classifier">str, optional</span></dt><dd><p>Describes how to clip edges if edge_threshold is non-zero. The
available algorithms are:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘distribution’ (default): Statistics on sample distributions
are calculated, and if the resampling point is &gt; 1/threshold
standard deviations away from the sample mean, it will be
clipped.</p></li>
<li><p>‘ellipsoid’: If the samples used to fit a
resampling point deviate from the resampling point
location by more than this amount, it will be clipped.</p></li>
<li><p>‘box’: If the flattened 1-dimensional distribution
of samples center-of-mass deviates from the resampling
point location in any dimension, it will be clipped.</p></li>
<li><p>‘range’: Over each dimension, check the distribution of
points is greater than edge_threshold to the “left” and
“right” of the resampling point.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>is_covar</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, the input data is treated as a covariance instead of
a flux, and is propagated as if through a weighted mean.</p>
</dd>
<dt><strong>jobs</strong><span class="classifier">int, optional</span></dt><dd><p>Specifies the maximum number of concurrently running jobs.  An
attempt will be made to parallel process using a thread-pool if
available, but will otherwise revert to the “loky” backend.
Values of 0 or 1 will result in serial processing.  A negative
value sets jobs to <code class="xref py py-obj docutils literal notranslate"><span class="pre">n_cpus</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">jobs</span></code> such that -1 would use
all cpus, and -2 would use all but one cpu.</p>
</dd>
<dt><strong>use_threading</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, force use of threads during multiprocessing.</p>
</dd>
<dt><strong>use_processes</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, force use of sub-processes during multiprocessing.</p>
</dd>
<dt><strong>kwargs</strong><span class="classifier">dict</span></dt><dd><p>Optional keyword arguments to the reduction settings.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>settings</strong><span class="classifier">dict</span></dt><dd><p>The reduction settings.  Also, stored as
<code class="xref py py-func docutils literal notranslate"><span class="pre">ResamplePolynomial.fit_settings()</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.set_kernel">
<span class="sig-name descname"><span class="pre">set_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degrees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knot_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_knots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_degrees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imperfect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_kernel.html#ResampleKernel.set_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.set_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the kernel for subsequent fitting.</p>
<p>During this process, a spline will be fit to describe the kernel at
all intermediate points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>kernel</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The kernel to set.  Must have n_features dimensions.</p>
</dd>
<dt><strong>kernel_spacing</strong><span class="classifier">float or numpy.ndarray (float), optional</span></dt><dd><p>The spacing between each kernel element in units of the
coordinates. Either supplied as a single value for all features,
or as an array of shape (n_features,) giving the kernel spacing
for each feature.</p>
</dd>
<dt><strong>kernel_offsets</strong><span class="classifier">tuple or array_like, optional</span></dt><dd><p>If the kernel is regular, should be an n-dimensional tuple
containing the grid indices in each dimension.  Otherwise, should
be an array of shape (n_dimensions, kernel.size).</p>
</dd>
<dt><strong>weights</strong><span class="classifier">numpy.ndarray, optional</span></dt><dd><p>Optional weights to supply to the spline fit for each data point.
Should be the same shape as the supplied kernel.</p>
</dd>
<dt><strong>limits</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>An array of shape (n_dimensions, 2) that may be supplied to set the
minimum and maximum coordinate values used during the spline fit.
For example, limits[1, 0] sets the minimum knot value in the second
dimensions and limits[1, 1] sets the maximum knot value in the
second dimension.  By default this is set to the minimum and
maximum values of the coordinates in each dimension.</p>
</dd>
<dt><strong>degrees</strong><span class="classifier">int or numpy.ndarray (int), optional</span></dt><dd><p>The degree of spline to fit in each dimension.  Either a scalar can
be supplied pertaining to all dimensions, or an array of shape
(n_dimensions,) can be used.</p>
</dd>
<dt><strong>smoothing</strong><span class="classifier">float, optional</span></dt><dd><p>Used to specify the smoothing factor.  If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, the
smoothing will be determined based on user settings or input data.
If <code class="xref py py-obj docutils literal notranslate"><span class="pre">exact</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, smoothing will be disabled (zero).  If
<code class="xref py py-obj docutils literal notranslate"><span class="pre">exact</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, smoothing will be set to n - sqrt(2 * n)
where n is the number of data values.  If supplied, smoothing
must be greater than zero.  See above for further details.  Note
that if smoothing is zero, and the degrees are not equal over
each dimension, smoothing will be set to <code class="xref py py-obj docutils literal notranslate"><span class="pre">eps</span></code> due to numerical
instabilities.</p>
</dd>
<dt><strong>knots</strong><span class="classifier">list or tuple or numpy.ndarray, optional</span></dt><dd><p>A set of starting knot coordinates for each dimension.  If a list
or tuple is supplied it should be of length n_dimensions where
element i is an array of shape (n_knots[i]) for dimension i.  If
an array is supplied, it should be of shape
(n_dimension, max(n_knots)). Note that there must be at least
2 * (degree + 1) knots for each dimension.  Unused or invalid
knots may be set to NaN, at the end of each array.  Knot
coordinates must also be monotonically increasing in each
dimension.</p>
</dd>
<dt><strong>knot_estimate</strong><span class="classifier">numpy.ndarray (int), optional</span></dt><dd><p>The maximum number of knots required for the spline fit in each
dimension and of shape (n_dimensions,).  If not supplied, the knot
estimate will be set to
int((n / n_dimensions) ** n_dimensions^(-1)) or n_knots if
knots were supplied and fixed.</p>
</dd>
<dt><strong>eps</strong><span class="classifier">float, optional</span></dt><dd><p>A value where 0 &lt; eps &lt; 1.  This defines the magnitude used to
identify singular values in the spline observation matrix (A).  If
any row of A[:, 0] &lt; (eps * max(A[:,0])) it will be considered
singular.</p>
</dd>
<dt><strong>fix_knots</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, do not attempt to modify or add knots to the spline fit.
Only the initial supplied user knots will be used.</p>
</dd>
<dt><strong>tolerance</strong><span class="classifier">float, optional</span></dt><dd><p>A value in the range 0 &lt; tolerance &lt; 1 used to determine the exit
criteria for the spline fit.  See above for further details.</p>
</dd>
<dt><strong>max_iteration</strong><span class="classifier">int, optional</span></dt><dd><p>The maximum number of iterations to perform when solving for the
spline fit.</p>
</dd>
<dt><strong>exact</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the initial knots used will coincide with the actual
input coordinates and smoothing will be set to zero.  No knots
should be supplied by the user in this instance.</p>
</dd>
<dt><strong>reduce_degrees</strong><span class="classifier">bool, optional</span></dt><dd><p>Only relevant if <code class="xref py py-obj docutils literal notranslate"><span class="pre">exact</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.  If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the maximum
allowable degree in each dimension will be limited to
(len(unique(x)) // 2) - 1 where x are the coordinate values in any
dimension.</p>
</dd>
<dt><strong>imperfect</strong><span class="classifier">bool, optional</span></dt><dd><p>If a spline fit to the kernel is allowed to be imperfect (<a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>),
will only raise an error on spline fitting if a major error was
encountered.  Otherwise, fits will be permitted so long as a
solution was reached, even if that solution did not meet
expectations.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.ResampleKernel.set_sample_tree">
<span class="sig-name descname"><span class="pre">set_sample_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">large_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">distance_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_kernel.html#ResampleKernel.set_sample_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.ResampleKernel.set_sample_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the sample tree from input coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>coordinates</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The input coordinates of shape (n_features, n_samples).</p>
</dd>
<dt><strong>leaf_size</strong><span class="classifier">int, optional</span></dt><dd><p>Number of points at which to switch to brute-force during the
ball tree query algorithm.  See <code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.neighbours.BallTree</span></code>
for further details.</p>
</dd>
<dt><strong>large_data</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that this resampling algorithm will run on
a large set of data, and the ball tree should be created on
subsets of the data.</p>
</dd>
<dt><strong>distance_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Optional keyword arguments passed into
<code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.neighbors.DistanceMetric()</span></code>.  The default is to use
the “minkowski” definition with <code class="xref py py-obj docutils literal notranslate"><span class="pre">p=2</span></code>, i.e., the Euclidean
definition.  This is important in determining which samples lie
inside the window region of a resampling point, and when deriving
distance weighting factors.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">ResampleKernel</a><ul>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel"><code class="docutils literal notranslate"><span class="pre">ResampleKernel</span></code></a><ul>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.degrees"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.degrees</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.exit_code"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.exit_code</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.exit_message"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.exit_message</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.kernel</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel_offsets"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.kernel_offsets</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.kernel_spacing"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.kernel_spacing</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.spline"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.spline</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.__call__"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.__call__()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.block_loop"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.block_loop()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.combine_blocks"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.combine_blocks()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.estimate_feature_windows"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.estimate_feature_windows()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.process_block"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.process_block()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.reduction_settings"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.reduction_settings()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.set_kernel"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.set_kernel()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.ResampleKernel.set_sample_tree"><code class="docutils literal notranslate"><span class="pre">ResampleKernel.set_sample_tree()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.toolkit.resampling.ResampleKernel.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>