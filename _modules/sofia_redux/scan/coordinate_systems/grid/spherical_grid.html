<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sofia_redux.scan.coordinate_systems.grid.spherical_grid &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/plot_directive.css" />
    
    <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../../../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../../../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../../../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../../../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sofia_redux.scan.coordinate_systems.grid.spherical_grid</h1><div class="highlight"><pre>
<span></span># Licensed under a 3-clause BSD style license - see LICENSE.rst

from astropy import units

from sofia_redux.scan.coordinate_systems.grid.grid_2d import Grid2D
from sofia_redux.scan.coordinate_systems.spherical_coordinates import \
    SphericalCoordinates
from sofia_redux.scan.coordinate_systems.projection.spherical_projection \
    import SphericalProjection

__all__ = [&#39;SphericalGrid&#39;]


<div class="viewcode-block" id="SphericalGrid"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.html#sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid">[docs]</a>class SphericalGrid(Grid2D):

    def __init__(self, reference=None):
        &quot;&quot;&quot;
        Initialize a spherical grid.

        The spherical grid is used to convert between longitude/latitude
        coordinates on a sphere and offsets in relation to a specified
        reference position onto a regular grid, and the reverse operation.

        Forward transform: grid projection -&gt; offsets -&gt; coordinates
        Reverse transform: coordinates -&gt; offsets -&gt; grid projection

        Parameters
        ----------
        reference : SphericalCoordinates
            The reference coordinate from which to base any projections.
        &quot;&quot;&quot;
        super().__init__()
        # default Gnomonic projection
        self.projection = SphericalProjection.for_name(&#39;TAN&#39;)
        if isinstance(reference, SphericalCoordinates):
            self.set_reference(reference)
        elif reference is not None:
            raise ValueError(f&quot;Reference must be {SphericalCoordinates} &quot;
                             f&quot;class. Received {reference}.&quot;)

<div class="viewcode-block" id="SphericalGrid.set_defaults"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.html#sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.set_defaults">[docs]</a>    def set_defaults(self):
        &quot;&quot;&quot;
        Set the default values for the grid.

        Returns
        -------
        None
        &quot;&quot;&quot;
        super().set_defaults()
        self.set_coordinate_system(
            SphericalCoordinates.get_default_system()[0])</div>

    @property
    def reference(self):
        &quot;&quot;&quot;
        Return the reference value for the spherical grid.

        Returns
        -------
        SphericalCoordinates
        &quot;&quot;&quot;
        return super().reference

    @reference.setter
    def reference(self, value):
        &quot;&quot;&quot;
        Return the reference value for the spherical grid.

        Parameters
        ----------
        value : SphericalCoordinates

        Returns
        -------
        None
        &quot;&quot;&quot;
        self.set_reference(value)

    @property
    def fits_x_unit(self):
        &quot;&quot;&quot;
        Return the unit for the FITS x-axis.

        Returns
        -------
        units.Unit
        &quot;&quot;&quot;
        return units.Unit(&#39;degree&#39;)

    @property
    def fits_y_unit(self):
        &quot;&quot;&quot;
        Return the unit for the FITS y-axis.

        Returns
        -------
        units.Unit
        &quot;&quot;&quot;
        return units.Unit(&#39;degree&#39;)

<div class="viewcode-block" id="SphericalGrid.get_default_unit"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.html#sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.get_default_unit">[docs]</a>    @classmethod
    def get_default_unit(cls):
        &quot;&quot;&quot;
        Return the default unit for the grid class.

        Returns
        -------
        unit : units.Unit
        &quot;&quot;&quot;
        return units.Unit(&#39;degree&#39;)</div>

<div class="viewcode-block" id="SphericalGrid.get_coordinate_instance_for"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.html#sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.get_coordinate_instance_for">[docs]</a>    @classmethod
    def get_coordinate_instance_for(cls, ctype):
        &quot;&quot;&quot;
        Return a coordinate instance for the given name.

        Parameters
        ----------
        ctype : str

        Returns
        -------
        SphericalCoordinates
        &quot;&quot;&quot;
        return SphericalCoordinates.get_fits_class(ctype)()</div>

<div class="viewcode-block" id="SphericalGrid.set_reference"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.html#sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.set_reference">[docs]</a>    def set_reference(self, reference):
        &quot;&quot;&quot;
        Set the reference position of the grid.

        Parameters
        ----------
        reference : SphericalCoordinates

        Returns
        -------
        None
        &quot;&quot;&quot;
        super().set_reference(reference)
        self.set_coordinate_system(reference.coordinate_system)</div>

<div class="viewcode-block" id="SphericalGrid.is_reverse_x"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.html#sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.is_reverse_x">[docs]</a>    def is_reverse_x(self):
        &quot;&quot;&quot;
        Returns if the x-axis is reversed.

        Returns
        -------
        bool
        &quot;&quot;&quot;
        return self.reference.reverse_longitude</div>

<div class="viewcode-block" id="SphericalGrid.is_reverse_y"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.html#sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.is_reverse_y">[docs]</a>    def is_reverse_y(self):
        &quot;&quot;&quot;
        Returns if the y-axis is reversed.

        Returns
        -------
        bool
        &quot;&quot;&quot;
        return self.reference.reverse_latitude</div>

<div class="viewcode-block" id="SphericalGrid.parse_projection"><a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.html#sofia_redux.scan.coordinate_systems.grid.spherical_grid.SphericalGrid.parse_projection">[docs]</a>    def parse_projection(self, header):
        &quot;&quot;&quot;
        Parse the projection from the header.

        The projection is taken from the CTYPE1 value in the header (if no
        alternate designation is prescribed), beginning with the 5th character.
        For example, RA---TAN parses &quot;-TAN&quot; to create a gnomonic projection.

        Parameters
        ----------
        header : fits.Header

        Returns
        -------
        None
        &quot;&quot;&quot;
        alt = self.get_fits_id()
        ctype = header.get(f&#39;CTYPE1{alt}&#39;)
        if len(ctype) &lt; 6:
            raise ValueError(f&quot;Cannot extract projection from CTYPE={ctype}&quot;)
        projection = ctype[5:]
        try:
            self.set_projection(SphericalProjection.for_name(projection))
        except ValueError:
            raise ValueError(f&quot;Unknown projection: {projection}.&quot;)</div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>