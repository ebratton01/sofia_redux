<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Search Phase &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    
    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Polynomial Coefficients" href="polynomial.html" />
    <link rel="prev" title="Fitting (sofia_redux.toolkit.fitting)" href="index.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="polynomial.html" title="Polynomial Coefficients">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="index.html" title="Fitting (sofia_redux.toolkit.fitting)">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../../index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../index.html" >sofia_redux.toolkit: Shared Utilities for SOFIA Pipelines</a> &#187;</li>
      <li><a href="index.html" accesskey="U">Fitting  (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.toolkit.fitting</span></code>)</a> &#187;</li>
      
      <li>Search Phase</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p><a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d.html#sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d" title="sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitpeaks1d()</span></code></a> is designed to fit a signal, or superimposed
signals, along with a background to 1-dimensional data.  It is essentially
a wrapper for the <a class="reference external" href="https://docs.astropy.org/en/stable/modeling/reference_api.html#module-astropy.modeling" title="(in Astropy v5.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">astropy.modeling</span></code></a> module allowing for customization,
and ease of use for the most common case uses (developed using astronomical
data).  The algorithm is divided into three phases: the search phase,
an initial baseline estimate, and the refined fitting phase:</p>
<section id="search-phase">
<h1>Search Phase<a class="headerlink" href="#search-phase" title="Permalink to this heading">¶</a></h1>
<p>The purpose of the search phase is to get a good approximation of peak
locations in the data along the independent axis.  These may be supplied by
the user (e.g. known apertures), or an estimate may be made.  Estimates are
made using the following process:</p>
<section id="processing-function-optional">
<h2>1. Processing function (Optional)<a class="headerlink" href="#processing-function-optional" title="Permalink to this heading">¶</a></h2>
<p>Apply a processing function to <span class="math notranslate nohighlight">\((x, y)\)</span> data to return a approximate
baseline and new dependent values (<span class="math notranslate nohighlight">\(y^{\prime}\)</span>) for the subsequent step
to operate on.  The default processing function (<a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline.html#sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline" title="sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline"><code class="xref py py-func docutils literal notranslate"><span class="pre">medabs_baseline()</span></code></a>)
subtracts the median y value and then returns absolute values:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[y^{\prime} = | y - median(y) |\]</div>
</div></blockquote>
<p>(<a class="reference download internal" download="" href="../../../_downloads/48b86e0a5da0cc0e2fa12008bfdd6a9c/fitpeaks1d-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/ccc5d454800c750c8143f613c805b52c/fitpeaks1d-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/53c05e1e65532f3b808651ae3ac851ec/fitpeaks1d-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/aa9558f6c0c44771a29d4ab956d2b273/fitpeaks1d-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/fitpeaks1d-1.png" class="plot-directive" src="../../../_images/fitpeaks1d-1.png" />
</figure>
<p>The default <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline.html#sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline" title="sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline"><code class="xref py py-func docutils literal notranslate"><span class="pre">medabs_baseline()</span></code></a> function is just designed to be a
general usage quick function to handle positive and negative peaked signals.
This may be not be suitable for some data sets in which case the user should
write their own function that takes in (x, y) and returns (<span class="math notranslate nohighlight">\(y^{\prime}\)</span>,
baseline) where all inputs and outputs are 1-D <a class="reference external" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="(in NumPy v1.25)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code></a> arrays of the same
size.</p>
</section>
<section id="guess-function-optional">
<h2>2. Guess function (Optional)<a class="headerlink" href="#guess-function-optional" title="Permalink to this heading">¶</a></h2>
<p>The next step passes <span class="math notranslate nohighlight">\((x, y^{\prime}\)</span> to the guess function which should
be designed to return a quick estimate of the x and y value for the most
prominent peak <span class="math notranslate nohighlight">\((x_{peak}, y^{\prime}_{peak}) `in :math:`y^{\prime}\)</span>
(not <span class="math notranslate nohighlight">\(y\)</span>).  The default guess function
(<a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.guess_xy_mad.html#sofia_redux.toolkit.fitting.fitpeaks1d.guess_xy_mad" title="sofia_redux.toolkit.fitting.fitpeaks1d.guess_xy_mad"><code class="xref py py-func docutils literal notranslate"><span class="pre">guess_xy_mad()</span></code></a>) is designed to work with the default processing function
(<a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline.html#sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline" title="sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline"><code class="xref py py-func docutils literal notranslate"><span class="pre">medabs_baseline()</span></code></a>). Therefore, if changing one, be considerate of the
other. <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline.html#sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline" title="sofia_redux.toolkit.fitting.fitpeaks1d.medabs_baseline"><code class="xref py py-func docutils literal notranslate"><span class="pre">medabs_baseline()</span></code></a> returns the following:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\begin{eqnarray}
y_{peak} &amp; = &amp; max(|y^{\prime} - median(y^{\prime}) | ) \\
x_{peak} &amp; = &amp; x \, | \, y^{\prime}(x) = y_{peak}
\end{eqnarray}</div></div></blockquote>
<p>(<a class="reference download internal" download="" href="../../../_downloads/7b3941041bf2d8928d46e4ee02086a74/fitpeaks1d-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/433df94d05b5108f15d7008f5c86c807/fitpeaks1d-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/fea6088afa8f464d877e87f634123812/fitpeaks1d-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/bd6fde2ec08295047a1afb0a52d5e920/fitpeaks1d-2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/fitpeaks1d-2.png" class="plot-directive" src="../../../_images/fitpeaks1d-2.png" />
</figure>
</section>
<section id="rough-initial-parameter-estimation-and-the-box-function">
<h2>3. Rough Initial Parameter Estimation and the Box Function<a class="headerlink" href="#rough-initial-parameter-estimation-and-the-box-function" title="Permalink to this heading">¶</a></h2>
<p>A fit is then performed at either the most prominent peak identified in steps
1 and 2, or the first user supplied guess position.  The parameters determined
here will be used as initialization parameters for the final fitting and also
(if required), to search for other peaks in the data.  When fitting peaks that
are close together, or the data has structure in the baseline, it can be
important to use a box function to limit the range of the fitting along
<span class="math notranslate nohighlight">\(x\)</span>.  Initial fits to the most prominent peak are shown below with and
without the boxing function.</p>
<p>(<a class="reference download internal" download="" href="../../../_downloads/119e1df0b4e0c8a4e37b67d4e3975d83/fitpeaks1d-3.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/0ee1c1d7694de6957f63c0ecc56cae67/fitpeaks1d-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/68b7d57f675638ffac22cec20f535a92/fitpeaks1d-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/7836bfb9403d2c61ad430a61217d0312/fitpeaks1d-3.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/fitpeaks1d-3.png" class="plot-directive" src="../../../_images/fitpeaks1d-3.png" />
</figure>
<p>There are a couple of things to note above.  Firstly, the fit on the right
(without a box function) has fit both peaks present in the data with a
single Gaussian, which is obviously incorrect.  Secondly, the fit on the left
did not fit the peak very well, which is why a second more refined fit occurs
at a later stage.  Clipping of the fit due to the box function can also be
seen in the left plot.  Finally, while the initial fit on the right failed,
there is still a good chance that the final fit will still fit the data
correctly since this is a fairly simple model.</p>
<p>The default box function is a <code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.modeling.models.Box1D</span></code> with a
width of 6 times the width parameter of the peak function (fwhm in the case of
the default <code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.modeling.models.Gaussian1D</span></code>).  However, since it
will not always be the case that we wish to fit Gaussians, or that the best
way to separate one peak from another is a standard box (hat) function, the box
function, the peak width parameter and it’s relationship to the width of the
box function can be configured.  The box model must be a
<a class="reference internal" href="https://docs.astropy.org/en/stable/api/astropy.modeling.Fittable1DModel.html#astropy.modeling.Fittable1DModel" title="astropy.modeling.Fittable1DModel"><code class="docutils literal notranslate"><span class="pre">astropy.modeling.Fittable1DModel</span></code></a> and is passed into
<a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d.html#sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d" title="sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitpeaks1d()</span></code></a> with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">box_class</span></code> parameter.</p>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">box_width</span></code> parameter can either be a single <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a> value, in
which case the width if the box will be held fixed (in units of <span class="math notranslate nohighlight">\(x\)</span>).
Alternatively, a tuple of the form <code class="xref py py-obj docutils literal notranslate"><span class="pre">(peak_parameter_name,</span> <span class="pre">width)</span></code> can be
supplied indicating that the width of the box should always a <code class="xref py py-obj docutils literal notranslate"><span class="pre">width</span></code> multiple
of certain parameter of the peak model.  More complex relationships can also
be defined through the <code class="xref py py-obj docutils literal notranslate"><span class="pre">search_kwargs</span></code> parameter which will be described later.</p>
</section>
<section id="identify-remaining-peaks">
<h2>4. Identify remaining peaks<a class="headerlink" href="#identify-remaining-peaks" title="Permalink to this heading">¶</a></h2>
<p>Once the first or most prominent peak has undergone initial parameterization,
it’s fit will be subtracted from <span class="math notranslate nohighlight">\(y^{\prime}\)</span> and steps 1-3 will be
repeated do identify up to <code class="xref py py-obj docutils literal notranslate"><span class="pre">npeaks</span></code> (default=1) peaks.  If more than one peaks
are to be identified, this MUST be specified by the user.  If automatically
detecting peaks, peaks will be fit in the order of most prominent to least
as determined from the initial search phase.  Otherwise, if guess positions
were supplied by the user, peaks will be fit in the supplied order.</p>
<p>(<a class="reference download internal" download="" href="../../../_downloads/298ecd4ed0bd09f57562db8ddf0d545a/fitpeaks1d-4.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/bf5d0bf951d08eecc83b64aad4affc07/fitpeaks1d-4.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/5e84fb89d1a516fdc1b433c80d6d5ac1/fitpeaks1d-4.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/56b6a141cf3fe72f4cbf185e51bdd6af/fitpeaks1d-4.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/fitpeaks1d-4.png" class="plot-directive" src="../../../_images/fitpeaks1d-4.png" />
</figure>
</section>
</section>
<section id="initial-baseline-fitting">
<h1>Initial Baseline Fitting<a class="headerlink" href="#initial-baseline-fitting" title="Permalink to this heading">¶</a></h1>
<p>Once estimates of the peak parameters have been determined from the search
phase, they are used to initialize a final model comprising of <code class="xref py py-obj docutils literal notranslate"><span class="pre">npeaks</span></code> peaks
and an optional baseline.  By default, a constant offset value will be used
to model the baseline (<code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.modeling.models.Const1D</span></code>) although any
<a class="reference internal" href="https://docs.astropy.org/en/stable/api/astropy.modeling.Fittable1DModel.html#astropy.modeling.Fittable1DModel" title="astropy.modeling.Fittable1DModel"><code class="docutils literal notranslate"><span class="pre">astropy.modeling.Fittable1DModel</span></code></a> may be used if passed into
via the <code class="xref py py-obj docutils literal notranslate"><span class="pre">background_class</span></code> keyword argument.</p>
<p>Before final fitting, the user may process the data one final time in a
similar way to <code class="xref py py-obj docutils literal notranslate"><span class="pre">baseline_func</span></code> using the <code class="xref py py-obj docutils literal notranslate"><span class="pre">optional_func</span></code> keyword argument to
pass in a function of the form <span class="math notranslate nohighlight">\(y^{\prime} = f(x, y)\)</span>.  There are not
many instances when one may want to do this, except for possibly filtering
or smoothing the initial data.</p>
<p>Next, if the user has requested a baseline fit, a fit may be performed to
initialize the background component of the final model.  This baseline fit
will be performed on the residual between the initial peak fit and the
original data.  Alternatively, the user may supply expected background
parameters.  For example, offset for a constant background or slope and offset
for a linear function.  These may be supplied through the <code class="xref py py-obj docutils literal notranslate"><span class="pre">binit</span></code> keyword
argument.</p>
<p>(<a class="reference download internal" download="" href="../../../_downloads/2ab4add37686ee896fb4fcb811e512ea/fitpeaks1d-5.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/b5f455360b394aee8ddbe173edb0548e/fitpeaks1d-5.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/bc95e562287d6d5944cbb5b8666bf1ff/fitpeaks1d-5.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/f18e1cdcfbd41d4fc9f07402915cdb88/fitpeaks1d-5.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/fitpeaks1d-5.png" class="plot-directive" src="../../../_images/fitpeaks1d-5.png" />
</figure>
<p>The above plot shows an initial baseline fit on the residual of the data
to the initial peak fits on the left, and the initialized model generated
from the peak and baseline approximation on the right.  As can be seen, the
model does show some discrepancy from the actual data, but provides a good
starting point for a final fit to be performed.</p>
</section>
<section id="final-refined-fit">
<h1>Final Refined Fit<a class="headerlink" href="#final-refined-fit" title="Permalink to this heading">¶</a></h1>
<p>Finally, a new model, initialized by the previous peak and baseline fits is
used as a starting point to fit the full model and baseline in it’s
entirety.  This time, no boxing function is applied as we will have hopefully
untangled any compound peaks or confusing baseline structure in the previous
steps.  The code below runs all steps using the <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d.html#sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d" title="sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitpeaks1d()</span></code></a> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fitting</span>
<span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.fitpeaks1d</span> <span class="kn">import</span> <span class="n">fitpeaks1d</span>

<span class="c1"># Create some fake data with noise</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">model2</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">model1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">model2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">100</span>
<span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">y</span> <span class="o">+=</span> <span class="n">rand</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">fitpeaks1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">npeaks</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">background_class</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">Linear1D</span><span class="p">,</span>
                   <span class="n">box_width</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;stddev&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                   <span class="n">search_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;stddev_0&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Data and Fit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">fit</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Residual&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/3d661d4d1a67d6a53bbc5f907d486613/fitpeaks1d-6.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/ab0a78240fa7e2594558edc8ef2ecf02/fitpeaks1d-6.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/36b6c30ef8180f46e7372235eb20e867/fitpeaks1d-6.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/233ca1f4ee74df1d46303c95049e3894/fitpeaks1d-6.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/fitpeaks1d-6.png" class="plot-directive" src="../../../_images/fitpeaks1d-6.png" />
</figure>
<p>Note that in the above example, <code class="xref py py-obj docutils literal notranslate"><span class="pre">search_kwargs={'stddev_0':</span> <span class="pre">0.1}</span></code> is used to
set an initial value for the fwhm of each peak to 0.1 as if not specified,
the default value for the astropy model will be used instead.  In this case,
for a <code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.modeling.models.Gaussian1D</span></code>, the default value is 1
which is much too large for our expected peaks.  Therefore, during the
iterative fitting process, as fwhm is decreased, a local minimum in the cost
function will be encountered by fitting both peaks with a single Gaussian,
causing the iteration to stop at a result similar to the plot showing a fit
without a box function.  Also note that when using a boxing function during
the search phase, peak name parameters are distinguished from box name
parameters by the ‘_0’ suffix (<code class="xref py py-obj docutils literal notranslate"><span class="pre">stddev_0</span></code> in this case).  Likewise, box name
parameters are suffixed by ‘_1’.</p>
</section>
<section id="model-functionality">
<h1>Model Functionality<a class="headerlink" href="#model-functionality" title="Permalink to this heading">¶</a></h1>
<p>Once a model has been fit to the data, there are a few features that should
hopefully be useful to the user:</p>
<section id="fit-information">
<h2>Fit Information<a class="headerlink" href="#fit-information" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference external" href="https://docs.python.org/3/library/functions.html#print" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">print()</span></code></a> function can be used to display what the components of the
model are, how they are related, and give parameter values.  For example,
using print on the above model generates the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt;&gt; print(model)
Model: CompoundModel
Name: 2_peaks_with_background
Inputs: (&#39;x&#39;,)
Outputs: (&#39;y&#39;,)
Model set size: 1
Expression: [0] + [1] + [2]
Components:
    [0]: &lt;Gaussian1D(amplitude=2.99771258, mean=5.0000777, stddev=0.49993379)&gt;

    [1]: &lt;Gaussian1D(amplitude=4.00083062, mean=4.00004859, stddev=0.20010122)&gt;

    [2]: &lt;Linear1D(slope=0.05014067, intercept=99.99969687)&gt;
Parameters:
       amplitude_0          mean_0      ...       slope_2         intercept_2
    ------------------ ---------------- ... ------------------- ----------------
    2.9977125792665062 5.00007770385712 ... 0.05014066710980406 99.9996968671665
</pre></div>
</div>
<p>This tells us that there are 3 components to our final model consisting of
2 peaks and one background.  If a baseline was fit to the data, it will always
exist as the last component of the model.  Each component may be accessed
through standard python indexing.,  i.e.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">peak1</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">peak2</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>Again, each component can also display information to the user through
<a class="reference external" href="https://docs.python.org/3/library/functions.html#print" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">print()</span></code></a>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt;&gt; print(peak1)
Model: Gaussian1D
Inputs: (&#39;x&#39;,)
Outputs: (&#39;y&#39;,)
Model set size: 1
Parameters:
        amplitude            mean             stddev
    ------------------ ---------------- ------------------
    2.9977125792665062 5.00007770385712 0.4999337879214602
</pre></div>
</div>
<p>Parameter values may be extracted programmatically using the <code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>
attribute of the full model or any component model.  Names of the parameters
are stored in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">param_names</span></code> attribute.  Note that parameter names are
suffixed with “_n” if accessed from the full model where n indicates the
component index.  For example, “mean_1” would contain the mean <span class="math notranslate nohighlight">\(x\)</span>
location of the 2nd Gaussian peak in the above examples.  Component parameter
names have no such suffix.  Parameters may also be accessed through model
attributes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">param_names</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">param_names</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">amplitude_0</span><span class="p">,</span> <span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">amplitude</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(&#39;amplitude_0&#39;, &#39;mean_0&#39;, &#39;stddev_0&#39;)
(&#39;amplitude&#39;, &#39;mean&#39;, &#39;stddev&#39;)
</pre></div>
</div>
</section>
<section id="evaluating-models">
<h2>Evaluating Models<a class="headerlink" href="#evaluating-models" title="Permalink to this heading">¶</a></h2>
<p>The full and component models may be evaluated at user supplied dependent
variable locations.  Standard arithmetic operations may also be performed
on models (or components) to create new manipulations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">model</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="n">x</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Baseline Subtracted Data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="mi">2</span><span class="p">])(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;baseline + 2nd peak&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Adding Model Components&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/1dd55efaf062425d80b79046c46896d0/fitpeaks1d-7.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/dbb13582ad21cc15c4ea88a11c733e8f/fitpeaks1d-7.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/0fb54671aa547c0654eb19e962abe473/fitpeaks1d-7.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/c5df246523c5ee17839f7d2f5dc10ec8/fitpeaks1d-7.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/fitpeaks1d-7.png" class="plot-directive" src="../../../_images/fitpeaks1d-7.png" />
</figure>
</section>
</section>
<section id="further-examples">
<h1>Further Examples<a class="headerlink" href="#further-examples" title="Permalink to this heading">¶</a></h1>
<section id="large-baseline-structure-baseline-func-usage-and-fixing-known-parameters">
<h2>Large Baseline Structure (baseline_func usage and fixing known parameters)<a class="headerlink" href="#large-baseline-structure-baseline-func-usage-and-fixing-known-parameters" title="Permalink to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.fitpeaks1d</span> <span class="kn">import</span> <span class="n">fitpeaks1d</span>
<span class="kn">from</span> <span class="nn">astropy.modeling.polynomial</span> <span class="kn">import</span> <span class="n">Polynomial1D</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">positive_source</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Voigt1D</span><span class="p">(</span><span class="n">x_0</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">amplitude_L</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fwhm_G</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">negative_source</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Voigt1D</span><span class="p">(</span><span class="n">x_0</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">amplitude_L</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">fwhm_G</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">baseline</span> <span class="o">+</span> <span class="n">positive_source</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">negative_source</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span>

<span class="k">def</span> <span class="nf">baseline_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">baseline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">baseline</span><span class="p">),</span> <span class="n">baseline</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">fitpeaks1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">npeaks</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                   <span class="n">peak_class</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">Voigt1D</span><span class="p">,</span>
                   <span class="n">box_width</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                   <span class="n">background_class</span><span class="o">=</span><span class="n">Polynomial1D</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                   <span class="n">baseline_func</span><span class="o">=</span><span class="n">baseline_func</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">model</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Baseline&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
           <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Fit to data with large baseline structure&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">])(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted peaks&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">positive_source</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">negative_source</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True peaks&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Identified peaks&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/c4c7f812570a0be006d95e617469b430/fitpeaks1d-8.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/15c082f9f3da787bf984e6da9bdb176b/fitpeaks1d-8.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/b1e1297dd20776ec7afe33e5ab373770/fitpeaks1d-8.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/d7638a46b5367d1e9b9b17edc7b0b069/fitpeaks1d-8.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/fitpeaks1d-8.png" class="plot-directive" src="../../../_images/fitpeaks1d-8.png" />
</figure>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Model: CompoundModel
Name: 2_peaks_with_background
Inputs: (&#39;x&#39;,)
Outputs: (&#39;y&#39;,)
Model set size: 1
Expression: [0] + [1] + [2]
Components:
    [0]: &lt;Voigt1D(x_0=7.00235917, amplitude_L=-10.44529587, fwhm_L=0.244132,
                  fwhm_G=0.57882632)&gt;

    [1]: &lt;Voigt1D(x_0=3.95826805, amplitude_L=5.05682365, fwhm_L=0.63766468,
                  fwhm_G=0.00500501)&gt;

    [2]: &lt;Polynomial1D(2, c0=-15.1200609, c1=10.00847117, c2=-1.00159934)&gt;
Parameters:
          x_0_0          amplitude_L_0    ...        c1_2                c2_2
    ----------------- ------------------- ... ------------------ -------------------
    7.002359167002396 -10.445295870401356 ... 10.008471173888237 -1.0015993391982998
</pre></div>
</div>
<p>In the above example, a synthetic data set was generated where the structure
of the baseline would confuse a naive fit.  <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d.html#sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d" title="sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitpeaks1d()</span></code></a> is used to
overcome this by defining <code class="xref py py-obj docutils literal notranslate"><span class="pre">baseline_func</span></code> for use during the search phase.
This user-defined function  subtracts a 2nd order polynomial fit to the data
as an estimate of the baseline, and also returns the absolute values of the
baseline subtracted data in order to search for peak locations.  The absolute
value is taken since we are interested in negative peaks as well.</p>
<p>Some other points to note are:</p>
<p>1. <code class="xref py py-obj docutils literal notranslate"><span class="pre">box_width=(None,</span> <span class="pre">3)</span></code> links the width of the box function to the
autodetected (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) primary width parameter of the peak function so that the
box width is always 3 times the peak width.</p>
<p>2. A second order <code class="xref py py-class docutils literal notranslate"><span class="pre">Polynomial1D</span></code> has been used to model the background.
It is perfectly acceptable to use 1-dimensional classes from the
<a class="reference external" href="https://docs.astropy.org/en/stable/modeling/reference_api.html#module-astropy.modeling.polynomial" title="(in Astropy v5.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">astropy.modeling.polynomial</span></code></a> module.  However, unlike classes from
<code class="xref py py-mod docutils literal notranslate"><span class="pre">astropy.modeling.models</span></code>, they require positional arguments during
initialization.  This can be done by passing in a initialized object, as was
done above, or through the <code class="xref py py-obj docutils literal notranslate"><span class="pre">bg_args</span></code> keyword argument to <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d.html#sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d" title="sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitpeaks1d()</span></code></a>.</p>
<p>3. Examining the output fit parameters above, we see the background fit was
pretty close to the actual synthetic baseline (<span class="math notranslate nohighlight">\(-15 + 10x - x^2\)</span>), but
the peak width parameters (fwhm_L, fwhm_G) do not match the actual peak
parameters (0.634, 0.1).  However, the overall fit is not bad considering
the noise and these two parameters are fit in parallel.</p>
<p>If some parameters are known and fixed, this information may be passed into the
fit through keyword arguments.  For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;fwhm_G_0&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;fwhm_G_1&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
          <span class="s1">&#39;fwhm_G_0&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;fwhm_G_1&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">fitpeaks1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">npeaks</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                   <span class="n">peak_class</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">Voigt1D</span><span class="p">,</span>
                   <span class="n">box_width</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                   <span class="n">background_class</span><span class="o">=</span><span class="n">Polynomial1D</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                   <span class="n">baseline_func</span><span class="o">=</span><span class="n">baseline_func</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Model: CompoundModel
Inputs: (&#39;x&#39;,)
Outputs: (&#39;y&#39;,)
Model set size: 1
Expression: [0] + [1]
Components:
    [0]: &lt;Voigt1D(x_0=7.00295202, amplitude_L=-5.03354134, fwhm_L=0.65804315, fwhm_G=0.1)&gt;

    [1]: &lt;Voigt1D(x_0=3.95908859, amplitude_L=5.0493435, fwhm_L=0.5885241, fwhm_G=0.1)&gt;
Parameters:
          x_0_0         amplitude_L_0         fwhm_L_0      ...      fwhm_L_1      fwhm_G_1
    ----------------- ------------------ ------------------ ... ------------------ --------
    7.002952020756621 -5.033541341853574 0.6580431499448574 ... 0.5885241025687908      0.1
</pre></div>
</div>
<p>This time, fwhm_L_0 and fwhm_L_1 are closer to the true value of 0.63661977.</p>
</section>
<section id="default-behaviour-over-fitting-with-composite-peaks">
<h2>Default Behaviour (Over-fitting with composite peaks)<a class="headerlink" href="#default-behaviour-over-fitting-with-composite-peaks" title="Permalink to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">imageio</span>
<span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.fitpeaks1d</span> <span class="kn">import</span> <span class="n">fitpeaks1d</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;imageio:hubble_deep_field.png&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="mi">400</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">fitpeaks1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">npeaks</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">background</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">amplitude</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">px</span><span class="p">,</span> <span class="n">py</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">model</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">amplitude</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">background</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
             <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">px</span> <span class="o">-</span> <span class="mi">40</span><span class="p">,</span> <span class="n">py</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Fitted peak&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Default Settings and Identification Order&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">background</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gaussian Fit&#39;</span><span class="p">,</span>
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Composite Fit&#39;</span><span class="p">,</span>
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">160</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Peak 1: Simple and Composite Fit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/2200aa5dd268b6e1f5dd2adb225acb91/fitpeaks1d-9.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/9d8b16338a4b4a3a3b2d3a1d0a54570b/fitpeaks1d-9.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/16104562c912075ebda4fca5bc2cef76/fitpeaks1d-9.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/146e78c72ff3d1817493eb3b26b90f06/fitpeaks1d-9.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/fitpeaks1d-9.png" class="plot-directive" src="../../../_images/fitpeaks1d-9.png" />
</figure>
<p>In this example, we use the default behaviour of <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d.html#sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d" title="sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitpeaks1d()</span></code></a> to
identify the 10 most prominent peaks (positive and negative), in order of
amplitude, from a set of data containing many possible sources.  By default,
<a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d.html#sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d" title="sofia_redux.toolkit.fitting.fitpeaks1d.fitpeaks1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitpeaks1d()</span></code></a> will fit Gaussian sources and with a constant background
offset.</p>
<p>For this particular data set, attempting to identify this many peaks resulted
in 4 false detections (points 7-10).  This is because we are using Gaussians
to model sources that do not fit such a profile.  Therefore, the model has fit
the most prominent source as a composite of 5 Gaussian sources as shown in the
right-most plot.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Search Phase</a><ul>
<li><a class="reference internal" href="#processing-function-optional">1. Processing function (Optional)</a></li>
<li><a class="reference internal" href="#guess-function-optional">2. Guess function (Optional)</a></li>
<li><a class="reference internal" href="#rough-initial-parameter-estimation-and-the-box-function">3. Rough Initial Parameter Estimation and the Box Function</a></li>
<li><a class="reference internal" href="#identify-remaining-peaks">4. Identify remaining peaks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#initial-baseline-fitting">Initial Baseline Fitting</a></li>
<li><a class="reference internal" href="#final-refined-fit">Final Refined Fit</a></li>
<li><a class="reference internal" href="#model-functionality">Model Functionality</a><ul>
<li><a class="reference internal" href="#fit-information">Fit Information</a></li>
<li><a class="reference internal" href="#evaluating-models">Evaluating Models</a></li>
</ul>
</li>
<li><a class="reference internal" href="#further-examples">Further Examples</a><ul>
<li><a class="reference internal" href="#large-baseline-structure-baseline-func-usage-and-fixing-known-parameters">Large Baseline Structure (baseline_func usage and fixing known parameters)</a></li>
<li><a class="reference internal" href="#default-behaviour-over-fitting-with-composite-peaks">Default Behaviour (Over-fitting with composite peaks)</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../../_sources/sofia_redux/toolkit/fitting/fitpeaks1d.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>