<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sofia_redux.spectroscopy.combflagstack &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    
    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sofia_redux.spectroscopy.combflagstack</h1><div class="highlight"><pre>
<span></span># Licensed under a 3-clause BSD style license - see LICENSE.rst

from astropy import log
import numpy as np
from sofia_redux.toolkit.utilities.func import bitset

__all__ = [&#39;combflagstack&#39;]


<div class="viewcode-block" id="combflagstack"><a class="viewcode-back" href="../../../api/sofia_redux.spectroscopy.combflagstack.combflagstack.html#sofia_redux.spectroscopy.combflagstack.combflagstack">[docs]</a>def combflagstack(stack, nbits=8, axis=0):
    &quot;&quot;&quot;
    Combine bit-set flag arrays.

    Parameters
    ----------
    stack : array_like of int
        (n_stack, mask_shape)  The _stack of bit-set flag arrays to combine.
        The _stack can either be a _stack of spectra (n_spectrum, n_data) or
        a _stack of images (n_images, nrow, ncol).
    nbits : int, optional
        The number of bits that can potentially be set.  This function
        assumes the bits are set sequentially, starting with the zeroth
        bit.  So if nbits is 2, then it will check the 0th and 1st bit.
        The default is to check all eight bits.
    axis : int, optional
        Axis along which to perform the combination.

    Returns
    -------
    numpy.ndarray of int
        The bit-set flag array that reflects the bit-set flags from all
        of the spectra or images.
    &quot;&quot;&quot;
    stack = np.array(stack)
    if stack.ndim &lt; 2:
        log.error(&quot;Invalid _stack dimensions&quot;)
        return
    if axis &gt; stack.ndim or axis &lt; 0:
        log.error(&quot;Invalid axis&quot;)
        return
    axis = int(axis)
    shape = list(stack.shape)
    del shape[axis]

    result = np.zeros(shape, dtype=int)
    for bit in range(nbits):
        bsum = (np.sum(bitset(stack, bit), axis=axis) &gt; 0) * (2 ** bit)
        np.add(result, bsum, out=result)

    np.mod(result, 256, out=result)
    return result</div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>