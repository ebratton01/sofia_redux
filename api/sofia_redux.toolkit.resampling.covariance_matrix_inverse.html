<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>covariance_matrix_inverse &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="derivative_mscp" href="sofia_redux.toolkit.resampling.derivative_mscp.html" />
    <link rel="prev" title="coordinate_mean" href="sofia_redux.toolkit.resampling.coordinate_mean.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.derivative_mscp.html" title="derivative_mscp">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.coordinate_mean.html" title="coordinate_mean">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/fifils/developers/developers.html" accesskey="U">FIFI-LS Redux Developer’s Manual</a> &#187;</li>
      
      <li>covariance_matrix_inverse</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="covariance-matrix-inverse">
<h1>covariance_matrix_inverse<a class="headerlink" href="#covariance-matrix-inverse" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.covariance_matrix_inverse">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.toolkit.resampling.</span></span><span class="sig-name descname"><span class="pre">covariance_matrix_inverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_utils.html#covariance_matrix_inverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.covariance_matrix_inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the inverse covariance matrix inverse of the fit coefficients.</p>
<p>If the least-squares solution to a fit is given as
<span class="math notranslate nohighlight">\(y = \hat{c} \cdot \Phi\)</span> when <span class="math notranslate nohighlight">\(y = c \cdot \Phi + \epsilon\)</span>,
the inverse covariance on the estimated fit coefficients <span class="math notranslate nohighlight">\(\hat{c}\)</span> is
given as:</p>
<div class="math notranslate nohighlight">
\[\Sigma^{-1} = \frac{N}{N - M} (\Phi^T W Var(y) \Phi)^{-1}\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> are the number of samples fit, <span class="math notranslate nohighlight">\(M\)</span> are the lost
degrees of freedom, <code class="xref py py-obj docutils literal notranslate"><span class="pre">W</span></code> are the fit <code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code>, and <span class="math notranslate nohighlight">\(Var(y)\)</span> is
related to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">error</span></code> (<span class="math notranslate nohighlight">\(\sigma\)</span>) by:</p>
<div class="math notranslate nohighlight">
\[Var(y) = diag(1 / \sigma^2)\]</div>
<p>Note that during the fitting process, it is common for the inverse of the
covariance matrix <span class="math notranslate nohighlight">\(\Sigma\)</span> to have already been calculated (not
factoring in lost degrees of freedom) if inverse variance was included as a
weighting factor for the fit.  If so, it should be passed in as <code class="xref py py-obj docutils literal notranslate"><span class="pre">amat</span></code>
(<span class="math notranslate nohighlight">\(A\)</span>), and the final covariance is simply given by:</p>
<div class="math notranslate nohighlight">
\[\Sigma^{-1} = \frac{N}{N - M}A^{-1}\]</div>
<p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">amat</span></code> was not calculated, it should be supplied as an array of shape
(0, 0) (because <code class="xref py py-mod docutils literal notranslate"><span class="pre">numba</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>amat</strong><span class="classifier">numpy.ndarray (n_terms, n_terms)</span></dt><dd><p>The matrix A as described above.  If the shape of amat is set
to (0, 0), it will be calculated using the error, weights, and
phi terms.  This should only be done if A was weighted by both
<code class="xref py py-obj docutils literal notranslate"><span class="pre">error</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code>.</p>
</dd>
<dt><strong>phi</strong><span class="classifier">numpy.ndarray (n_terms, N)</span></dt><dd><p>The polynomial terms for each of the N data samples.</p>
</dd>
<dt><strong>error</strong><span class="classifier">numpy.ndarray (N,)</span></dt><dd><p>The 1-sigma errors.</p>
</dd>
<dt><strong>weights</strong><span class="classifier">numpy.ndarray (N,)</span></dt><dd><p>The weighting factor applied to each sample when determining the
least squares solution of the fit.  Note that this <em>must not</em>
factor in any error based weighting.  Therefore, in the case of
the resampling algorithm, it should refer to the distance
weighting factor of each sample from the resampling point, or
an array of ones (np.ones(N)) if distance weighting was not
applied.</p>
</dd>
<dt><strong>rank</strong><span class="classifier">int or float, optional</span></dt><dd><p>The matrix rank of <code class="xref py py-obj docutils literal notranslate"><span class="pre">amat</span></code>, optionally passed in for speed if
pre-calculated.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>inverse_covariance</strong><span class="classifier">numpy.ndarray (nterms, nterms)</span></dt><dd><p>The covariance matrix inverse of fit coefficients.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">covariance_matrix_inverse</a><ul>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.covariance_matrix_inverse"><code class="docutils literal notranslate"><span class="pre">covariance_matrix_inverse()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.toolkit.resampling.covariance_matrix_inverse.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>