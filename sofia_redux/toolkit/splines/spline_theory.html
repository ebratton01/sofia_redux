<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Definition &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    
    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="The Spline class" href="spline_examples.html" />
    <link rel="prev" title="Splines (sofia_redux.toolkit.resampling.splines)" href="index.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="spline_examples.html" title="The Spline class">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="index.html" title="Splines (sofia_redux.toolkit.resampling.splines)">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../../index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../index.html" >sofia_redux.toolkit: Shared Utilities for SOFIA Pipelines</a> &#187;</li>
      <li><a href="index.html" accesskey="U">Splines (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.toolkit.resampling.splines</span></code>)</a> &#187;</li>
      
      <li>Definition</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="definition">
<h1>Definition<a class="headerlink" href="#definition" title="Permalink to this heading">¶</a></h1>
<p>A spline function <span class="math notranslate nohighlight">\(s(x)\)</span> of degree <span class="math notranslate nohighlight">\(k &gt; 0\)</span> (order <span class="math notranslate nohighlight">\(k+1\)</span>) is
defined on the finite interval <span class="math notranslate nohighlight">\([a,b]\)</span> containing monotonically increasing
knots <span class="math notranslate nohighlight">\(\lambda_j\)</span> where <span class="math notranslate nohighlight">\(j=0,1,\cdots,g+1\)</span>, <span class="math notranslate nohighlight">\(\lambda_0 = a\)</span>,
and <span class="math notranslate nohighlight">\(\lambda_{g+1}=b\)</span>.  For each knot interval
<span class="math notranslate nohighlight">\([\lambda_j, \lambda_{j+1}]\)</span> the spline function is given by a polynomial
of degree <span class="math notranslate nohighlight">\(\leq k\)</span>, and must be continues along with all its derivatives
up to <span class="math notranslate nohighlight">\(k-1\)</span> on <span class="math notranslate nohighlight">\([a,b]\)</span>.  For further information on the theory
and computational implementation for univariate and bivariate spline fitting,
please see Paul Dierckx, Curve and Surface Fitting with Splines, Oxford
University Press, 1993.</p>
</section>
<section id="implementation-spline-representation">
<h1>Implementation - Spline representation<a class="headerlink" href="#implementation-spline-representation" title="Permalink to this heading">¶</a></h1>
<p>Spline coefficients and knots are derived iteratively starting with only two
knots per dimension by default at <span class="math notranslate nohighlight">\([min(x), max(x)]\)</span>.  At each iteration,
a new knot will be added until:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\begin{eqnarray}
\left( \sum_i^n{(d_i - s(x_i))^2} \right) - \alpha \leq
    \alpha * tolerance
\end{eqnarray}</div></div></blockquote>
<p>where <span class="math notranslate nohighlight">\(d_i\)</span> is the sample value at point <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span>
is the smoothing factor for the reduction.  When <span class="math notranslate nohighlight">\(\alpha = 0\)</span>, the
reduction will terminate once the resulting function represents an interpolating
spline.  The <span class="math notranslate nohighlight">\(tolerance\)</span> parameter is a user defined value, typically of
the order <span class="math notranslate nohighlight">\(10^{-3}\)</span>.</p>
<p>During each new reduction, the current knots are used to divide the entire
sample space into panels.  Each panel is defined as an n-dimensional volume
with neighbouring knots at each vertex.  Fits are performed to all samples in a
panel, and the panel with the greatest <span class="math notranslate nohighlight">\(w = \sum{(d - s(x))^2}\)</span> is taken
as the candidate in which to place a new knot.  If no valid knot can be placed
at that location, the algorithm moves onto the next greatest panel <span class="math notranslate nohighlight">\(w\)</span>
and so on.</p>
<p>Note that in rare circumstances, iterations will halt when the location of the
new knot coincides with an existing one or the maximum number of knots has been
reached.  Iterations may also terminate once the maximum number of iterations
has been reached, the solution no longer converges, or the required storage
space exceeds a certain limit.</p>
</section>
<section id="implementation-spline-evaluation">
<h1>Implementation - Spline evaluation<a class="headerlink" href="#implementation-spline-evaluation" title="Permalink to this heading">¶</a></h1>
<p>Once a spline representation has been derived, it may be evaluated at any
given coordinate <span class="math notranslate nohighlight">\(x\)</span> in the range <span class="math notranslate nohighlight">\(a \leq x \leq b\)</span>.  B-splines
are generated for <span class="math notranslate nohighlight">\(x\)</span> in each dimension using the Cox-de Boor recursion
formula (2007):</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\begin{eqnarray}
    B_{j,0}(x) &amp; = &amp; \left\{
        \begin{matrix}
            1 &amp; \text{if} \quad \lambda_j \leq x &lt; \lambda_{j+1} \\
            0 &amp; \text{otherwise}
        \end{matrix} \right\} \\
    B_{j,k}(x) &amp; = &amp; \frac{x - \lambda_j}
                      {\lambda_{j+k} - \lambda_j}
                 B_{j,k-1}(x) +
                 \frac{\lambda_{j+k+1} - x}
                      {\lambda_{j+k+1} - \lambda_{j+1}}
                 B_{j+1,k-1}(x)
\end{eqnarray}</div></div></blockquote>
<p>If <span class="math notranslate nohighlight">\(j\)</span> defines the knot interval <span class="math notranslate nohighlight">\(\lambda_j \leq x &lt; \lambda_{j+1}\)</span>,
a solution at <span class="math notranslate nohighlight">\(x\)</span> is given by:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\begin{eqnarray}
    s(x) = \sum_{i=j-k}^{j} c_i B_{i,k}(x)
\end{eqnarray}</div></div></blockquote>
<p>where <span class="math notranslate nohighlight">\(c\)</span> are the spline coefficients which are determined during the
spline representation phase.</p>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Definition</a></li>
<li><a class="reference internal" href="#implementation-spline-representation">Implementation - Spline representation</a></li>
<li><a class="reference internal" href="#implementation-spline-evaluation">Implementation - Spline evaluation</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../../_sources/sofia_redux/toolkit/splines/spline_theory.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>