<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>polynomial_derivative_map &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="polynomial_exponents" href="sofia_redux.toolkit.resampling.polynomial_exponents.html" />
    <link rel="prev" title="offset_variance" href="sofia_redux.toolkit.resampling.offset_variance.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.polynomial_exponents.html" title="polynomial_exponents">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.offset_variance.html" title="offset_variance">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/fifils/developers/developers.html" accesskey="U">FIFI-LS Redux Developer’s Manual</a> &#187;</li>
      
      <li>polynomial_derivative_map</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="polynomial-derivative-map">
<h1>polynomial_derivative_map<a class="headerlink" href="#polynomial-derivative-map" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.polynomial_derivative_map">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.toolkit.resampling.</span></span><span class="sig-name descname"><span class="pre">polynomial_derivative_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exponents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_utils.html#polynomial_derivative_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.polynomial_derivative_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a mapping from polynomial exponents to derivatives.</p>
<p>Please see <a class="reference internal" href="sofia_redux.toolkit.resampling.polynomial_exponents.html#sofia_redux.toolkit.resampling.polynomial_exponents" title="sofia_redux.toolkit.resampling.polynomial_exponents"><code class="xref py py-func docutils literal notranslate"><span class="pre">polynomial_exponents()</span></code></a> for details on how a polynomial
equation is defined within the resampling algorithm, and the use of the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">exponents</span></code> array in defining the polynomial terms (<span class="math notranslate nohighlight">\(\Phi\)</span>).</p>
<p>Within the confines of the resampling algorithm, the polynomial exponents
should have always been defined in a way that will always allow the
derivative of a polynomial fit to be calculated from existing,
pre-calculated <span class="math notranslate nohighlight">\(\Phi\)</span> terms.</p>
<p>For example, consider the 2-dimensional 2nd order polynomial equation and
its derivatives in each dimension:</p>
<div class="math notranslate nohighlight">
\[f(x, y) = c_1 + c_2 x + c_3 x^2 + c_4 y + c_5 x y + c_6 y^2\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial f}{\partial x} = c_2 + 2 c_3 x + c_5 y\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial f}{\partial y} = c_4 + c_5 x + 2 c_6 y\]</div>
<p>Converting <span class="math notranslate nohighlight">\(f(x, y) \rightarrow f(\Phi)\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[f(\Phi) = c_1 \Phi_1 + c_2 \Phi_2 + c_3 \Phi_3 + c_4 \Phi_4 +
          c_5 \Phi_5 + c_6 \Phi_6\]</div>
<p>It can then be seen that</p>
<div class="math notranslate nohighlight">
\[\frac{\partial f}{\partial x} = c_2 \Phi_1 + 2 c_3 \Phi_2 + c_5 \Phi_4\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial f}{\partial y} = c_4 \Phi_1 + c_5 \Phi_2 + 2 c_6 \Phi_4\]</div>
<p>Generalizing for a polynomial equation consisting of <span class="math notranslate nohighlight">\(M\)</span> terms of the
independent variable <span class="math notranslate nohighlight">\(X\)</span> in <span class="math notranslate nohighlight">\(K-\text{dimensions}\)</span>, a mapping
(<span class="math notranslate nohighlight">\(h\)</span>) can be devised enabling calculation of the derivatives from
pre-existing terms.  For dimension <span class="math notranslate nohighlight">\(k\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial f}{\partial X_k} = \sum_{m=1}^{M}
    {h_{k, 0, m} \cdot c_{h_{k, 1, m}} \cdot \Phi_{h_{k, 2, m}}}\]</div>
<p>This allows the derivative to be calculated from the existing polynomial
terms (<span class="math notranslate nohighlight">\(\Phi\)</span>) and coefficients (<span class="math notranslate nohighlight">\(c\)</span>).  In addition, the
mapping can be calculated prior to reduction and will therefore only need
to be calculated once along with <span class="math notranslate nohighlight">\(\Phi\)</span>.  Once the coefficients are
known, the derivatives can then be calculated using <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>Derivatives may be evaluated using <a class="reference internal" href="sofia_redux.toolkit.resampling.evaluate_derivative.html#sofia_redux.toolkit.resampling.evaluate_derivative" title="sofia_redux.toolkit.resampling.evaluate_derivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">evaluate_derivative()</span></code></a> and
<a class="reference internal" href="sofia_redux.toolkit.resampling.evaluate_derivatives.html#sofia_redux.toolkit.resampling.evaluate_derivatives" title="sofia_redux.toolkit.resampling.evaluate_derivatives"><code class="xref py py-func docutils literal notranslate"><span class="pre">evaluate_derivatives()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>exponents</strong><span class="classifier">numpy.ndarray (n_terms, n_dimensions)</span></dt><dd><p>The exponents defining a polynomial equation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>derivative_map</strong><span class="classifier">numpy.ndarray of int</span></dt><dd><p>An array of shape (n_dimensions, 3, n_valid_terms).  The second
dimension (of size 3) gives a constant multiplier in the first element,
the coefficient index in the second element, and the phi index in the
second element.  The third dimension will generally be of a smaller
size than the number of terms in the polynomial equation as not all
are required to calculate the derivative.  Due to the fact that some
dimensions may contain more valid terms than others, <code class="xref py py-obj docutils literal notranslate"><span class="pre">n_valid_terms</span></code>
is set to the maximum number of valid terms over all dimensions.  Any
invalid terms still remaining in the mapping array will have
multipliers set to zero, and index pointers set to -1.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">polynomial_derivative_map</a><ul>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.polynomial_derivative_map"><code class="docutils literal notranslate"><span class="pre">polynomial_derivative_map()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.toolkit.resampling.polynomial_derivative_map.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>