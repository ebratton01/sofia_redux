<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>solve_fits &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="solve_inverse_covariance_matrices" href="sofia_redux.toolkit.resampling.solve_inverse_covariance_matrices.html" />
    <link rel="prev" title="solve_fit" href="sofia_redux.toolkit.resampling.solve_fit.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.solve_inverse_covariance_matrices.html" title="solve_inverse_covariance_matrices">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.toolkit.resampling.solve_fit.html" title="solve_fit">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/fifils/developers/developers.html" accesskey="U">FIFI-LS Redux Developer’s Manual</a> &#187;</li>
      
      <li>solve_fits</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="solve-fits">
<h1>solve_fits<a class="headerlink" href="#solve-fits" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.toolkit.resampling.solve_fits">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.toolkit.resampling.</span></span><span class="sig-name descname"><span class="pre">solve_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_phi_terms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_phi_terms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_weighting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_algorithm_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_term_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">derivative_term_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">derivative_term_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_algorithm_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_distance_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_rchi2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_cross_derivatives</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_offset_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/toolkit/resampling/resample_utils.html#solve_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.toolkit.resampling.solve_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve all fits within one intersection block.</p>
<p>This function is a wrapper for <a class="reference internal" href="sofia_redux.toolkit.resampling.solve_fit.html#sofia_redux.toolkit.resampling.solve_fit" title="sofia_redux.toolkit.resampling.solve_fit"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_fit()</span></code></a> over all data sets and
fit points.  The main computations here involve:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Creating and populating the output arrays.</p></li>
<li><p>Selecting the correct samples within the region of each fitting
window.</p></li>
<li><p>Calculating the full weighting factors for the fits.</p></li>
</ol>
</div></blockquote>
<p>For further details on the actual fitting, please see <a class="reference internal" href="sofia_redux.toolkit.resampling.solve_fit.html#sofia_redux.toolkit.resampling.solve_fit" title="sofia_redux.toolkit.resampling.solve_fit"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_fit()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sample_indices</strong><span class="classifier">numba.typed.List</span></dt><dd><p>A list of 1-dimensional numpy.ndarray (dtype=int) of length n_fits.
Each list element <code class="xref py py-obj docutils literal notranslate"><span class="pre">sample_indices[i]</span></code>, contains the indices of samples
within the “window” region of <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_indices[i]</span></code>.</p>
</dd>
<dt><strong>sample_coordinates</strong><span class="classifier">numpy.ndarray (n_dimensions, n_samples)</span></dt><dd><p>The independent coordinates for each sample in n_dimensions</p>
</dd>
<dt><strong>sample_phi_terms</strong><span class="classifier">numpy.ndarray (n_terms, n_samples)</span></dt><dd><p>The polynomial terms of <code class="xref py py-obj docutils literal notranslate"><span class="pre">sample_coordinates</span></code>.  Please see
<a class="reference internal" href="sofia_redux.toolkit.resampling.polynomial_terms.html#sofia_redux.toolkit.resampling.polynomial_terms" title="sofia_redux.toolkit.resampling.polynomial_terms"><code class="xref py py-func docutils literal notranslate"><span class="pre">polynomial_terms()</span></code></a> for further details.</p>
</dd>
<dt><strong>sample_data</strong><span class="classifier">numpy.ndarray (n_sets, n_samples)</span></dt><dd><p>The dependent values of the samples for n_sets, each containing
n_samples.</p>
</dd>
<dt><strong>sample_error</strong><span class="classifier">numpy.ndarray (n_sets, n_samples)</span></dt><dd><p>The associated 1-sigma error values for each sample in each set.  The
user may also supply an array of shape (n_sets, 1) in which case all
samples in a set will share the same associated error value.  If
the shape is set to (n_sets, 0), this indicates that no error values
are available for the samples.</p>
</dd>
<dt><strong>sample_mask</strong><span class="classifier">numpy.ndarray (n_sets, n_samples)</span></dt><dd><p>A mask where <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> indicates that the associated sample should be
excluded from all fits.</p>
</dd>
<dt><strong>fit_coordinates</strong><span class="classifier">numpy.ndarray (n_dimensions, n_fits)</span></dt><dd><p>The independent variables at each fit coordinate in d_dimensions.</p>
</dd>
<dt><strong>fit_phi_terms</strong><span class="classifier">numpy.ndarray (n_terms, n_fits)</span></dt><dd><p>The polynomial terms of <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_coordinates</span></code>.  Please see
<a class="reference internal" href="sofia_redux.toolkit.resampling.polynomial_terms.html#sofia_redux.toolkit.resampling.polynomial_terms" title="sofia_redux.toolkit.resampling.polynomial_terms"><code class="xref py py-func docutils literal notranslate"><span class="pre">polynomial_terms()</span></code></a> for further details.</p>
</dd>
<dt><strong>order</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>The desired order of the fit as a (1,) or (n_dimensions,) array.  If
only a single value is supplied, it will be applied over all
dimensions.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">numpy.ndarray (n_dimensions,)</span></dt><dd><p>A distance weighting scaling factor per dimension.  The weighting
kernel is applied equally to all sets and samples.  For further
details, please see <a class="reference internal" href="sofia_redux.toolkit.resampling.calculate_distance_weights.html#sofia_redux.toolkit.resampling.calculate_distance_weights" title="sofia_redux.toolkit.resampling.calculate_distance_weights"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_distance_weights()</span></code></a>.  Will be
overridden by <code class="xref py py-obj docutils literal notranslate"><span class="pre">adaptive_alpha</span></code> if <code class="xref py py-obj docutils literal notranslate"><span class="pre">adaptive_alpha.size</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>.</p>
</dd>
<dt><strong>adaptive_alpha</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Shape = (n_samples, n_sets, [1 or n_dimensions], n_dimensions).
Defines a weighting kernel for each sample in each set.  The function
<a class="reference internal" href="sofia_redux.toolkit.resampling.calculate_adaptive_distance_weights_scaled.html#sofia_redux.toolkit.resampling.calculate_adaptive_distance_weights_scaled" title="sofia_redux.toolkit.resampling.calculate_adaptive_distance_weights_scaled"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_adaptive_distance_weights_scaled()</span></code></a> will be used for
kernels of shape (1, n_dimensions), and
<a class="reference internal" href="sofia_redux.toolkit.resampling.calculate_adaptive_distance_weights_shaped.html#sofia_redux.toolkit.resampling.calculate_adaptive_distance_weights_shaped" title="sofia_redux.toolkit.resampling.calculate_adaptive_distance_weights_shaped"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_adaptive_distance_weights_shaped()</span></code></a> will be used for
kernels of shape (n_dimensions, n_dimensions).  <code class="xref py py-obj docutils literal notranslate"><span class="pre">adaptive_alpha</span></code> is
a required parameter due to Numba constraints, and will override
the <code class="xref py py-obj docutils literal notranslate"><span class="pre">alpha</span></code> parameter unless it has a size of 0.  Therefore, to
disable, please set the size of any dimension to zero.</p>
</dd>
<dt><strong>is_covar</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that <code class="xref py py-obj docutils literal notranslate"><span class="pre">sample_data</span></code> contains covariance values
that should be propagated through algorithm.  If this is the case,
polynomial fitting is disabled, and a weighted variance is calculated
instead.</p>
</dd>
<dt><strong>mean_fit</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, a weighted mean is performed instead of calculating a
polynomial fit.</p>
</dd>
<dt><strong>cval</strong><span class="classifier">float, optional</span></dt><dd><p>In a case that a fit is unable to be calculated at certain location,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">cval</span></code> determines the fill value for the output <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code> array at those
locations.</p>
</dd>
<dt><strong>fit_threshold</strong><span class="classifier">float, optional</span></dt><dd><p>If fit_threshold is non-zero, perform a check on the goodness of the
fit.  When the reduced-chi statistic is greater than
abs(fit_threshold), the fit is determined to be a failure, and a
replacement value is used. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_threshold</span></code> &lt; 0, failed fit values
will be set to <code class="xref py py-obj docutils literal notranslate"><span class="pre">cval</span></code>.  If <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_threshold</span></code> &gt; 0, failed fit values will
be replaced by the weighted mean.</p>
</dd>
<dt><strong>error_weighting</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, weight the samples in the fit by the inverse variance
(1 / sample_error^2) in addition to distance weighting.</p>
</dd>
<dt><strong>estimate_covariance</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculate the covariance of the fit coefficients using
<a class="reference internal" href="sofia_redux.toolkit.resampling.estimated_covariance_matrix_inverse.html#sofia_redux.toolkit.resampling.estimated_covariance_matrix_inverse" title="sofia_redux.toolkit.resampling.estimated_covariance_matrix_inverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">estimated_covariance_matrix_inverse()</span></code></a>.  Otherwise, use
<a class="reference internal" href="sofia_redux.toolkit.resampling.covariance_matrix_inverse.html#sofia_redux.toolkit.resampling.covariance_matrix_inverse" title="sofia_redux.toolkit.resampling.covariance_matrix_inverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">covariance_matrix_inverse()</span></code></a>.</p>
</dd>
<dt><strong>order_algorithm_idx</strong><span class="classifier">int, optional</span></dt><dd><p>An integer specifying which polynomial order validation algorithm to
use.  The default (1), will always be the more robust of all available
options.  For further information, please see <a class="reference internal" href="sofia_redux.toolkit.resampling.check_edges.html#sofia_redux.toolkit.resampling.check_edges" title="sofia_redux.toolkit.resampling.check_edges"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_edges()</span></code></a>.</p>
</dd>
<dt><strong>order_term_indices</strong><span class="classifier">numpy.ndarray (&gt; max(order) + 1,), optional</span></dt><dd><p>A 1-dimensional lookup array for use in determining the correct phi
terms to use for a given polynomial order.  The order validation
algorithm ensures a fit of the requested order is possible.  If not,
and the orders are equal in all dimensions, it may also optionally
return a suggested order.  In this case, <code class="xref py py-obj docutils literal notranslate"><span class="pre">order_term_indices</span></code> is used
to select the correct <code class="xref py py-obj docutils literal notranslate"><span class="pre">sample_phi_terms</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_phi_terms</span></code> for a
given order (k), where terms are extracted via
<code class="xref py py-obj docutils literal notranslate"><span class="pre">phi[order_term_indices[k]:order_term_indices[k</span> <span class="pre">+</span> <span class="pre">2]]</span></code>.</p>
</dd>
<dt><strong>derivative_term_map</strong><span class="classifier">numpy.ndarray, optional</span></dt><dd><p>A mapping array for the determination of derivatives from the
coefficients of the fit, and available terms in “phi”.  The shape of
the array is (n_dimensions, 3, n_derivative_terms).  This is only
required if the gradient is required as an output.  For a full
description of the derivative map, please see
<a class="reference internal" href="sofia_redux.toolkit.resampling.polynomial_derivative_map.html#sofia_redux.toolkit.resampling.polynomial_derivative_map" title="sofia_redux.toolkit.resampling.polynomial_derivative_map"><code class="xref py py-func docutils literal notranslate"><span class="pre">polynomial_derivative_map()</span></code></a>.</p>
</dd>
<dt><strong>derivative_term_indices</strong><span class="classifier">numpy.ndarray (max(order) + 1,), optional</span></dt><dd><p>If the fit order is allowed to vary, gives the indices in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">derivative_term_map</span></code> for a given symmetrical order.  The correct
<code class="xref py py-obj docutils literal notranslate"><span class="pre">derivative_term_map</span></code> mapping for order k is given as
<code class="xref py py-obj docutils literal notranslate"><span class="pre">derivative_term_map[:,</span> <span class="pre">:,</span> <span class="pre">indices[k]:indices[k</span> <span class="pre">+</span> <span class="pre">2]]</span></code>.</p>
</dd>
<dt><strong>edge_algorithm_idx</strong><span class="classifier">int, optional</span></dt><dd><p>Integer specifying the algorithm used to determine whether a fit should
be attempted with respect to the sample distribution.  Please see
<a class="reference internal" href="sofia_redux.toolkit.resampling.check_edges.html#sofia_redux.toolkit.resampling.check_edges" title="sofia_redux.toolkit.resampling.check_edges"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_edges()</span></code></a> for further information.  The default (1), is
always the most robust of the available algorithms.</p>
</dd>
<dt><strong>edge_threshold</strong><span class="classifier">numpy.ndarray (n_dimensions,)</span></dt><dd><p>A threshold parameter determining how close an edge should be to the
center of the distribution during <a class="reference internal" href="sofia_redux.toolkit.resampling.check_edges.html#sofia_redux.toolkit.resampling.check_edges" title="sofia_redux.toolkit.resampling.check_edges"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_edges()</span></code></a>.  Higher values
result in an edge closer to the sample mean.  A value should be
provided for each dimension.  A zero value in any dimension will result
in an infinite edge for that dimension.</p>
</dd>
<dt><strong>minimum_points</strong><span class="classifier">int, optional</span></dt><dd><p>Certain order validation algorithms check the number of available
samples as a means to determine what order of fit is appropriate.
If pre-calculated for the base <code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code>, it may be passed in here for
a slight speed advantage.</p>
</dd>
<dt><strong>get_error</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, return the error on the fit.</p>
</dd>
<dt><strong>get_counts</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, return the number of samples used when determining the fit
at each fitting point.</p>
</dd>
<dt><strong>get_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, return the sum of all sample weights used in determining the
fit at each point.</p>
</dd>
<dt><strong>get_distance_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, return the sum of only the distance weights used in
determining the fit at each point.</p>
</dd>
<dt><strong>get_rchi2</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, return the reduced chi-squared statistic for each of the
fitted points.</p>
</dd>
<dt><strong>get_cross_derivatives</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, return the derivative mean-squared-cross-products of the
samples for each of the fitted points.  See <a class="reference internal" href="sofia_redux.toolkit.resampling.derivative_mscp.html#sofia_redux.toolkit.resampling.derivative_mscp" title="sofia_redux.toolkit.resampling.derivative_mscp"><code class="xref py py-func docutils literal notranslate"><span class="pre">derivative_mscp()</span></code></a>
for further information.</p>
</dd>
<dt><strong>get_offset_variance</strong><span class="classifier">bool optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, return the offset of the fitting point from the sample
distribution.  See <a class="reference internal" href="sofia_redux.toolkit.resampling.offset_variance.html#sofia_redux.toolkit.resampling.offset_variance" title="sofia_redux.toolkit.resampling.offset_variance"><code class="xref py py-func docutils literal notranslate"><span class="pre">offset_variance()</span></code></a> for further information.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>fit_results</strong><span class="classifier">8-tuple of numpy.ndarray</span></dt><dd><p>fit_results[0]: Fitted values.
fit_results[1]: Error on the fit.
fit_results[2]: Number of samples in each fit.
fit_results[3]: Weight sums.
fit_results[4]: Distance weight sums.
fit_results[5]: Reduced chi-squared statistic.
fit_results[6]: Derivative mean-squared-cross-products.
fit_results[7]: Offset variances from the sample distribution center.</p>
<p>All arrays except for fit_results[6] have the shape (n_sets, n_fits)
or (0, 0) depending on whether <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>
respectively.  The derivative MSCP is of shape
(n_sets, n_fits, n_dimensions, n_dimensions) if requested, and
(1, 0, 0, 0) otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">solve_fits</a><ul>
<li><a class="reference internal" href="#sofia_redux.toolkit.resampling.solve_fits"><code class="docutils literal notranslate"><span class="pre">solve_fits()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.toolkit.resampling.solve_fits.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>