<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FORCASTReduction &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FORCASTSlitcorrReduction" href="sofia_redux.pipeline.sofia.forcast_slitcorr_reduction.FORCASTSlitcorrReduction.html" />
    <link rel="prev" title="FORCASTImagingReduction" href="sofia_redux.pipeline.sofia.forcast_imaging_reduction.FORCASTImagingReduction.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.pipeline.sofia.forcast_slitcorr_reduction.FORCASTSlitcorrReduction.html" title="FORCASTSlitcorrReduction">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.pipeline.sofia.forcast_imaging_reduction.FORCASTImagingReduction.html" title="FORCASTImagingReduction">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../sofia_redux/pipeline/index.html" accesskey="U">sofia_redux.pipeline: Data Reduction Pipelines for SOFIA</a> &#187;</li>
      
      <li>FORCASTReduction</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="forcastreduction">
<h1>FORCASTReduction<a class="headerlink" href="#forcastreduction" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sofia_redux.pipeline.sofia.forcast_reduction.</span></span><span class="sig-name descname"><span class="pre">FORCASTReduction</span></span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sofia_redux.pipeline.reduction.Reduction.html#sofia_redux.pipeline.reduction.Reduction" title="sofia_redux.pipeline.reduction.Reduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reduction</span></code></a></p>
<p>FORCAST reduction steps.</p>
<p>Primary image reduction algorithms are defined in the DRIP
package (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.forcast</span></code>).  Calibration-related
algorithms are pulled from the <code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.calibration</span></code> package, and
some utilities come from the <code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.toolkit</span></code> package.  This
reduction object requires that all three packages be installed.</p>
<p>This reduction object defines a method for each pipeline
step, that calls the appropriate algorithm from its source
packages.</p>
<dl class="field-list">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>prodtype_map</strong><span class="classifier">dict</span></dt><dd><p>Maps the pipeline step to a product type, to assign
to the PRODTYPE key. Keys are pipeline step function names.</p>
</dd>
<dt><strong>prodnames</strong><span class="classifier">dict</span></dt><dd><p>3-letter file type code, to assign to the output of a pipeline
step. Keys are the product types (as defined in prodtype_map).</p>
</dd>
<dt><strong>step_map</strong><span class="classifier">dict</span></dt><dd><p>Inverse of the prodtype_map, for looking up pipeline
step names from product types.  Keys are the product types.</p>
</dd>
<dt><strong>prodtypes</strong><span class="classifier">list</span></dt><dd><p>List of product types, corresponding to the currently
loaded recipe.  This list is populated whenever the recipe
attribute is set.</p>
</dd>
<dt><strong>slit_image_recipe</strong><span class="classifier">list</span></dt><dd><p>Alternate processing recipe to use when input data is
marked as a slit image (SLIT!=NONE).  Calibration and
coaddition steps are skipped.</p>
</dd>
<dt><strong>mosaic_recipe</strong><span class="classifier">list</span></dt><dd><p>Alternate processing recipe to use when input is telluric-
corrected or calibrated.  Only calibration, registration,
and coaddition are applied.</p>
</dd>
<dt><strong>basehead</strong><span class="classifier"><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v5.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits.Header</span></code></a></span></dt><dd><p>Header for the first raw input file loaded, used for calibration
configuration.</p>
</dd>
<dt><strong>calres</strong><span class="classifier">dict-like</span></dt><dd><p>Reduction mode and auxiliary file configuration mapping,
as returned from the sofia_redux.instruments.forcast
<code class="xref py py-obj docutils literal notranslate"><span class="pre">getcalpath</span></code> function.</p>
</dd>
<dt><strong>cal_conf</strong><span class="classifier">dict-like</span></dt><dd><p>Flux calibration and atmospheric correction configuration,
as returned from the pipecal <code class="xref py py-obj docutils literal notranslate"><span class="pre">pipecal_config</span></code> function.</p>
</dd>
</dl>
</dd>
</dl>
<p>Initialize the reduction object.</p>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.checkhead" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.checkhead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">checkhead</span></code></a>()</p></td>
<td><p>Check input headers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.clean" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clean</span></code></a>()</p></td>
<td><p>Clean bad pixels from image data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.droop" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.droop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">droop</span></code></a>()</p></td>
<td><p>Correct for 'droop' detector response effect.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.getfilename" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.getfilename"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getfilename</span></code></a>(header[, update, prodtype, filenum])</p></td>
<td><p>Create an output filename from an input header.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.getfilenum" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.getfilenum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getfilenum</span></code></a>(filename)</p></td>
<td><p>Get the file number from a file name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.load" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(data[, param_class])</p></td>
<td><p>Load input data to make it available to reduction steps.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.load_fits" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.load_fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_fits</span></code></a>([intermediate])</p></td>
<td><p>Load FITS data into memory.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.nonlin" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.nonlin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nonlin</span></code></a>()</p></td>
<td><p>Correct for detector nonlinearity.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.register_viewers" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.register_viewers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_viewers</span></code></a>()</p></td>
<td><p>Return a new QADViewer.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.set_display_data" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.set_display_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_display_data</span></code></a>([raw, filenames])</p></td>
<td><p>Store display data for QAD viewer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.stack" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.stack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stack</span></code></a>()</p></td>
<td><p>Stack chop/nod frames.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.update_output" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.update_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_output</span></code></a>(hdul, filenum, prodtype)</p></td>
<td><p>Update output FITS file after a pipeline step.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.update_sofia_keys" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.update_sofia_keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_sofia_keys</span></code></a>(header)</p></td>
<td><p>Update required SOFIA header keywords.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.write_output" title="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.write_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_output</span></code></a>(hdul, outname)</p></td>
<td><p>Write an output FITS file to disk.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.checkhead">
<span class="sig-name descname"><span class="pre">checkhead</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.checkhead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.checkhead" title="Permalink to this definition">¶</a></dt>
<dd><p>Check input headers.</p>
<p>Calls sofia_redux.instruments.forcast.hdcheck.hdcheck to
compare header keywords to requirements.  Halts reduction if
the abort parameter is True and the headers do not meet
requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.clean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean bad pixels from image data.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/forcast/index.html#module-sofia_redux.instruments.forcast.check_readout_shift" title="sofia_redux.instruments.forcast.check_readout_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.forcast.check_readout_shift</span></code></a>
to determine if the 16-pixel readout error is present,
and corrects for it if desired.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/forcast/index.html#module-sofia_redux.instruments.forcast.clean" title="sofia_redux.instruments.forcast.clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.forcast.clean</span></code></a> to clean bad
pixels identified in a bad pixel mask.  Bad pixels may be either
interpolated over or propagated as NaN values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.droop">
<span class="sig-name descname"><span class="pre">droop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.droop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.droop" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for ‘droop’ detector response effect.</p>
<p>Calls <a class="reference internal" href="sofia_redux.instruments.forcast.droop.droop.html#sofia_redux.instruments.forcast.droop.droop" title="sofia_redux.instruments.forcast.droop.droop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.forcast.droop.droop</span></code></a>.
The droop correction may be tuned with the fracdroop parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.getfilename">
<span class="sig-name descname"><span class="pre">getfilename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prodtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RAW'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'UNKNOWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.getfilename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.getfilename" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an output filename from an input header.</p>
<p>Requires calibration data to be loaded (self.calres).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>header</strong><span class="classifier">astropy.io.fits.Header</span></dt><dd><p>Header to create filename from.</p>
</dd>
<dt><strong>update</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, FILENAME key will be added or updated
in the header.</p>
</dd>
<dt><strong>prodtype</strong><span class="classifier">str, optional</span></dt><dd><p>Three letter product type designator.</p>
</dd>
<dt><strong>filenum</strong><span class="classifier">str or list, optional</span></dt><dd><p>List of file numbers to concatenate for filename.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>The output name.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.getfilenum">
<span class="sig-name descname"><span class="pre">getfilenum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.getfilenum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.getfilenum" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the file number from a file name.</p>
<p>Returns UNKNOWN if file number can’t be parsed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>File name to parse.  Assumed to be *_[filenum].fits.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str or list</dt><dd><p>File number(s), formatted to 4 digits.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load input data to make it available to reduction steps.</p>
<p>The process is:</p>
<ul class="simple">
<li><p>Call the parent load method to initialize data
reduction variables.</p></li>
<li><p>Use the first loaded FITS header to determine and load
the DRIP configuration (<a class="reference internal" href="../sofia_redux/instruments/forcast/index.html#module-sofia_redux.instruments.forcast.getcalpath" title="sofia_redux.instruments.forcast.getcalpath"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.forcast.getcalpath</span></code></a>,
<a class="reference internal" href="../sofia_redux/instruments/forcast/index.html#module-sofia_redux.instruments.forcast.configuration" title="sofia_redux.instruments.forcast.configuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.forcast.configuration</span></code></a>).</p></li>
<li><p>Use the loaded configuration and the product type in the
base header to determine the data processing recipe.</p></li>
<li><p>Load parameters for all steps.</p></li>
<li><p>Load the data immediately if starting from an intermediate
step; otherwise, just load the raw headers and defer loading
the data from the FITS files.</p></li>
</ul>
<p>After this step, the input attribute is populated as required
for the first pipeline step in the recipe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">list of str or str</span></dt><dd><p>Input file paths to load.</p>
</dd>
<dt><strong>param_class</strong><span class="classifier">class, optional</span></dt><dd><p>Parameters to instantiate, if not FORCASTParameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.load_fits">
<span class="sig-name descname"><span class="pre">load_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intermediate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.load_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.load_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Load FITS data into memory.</p>
<p>Handles raw data, as well as intermediate data.  Intermediate
data may have been produced by the current pipeline version
(multiple HDUs expected), or from the v1 IDL pipeline
(single HDU expected).</p>
<p>Loaded data are stored in the input attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>intermediate</strong><span class="classifier">bool</span></dt><dd><p>If False, the
<a class="reference internal" href="sofia_redux.instruments.forcast.readfits.readfits.html#sofia_redux.instruments.forcast.readfits.readfits" title="sofia_redux.instruments.forcast.readfits.readfits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.forcast.readfits.readfits</span></code></a>
function will be used to read in the data and calculate
the associated error images.  If True, the data will
just be read in from disk.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.nonlin">
<span class="sig-name descname"><span class="pre">nonlin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.nonlin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.nonlin" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for detector nonlinearity.</p>
<p>Calls <a class="reference internal" href="sofia_redux.instruments.forcast.imgnonlin.imgnonlin.html#sofia_redux.instruments.forcast.imgnonlin.imgnonlin" title="sofia_redux.instruments.forcast.imgnonlin.imgnonlin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.forcast.imgnonlin.imgnonlin</span></code></a>.
The image section that determines the background levels for the
correction may be specified in parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.register_viewers">
<span class="sig-name descname"><span class="pre">register_viewers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.register_viewers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.register_viewers" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new QADViewer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.set_display_data">
<span class="sig-name descname"><span class="pre">set_display_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.set_display_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.set_display_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Store display data for QAD viewer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>raw</strong><span class="classifier">bool</span></dt><dd><p>If True, display data is taken from self.rawfiles.
If False, display data is taken from self.input</p>
</dd>
<dt><strong>filenames</strong><span class="classifier">list of str, optional</span></dt><dd><p>If provided and <code class="xref py py-obj docutils literal notranslate"><span class="pre">raw</span></code> is False, file names will be
passed to QADViewer instead of self.input.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.stack">
<span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Stack chop/nod frames.</p>
<p>Calls <a class="reference internal" href="sofia_redux.instruments.forcast.stack.stack.html#sofia_redux.instruments.forcast.stack.stack" title="sofia_redux.instruments.forcast.stack.stack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.forcast.stack.stack</span></code></a>.
Images are chop- and nod-subtracted and cleaned of
“jailbar” artifacts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.update_output">
<span class="sig-name descname"><span class="pre">update_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prodtype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.update_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.update_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Update output FITS file after a pipeline step.</p>
<p>Sets the PRODTYPE key, adds a HISTORY message with
the pipeline step name, and updates the FILENAME
key with a new filename, appropriate to the prodtype.
The new filename is returned from the function.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>hdul</strong><span class="classifier"><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/hdulists.html#astropy.io.fits.HDUList" title="(in Astropy v5.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits.HDUList</span></code></a></span></dt><dd><p>Output FITS HDUList.</p>
</dd>
<dt><strong>filenum</strong><span class="classifier">str or list</span></dt><dd><p>File number(s) to use in the filename.</p>
</dd>
<dt><strong>prodtype</strong><span class="classifier">str</span></dt><dd><p>Product type for the completed step.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>File base name for the output product.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.update_sofia_keys">
<span class="sig-name descname"><span class="pre">update_sofia_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.update_sofia_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.update_sofia_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Update required SOFIA header keywords.</p>
<p>Keywords added or updated are:</p>
<blockquote>
<div><ul class="simple">
<li><p>PROCSTAT: set to LEVEL_2</p></li>
<li><p>ASSC_AOR: copied from AOR_ID</p></li>
<li><p>ASSC_OBS: copied from OBS_ID</p></li>
<li><p>ASSC_MSN: copied from MISSN-ID</p></li>
<li><p>OBS_ID: prepended with ‘P_’</p></li>
<li><p>PIPELINE: set to pipe_name</p></li>
<li><p>PIPEVERS: set to pipe_version</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>header</strong><span class="classifier"><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v5.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits.Header</span></code></a></span></dt><dd><p>Header to update.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.write_output">
<span class="sig-name descname"><span class="pre">write_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/forcast_reduction.html#FORCASTReduction.write_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.write_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an output FITS file to disk.</p>
<p>Outname is joined to self.output_directory, before writing.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>hdul</strong><span class="classifier"><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/hdulists.html#astropy.io.fits.HDUList" title="(in Astropy v5.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits.HDUList</span></code></a></span></dt><dd><p>FITS HDUList to write.</p>
</dd>
<dt><strong>outname</strong><span class="classifier">str</span></dt><dd><p>File basename to write.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>Full path to the output file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">FORCASTReduction</a><ul>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction</span></code></a><ul>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.checkhead"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.checkhead()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.clean"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.clean()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.droop"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.droop()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.getfilename"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.getfilename()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.getfilenum"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.getfilenum()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.load"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.load()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.load_fits"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.load_fits()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.nonlin"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.nonlin()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.register_viewers"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.register_viewers()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.set_display_data"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.set_display_data()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.stack"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.stack()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.update_output"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.update_output()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.update_sofia_keys"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.update_sofia_keys()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.write_output"><code class="docutils literal notranslate"><span class="pre">FORCASTReduction.write_output()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.pipeline.sofia.forcast_reduction.FORCASTReduction.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>