<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>readraw &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="spatial_shift" href="sofia_redux.instruments.exes.spatial_shift.spatial_shift.html" />
    <link rel="prev" title="readhdr" href="sofia_redux.instruments.exes.readhdr.readhdr.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.instruments.exes.spatial_shift.spatial_shift.html" title="spatial_shift">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.instruments.exes.readhdr.readhdr.html" title="readhdr">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/exes/developers/developers.html" accesskey="U">EXES Redux Developer’s Manual</a> &#187;</li>
      
      <li>readraw</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="readraw">
<h1>readraw<a class="headerlink" href="#readraw" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.instruments.exes.readraw.readraw">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.instruments.exes.readraw.</span></span><span class="sig-name descname"><span class="pre">readraw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_lincor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toss_nint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/exes/readraw.html#readraw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.exes.readraw.readraw" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for nonlinearity combine individual readouts.</p>
<p>First corrects nonlinearity for each readout frame (<code class="xref py py-obj docutils literal notranslate"><span class="pre">exes.lincor</span></code>),
then determines the readout pattern from the OTPAT keyword.</p>
<p>For readout coadding methods, this step currently has support for Fowler
mode, simple destructive read, and equally spaced sample-up-the-ramp
patterns.  Frames are combined and variance is calculated based on the
readout pattern, using algorithms from the following paper:</p>
<blockquote>
<div><p>Nonlinearity Corrections and Statistical Uncertainties
Associated with Near-Infrared Arrays, William D. Vacca,
Michael C. Cushing and John T. Rayner (2004, PASP 116, 352).</p>
</div></blockquote>
<p>The readout algorithm may also be directly specified by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">algorithm</span></code>
parameter, which takes the following possible integer values:</p>
<blockquote>
<div><ul class="simple">
<li><p>0 : Use the last destructive frame only</p></li>
<li><p>1 : Simple destructive mode</p></li>
<li><p>2 : Use the first and last frames only</p></li>
<li><p>3 : Use the second and penultimate frames only</p></li>
<li><p>4 : Fowler mode</p></li>
<li><p>5 : Sample-up-the-ramp mode</p></li>
</ul>
</div></blockquote>
<p>After readout coadd, multiple frames taken at the same nod position (as
indicated by the NINT keyword) are averaged.  Extra frames that
do not match the OTPAT or NINT pattern are dropped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>[nframe, nspec, nspat] array of float values.</p>
</dd>
<dt><strong>header</strong><span class="classifier">fits.Header</span></dt><dd><p>FITS header produced by <code class="xref py py-obj docutils literal notranslate"><span class="pre">exes.readhdr</span></code>.  Note that the header will
be updated in-place.</p>
</dd>
<dt><strong>do_lincor</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, do the nonlinear correction.  If False, no check is
performed on data quality: the output mask will be all False
(no bad pixels).</p>
</dd>
<dt><strong>algorithm</strong><span class="classifier">int, optional</span></dt><dd><p>Used to select processing mode.  If None, defaults to that determined
by <code class="xref py py-obj docutils literal notranslate"><span class="pre">check_readout_pattern</span></code>.</p>
</dd>
<dt><strong>toss_nint</strong><span class="classifier">int, optional</span></dt><dd><p>If provided and greater than 0 but less than the number of
integrations present in the data, <code class="xref py py-obj docutils literal notranslate"><span class="pre">toss_nint</span></code> integrations will be
discarded from the beginning of the data array.  If the number
equals the number of integrations, the first nod is a B nod,
and there is another B nod in the data array, the first integrations
are instead replaced with a copy of the second B nod.</p>
</dd>
<dt><strong>copy_int</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">toss_nint</span></code> is greater than 0 and <code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_int</span></code> is True, replacement
integrations are always copied from the next B nod, regardless of
the number of integrations available.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>coadd_data, variance, mask</strong><span class="classifier">3-tuple of numpy.ndarray</span></dt><dd><p>The coadded data, variance, and good data mask.  The coadd_data and
variance have shape (nframes, ny, nx).  The mask has shape (ny, nx)
and Boolean data type, where True indicates a good pixel; False
indicates a bad pixel.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">readraw</a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.exes.readraw.readraw"><code class="docutils literal notranslate"><span class="pre">readraw()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.instruments.exes.readraw.readraw.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>