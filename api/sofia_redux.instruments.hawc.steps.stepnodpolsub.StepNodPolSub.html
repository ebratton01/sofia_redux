<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>StepNodPolSub &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="StepNoiseFFT" href="sofia_redux.instruments.hawc.steps.stepnoisefft.StepNoiseFFT.html" />
    <link rel="prev" title="StepMkflat" href="sofia_redux.instruments.hawc.steps.stepmkflat.StepMkflat.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.instruments.hawc.steps.stepnoisefft.StepNoiseFFT.html" title="StepNoiseFFT">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.instruments.hawc.steps.stepmkflat.StepMkflat.html" title="StepMkflat">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/hawc/developers/developers.html" accesskey="U">HAWC+ DRP Developer’s Manual</a> &#187;</li>
      
      <li>StepNodPolSub</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="stepnodpolsub">
<h1>StepNodPolSub<a class="headerlink" href="#stepnodpolsub" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sofia_redux.instruments.hawc.steps.stepnodpolsub.</span></span><span class="sig-name descname"><span class="pre">StepNodPolSub</span></span><a class="reference internal" href="../_modules/sofia_redux/instruments/hawc/steps/stepnodpolsub.html#StepNodPolSub"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sofia_redux.instruments.hawc.stepparent.StepParent.html#sofia_redux.instruments.hawc.stepparent.StepParent" title="sofia_redux.instruments.hawc.stepparent.StepParent"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepParent</span></code></a></p>
<p>Subtract low nods from high nods.</p>
<p>This step identifies low nods in the input data, and subtracts
them from the high nods.  The data must have been taken in either
an ABBA pattern, or else must consist entirely of A nods (no
nodding occurred).  Error images for all nods are propagated
appropriately.</p>
<p>For diagnostic purposes, the R and T data are also added across
all nod positions, and stored as a ‘CMSIG’ extension.</p>
<p>The input for this step is assumed to be generated by
<code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.hawc.steps.StepCombine</span></code>.  The output is a
DataFits with several image and table extensions. Seven image extensions
for each HWP angle <em>M</em> are created: DATA R-T HWP M, ERROR R-T HWP M,
DATA R+T HWP M, ERROR R+T HWP M, VAR R HWP M, VAR T HWP M,
and CMSIG R+T HWP M. Also, a table, TABLE HWP M is created. Lastly,
BAD PIXEL MASK is copied from the input into the output file.</p>
<p class="rubric">Notes</p>
<p>For ABBA data, the output images (<span class="math notranslate nohighlight">\(d'\)</span>) and associated errors
(<span class="math notranslate nohighlight">\(\sigma'\)</span>) are calculated as:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[d' = \frac{1}{2}(d_A - d_B)\]</div>
<div class="math notranslate nohighlight">
\[\sigma' = \frac{1}{2}\sqrt{\sigma_A^2 + \sigma_B^2}\]</div>
</div></blockquote>
<p>The variances in R and T are also propagated as:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\sigma_R'^2 = \sigma_{R,A}'^2 + \sigma_{R,B}'^2\]</div>
<div class="math notranslate nohighlight">
\[\sigma_T'^2 = \sigma_{T,A}'^2 + \sigma_{T,B}'^2\]</div>
</div></blockquote>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub.run" title="sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>()</p></td>
<td><p>Run the data reduction algorithm.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub.setup" title="sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub.setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code></a>()</p></td>
<td><p>Set parameters and metadata for the pipeline step.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/hawc/steps/stepnodpolsub.html#StepNodPolSub.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the data reduction algorithm.</p>
<p>Because this step is single-in, single-out (SISO),
self.datain must be a DataFits object.  The output
is also a DataFits object, stored in self.dataout.</p>
<p>The process is:</p>
<ol class="arabic simple">
<li><p>For each HWP angle, subtract the B nod from the A nod,
and divide by two (assuming a nod-match-chop pattern);
propagate errors accordingly.</p></li>
<li><p>Store the data in a DataFits object.</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/hawc/steps/stepnodpolsub.html#StepNodPolSub.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameters and metadata for the pipeline step.</p>
<p>Output files have PRODTYPE = ‘nodpolsub’, and are named with
the step abbreviation ‘NPS’.</p>
<p>No parameters are currently defined for this step.</p>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">StepNodPolSub</a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub"><code class="docutils literal notranslate"><span class="pre">StepNodPolSub</span></code></a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub.run"><code class="docutils literal notranslate"><span class="pre">StepNodPolSub.run()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub.setup"><code class="docutils literal notranslate"><span class="pre">StepNodPolSub.setup()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.instruments.hawc.steps.stepnodpolsub.StepNodPolSub.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>