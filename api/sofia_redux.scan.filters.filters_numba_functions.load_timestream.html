<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>load_timestream &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="remove_rejection_from_frames" href="sofia_redux.scan.filters.filters_numba_functions.remove_rejection_from_frames.html" />
    <link rel="prev" title="Filter" href="sofia_redux.scan.filters.filter.Filter.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.scan.filters.filters_numba_functions.remove_rejection_from_frames.html" title="remove_rejection_from_frames">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.scan.filters.filter.Filter.html" title="Filter">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../sofia_redux/scan/index.html" accesskey="U">sofia_redux.scan: Scan Mode Algorithms for SOFIA Pipelines</a> &#187;</li>
      
      <li>load_timestream</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="load-timestream">
<h1>load_timestream<a class="headerlink" href="#load-timestream" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.scan.filters.filters_numba_functions.load_timestream">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.scan.filters.filters_numba_functions.</span></span><span class="sig-name descname"><span class="pre">load_timestream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeling_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/filters/filters_numba_functions.html#load_timestream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.filters.filters_numba_functions.load_timestream" title="Permalink to this definition">¶</a></dt>
<dd><p>Load timestream data from the supplied frame data.</p>
<p>The timestream data is defined as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>timestream = (d * w) - mean(d * w)
</pre></div>
</div>
<p>In addition, the points are also calculated at this stage as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>points = sum(w)
</pre></div>
</div>
<p>where d is the <code class="xref py py-obj docutils literal notranslate"><span class="pre">frame_data</span></code> and w are the <code class="xref py py-obj docutils literal notranslate"><span class="pre">frame_weights</span></code>.  This
calculation occurs for each channel supplied in <code class="xref py py-obj docutils literal notranslate"><span class="pre">channel_indices</span></code>.
Only valid samples are included in the mean and sum operations, and
equivalent timestream values for invalid samples will be set to zero
on output.  Invalid samples are those in which the frame is marked as
invalid or a modeling frame, the frame data is NaN or sample flag is
nonzero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame_data</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The frame data of shape (n_frames, all_channels).</p>
</dd>
<dt><strong>frame_weights</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The frame weights of shape (n_frames,).</p>
</dd>
<dt><strong>frame_valid</strong><span class="classifier">numpy.ndarray (bool)</span></dt><dd><p>An array of shape (n_frames,) where <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> indicates that a frame
is valid and may be included in the time stream.</p>
</dd>
<dt><strong>modeling_frames</strong><span class="classifier">numpy.ndarray (bool)</span></dt><dd><p>A boolean mask where <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> marks a frame as a modeling frame, and
will therefore not be included in the output timestream.</p>
</dd>
<dt><strong>channel_indices</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The filter channel group indices, used to extract the correct
channel information from the frame sample data.</p>
</dd>
<dt><strong>sample_flags</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The data sample flags of shape (n_frames, all_channels) where any
non-zero value will not be included in the time-stream.</p>
</dd>
<dt><strong>timestream</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The data output array to populate.  Should be of shape
(n_channels, n_frames) where n_frames is the number of integration
frames, and n_channels is the number of channels in the filter
channel group.</p>
</dd>
<dt><strong>points</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The sum of valid frame weights for each channel.  Should be of shape
(n_channels,) where n_channels is the number of channels in the filter
channel group.  Will be updated in-place.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">load_timestream</a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.filters.filters_numba_functions.load_timestream"><code class="docutils literal notranslate"><span class="pre">load_timestream()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.scan.filters.filters_numba_functions.load_timestream.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>