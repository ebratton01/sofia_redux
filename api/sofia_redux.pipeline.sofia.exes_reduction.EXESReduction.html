<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>EXESReduction &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FIFILSReduction" href="sofia_redux.pipeline.sofia.fifils_reduction.FIFILSReduction.html" />
    <link rel="prev" title="parse_bg" href="sofia_redux.pipeline.sofia.sofia_utilities.parse_bg.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.pipeline.sofia.fifils_reduction.FIFILSReduction.html" title="FIFILSReduction">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.pipeline.sofia.sofia_utilities.parse_bg.html" title="parse_bg">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../sofia_redux/pipeline/index.html" accesskey="U">sofia_redux.pipeline: Data Reduction Pipelines for SOFIA</a> &#187;</li>
      
      <li>EXESReduction</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="exesreduction">
<h1>EXESReduction<a class="headerlink" href="#exesreduction" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sofia_redux.pipeline.sofia.exes_reduction.</span></span><span class="sig-name descname"><span class="pre">EXESReduction</span></span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sofia_redux.pipeline.reduction.Reduction.html#sofia_redux.pipeline.reduction.Reduction" title="sofia_redux.pipeline.reduction.Reduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reduction</span></code></a></p>
<p>EXES reduction steps.</p>
<p>Primary image reduction algorithms are defined in the EXES
package (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes</span></code>).  Spectroscopy-related
algorithms are pulled from the <code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.spectroscopy</span></code> package,
and some utilities and display tools come from the <code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.toolkit</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.calibration</span></code>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.visualization</span></code> packages.</p>
<p>This reduction object defines a recipe for data reduction and a
method for each pipeline step that calls the appropriate algorithm
from its source packages.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>prodtype_map</strong><span class="classifier">dict</span></dt><dd><p>Maps the pipeline step to a product type, to assign
to the PRODTYPE header key. Keys are pipeline step function
names.</p>
</dd>
<dt><strong>prodnames</strong><span class="classifier">dict</span></dt><dd><p>3-letter file type code, to assign to the output of a pipeline
step. Keys are the product types (as defined in prodtype_map).</p>
</dd>
<dt><strong>step_map</strong><span class="classifier">dict</span></dt><dd><p>Inverse of the prodtype_map, for looking up pipeline
step names from product types.  Keys are the product types.</p>
</dd>
<dt><strong>prodtypes</strong><span class="classifier">list</span></dt><dd><p>List of product types, corresponding to the currently
loaded recipe.  This list is populated whenever the recipe
attribute is set.</p>
</dd>
<dt><strong>default_recipe</strong><span class="classifier">list</span></dt><dd><p>Processing recipe used for standard science processing.</p>
</dd>
<dt><strong>default_prodtype_map</strong><span class="classifier">list</span></dt><dd><p>Product type map used for standard science processing.</p>
</dd>
<dt><strong>default_prodnames</strong><span class="classifier">list</span></dt><dd><p>Product names used for standard science processing.</p>
</dd>
<dt><strong>default_step_map</strong><span class="classifier">list</span></dt><dd><p>Step name map used for standard science processing.</p>
</dd>
<dt><strong>sky_spectrum</strong><span class="classifier">bool</span></dt><dd><p>Flag to indicate that data should be reduced as a sky spectrum
extraction, instead of standard science processing.</p>
</dd>
<dt><strong>sky_prodtype_map</strong><span class="classifier">list</span></dt><dd><p>Alternate product types to use for sky spectrum extraction.</p>
</dd>
<dt><strong>sky_prodnames</strong><span class="classifier">list</span></dt><dd><p>Alternate product names to use for sky spectrum extraction.</p>
</dd>
<dt><strong>sky_step_map</strong><span class="classifier">list</span></dt><dd><p>Alternate step name map to use for sky spectrum extraction.</p>
</dd>
<dt><strong>wcs_keys</strong><span class="classifier">list</span></dt><dd><p>List of header keywords used for tracking and propagating the
spectral world coordinate system.</p>
</dd>
<dt><strong>spec1d_prodtype</strong><span class="classifier">list</span></dt><dd><p>List of product types currently and historically used to designate
1D spectral products, used for display purposes and
backwards-compatible handling.</p>
</dd>
</dl>
</dd>
</dl>
<p>Initialize the reduction object.</p>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.clean_badpix" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.clean_badpix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clean_badpix</span></code></a>()</p></td>
<td><p>Clean or flag bad pixels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.coadd_pairs" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.coadd_pairs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coadd_pairs</span></code></a>()</p></td>
<td><p>Coadd nod pairs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.coadd_readouts" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.coadd_readouts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coadd_readouts</span></code></a>()</p></td>
<td><p>Coadd raw readouts.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.combine_spectra" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.combine_spectra"><code class="xref py py-obj docutils literal notranslate"><span class="pre">combine_spectra</span></code></a>()</p></td>
<td><p>Combine spectra.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.concatenate_filenum" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.concatenate_filenum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">concatenate_filenum</span></code></a>(filenum)</p></td>
<td><p>Concatenate file numbers, first-last.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.convert_units" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.convert_units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_units</span></code></a>()</p></td>
<td><p>Convert calibrated units to flux in Jy/pixel.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.correct_calibration" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.correct_calibration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">correct_calibration</span></code></a>()</p></td>
<td><p>Correct calibration for blackbody variation by wavenumber.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.debounce" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.debounce"><code class="xref py py-obj docutils literal notranslate"><span class="pre">debounce</span></code></a>()</p></td>
<td><p>Correct for optical shifts (bounces).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.despike" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.despike"><code class="xref py py-obj docutils literal notranslate"><span class="pre">despike</span></code></a>()</p></td>
<td><p>Flag temporal outliers (spikes).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.extract_spectra" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.extract_spectra"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extract_spectra</span></code></a>()</p></td>
<td><p>Extract 1D spectra from apertures.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.flat_correct" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.flat_correct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flat_correct</span></code></a>()</p></td>
<td><p>Calibrate and flat correct science data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.get_filename" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.get_filename"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_filename</span></code></a>(header[, filenum, prodtype, update])</p></td>
<td><p>Create an output filename from an input header.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.get_filenum" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.get_filenum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_filenum</span></code></a>(filename)</p></td>
<td><p>Get a file number from an EXES file name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(data)</p></td>
<td><p>Load input data to make it available to reduction steps.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load_data" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_data</span></code></a>()</p></td>
<td><p>Load FITS data into memory and standardize headers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load_fits" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load_fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_fits</span></code></a>()</p></td>
<td><p>Load FITS data into the input attribute.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.locate_apertures" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.locate_apertures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">locate_apertures</span></code></a>()</p></td>
<td><p>Automatically find aperture centers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.make_flat" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.make_flat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_flat</span></code></a>()</p></td>
<td><p>Make a processed flat file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.make_profiles" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.make_profiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_profiles</span></code></a>()</p></td>
<td><p>Produce spatial profile fits from rectified images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.merge_orders" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.merge_orders"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_orders</span></code></a>()</p></td>
<td><p>Merge all spectral orders.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.refine_wavecal" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.refine_wavecal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">refine_wavecal</span></code></a>()</p></td>
<td><p>Refine wavecal by setting a new central wavenumber.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.register_viewers" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.register_viewers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_viewers</span></code></a>()</p></td>
<td><p>Return a new QADViewer, ProfileViewer, and SpectralViewer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.set_apertures" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.set_apertures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_apertures</span></code></a>()</p></td>
<td><p>Set aperture radii.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.set_display_data" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.set_display_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_display_data</span></code></a>([raw, filenames])</p></td>
<td><p>Store display data for viewer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.specmap" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.specmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">specmap</span></code></a>()</p></td>
<td><p>Generate a quick-look spectral plot.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.subtract_background" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.subtract_background"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subtract_background</span></code></a>()</p></td>
<td><p>Subtract background along columns.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.subtract_nods" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.subtract_nods"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subtract_nods</span></code></a>()</p></td>
<td><p>Subtract B nods from A nods for background correction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.undistort" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.undistort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">undistort</span></code></a>()</p></td>
<td><p>Correct for optical distortion.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.update_output" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.update_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_output</span></code></a>(hdul, filenum, prodtype)</p></td>
<td><p>Update output FITS file after a pipeline step.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.update_sofia_keys" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.update_sofia_keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_sofia_keys</span></code></a>(header)</p></td>
<td><p>Update required SOFIA header keywords.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.write_output" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.write_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_output</span></code></a>(hdul, outname)</p></td>
<td><p>Write an output FITS file to disk.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.clean_badpix">
<span class="sig-name descname"><span class="pre">clean_badpix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.clean_badpix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.clean_badpix" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean or flag bad pixels.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.clean" title="sofia_redux.instruments.exes.clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.clean</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.coadd_pairs">
<span class="sig-name descname"><span class="pre">coadd_pairs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.coadd_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.coadd_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Coadd nod pairs.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.coadd" title="sofia_redux.instruments.exes.coadd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.coadd</span></code></a> to mean combine input
frames in each file.</p>
<p>Optionally, all files may be combined into a single file
to be coadded together. Aternatively, all files may be split
into separate files, one per frame, so that no frames are coadded.</p>
<p>Prior to the coadd, it is possible to apply a small spatial shift
to align frames (<code class="xref py py-obj docutils literal notranslate"><span class="pre">exes.spatial_shift</span></code>). It is also possible to
subtract the mean value at each column to correct residual background
levels, if INSTMODE = NOD_ON_SLIT.</p>
<p>To inspect the effect of these options, it is possible to save
intermediate pre-coadd files to disk. If saved, they will have
PRODTYPE = coadd_input and file code COI.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.coadd_readouts">
<span class="sig-name descname"><span class="pre">coadd_readouts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.coadd_readouts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.coadd_readouts" title="Permalink to this definition">¶</a></dt>
<dd><p>Coadd raw readouts.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.derasterize" title="sofia_redux.instruments.exes.derasterize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.derasterize</span></code></a> for raster
flats and darks and <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.readraw" title="sofia_redux.instruments.exes.readraw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.readraw</span></code></a>
for all other data.</p>
<p>Optionally, if the ‘fix_row_gains’ parameter is set,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">exes.correct_row_gains</span></code> is called after readouts are coadded.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.combine_spectra">
<span class="sig-name descname"><span class="pre">combine_spectra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.combine_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.combine_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine spectra.</p>
<p>Calls <a class="reference internal" href="sofia_redux.toolkit.image.combine.combine_images.html#sofia_redux.toolkit.image.combine.combine_images" title="sofia_redux.toolkit.image.combine.combine_images"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.toolkit.image.combine.combine_images</span></code></a>
for coaddition. The combination method may be configured in
parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.concatenate_filenum">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">concatenate_filenum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filenum</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.concatenate_filenum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.concatenate_filenum" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate file numbers, first-last.</p>
<p>File numbers are sorted alphanumerically.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filenum</strong><span class="classifier">str or list</span></dt><dd><p>File numbers to concatenate.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>Concatenated file number.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.convert_units">
<span class="sig-name descname"><span class="pre">convert_units</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.convert_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.convert_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert calibrated units to flux in Jy/pixel.</p>
<p>Uses the OMEGAP keyword to correct for the solid angle per pixel.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.correct_calibration">
<span class="sig-name descname"><span class="pre">correct_calibration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.correct_calibration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.correct_calibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct calibration for blackbody variation by wavenumber.</p>
<p>The <a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.flat_correct" title="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.flat_correct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flat_correct</span></code></a> step calibrates the spectral flux to
physical units based on the blackbody function at the
central wavenumber in the flat. This step corrects the
calibration for the variation of the blackbody with respect
to wavenumber values at each pixel in the spectral image.</p>
<p>Calls <a class="reference internal" href="sofia_redux.instruments.exes.makeflat.bnu.html#sofia_redux.instruments.exes.makeflat.bnu" title="sofia_redux.instruments.exes.makeflat.bnu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.makeflat.bnu</span></code></a> on wavenumber
values in the WAVECAL extension to determine a correction image
for the FLUX. This correction image is directly multiplied into
the FLUX data array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.debounce">
<span class="sig-name descname"><span class="pre">debounce</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.debounce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.debounce" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for optical shifts (bounces).</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.debounce" title="sofia_redux.instruments.exes.debounce"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.debounce</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.despike">
<span class="sig-name descname"><span class="pre">despike</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.despike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.despike" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag temporal outliers (spikes).</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.despike" title="sofia_redux.instruments.exes.despike"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.despike</span></code></a> on each input file.</p>
<p>Typically, A beams within are compared separately from B beams,
but if desired, the beam designation can be ignored and all
frames compared together.</p>
<p>It is also possible to combine all input files before running
despike. In this case, all input will be treated as a single
file in all subsequent steps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.extract_spectra">
<span class="sig-name descname"><span class="pre">extract_spectra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.extract_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.extract_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract 1D spectra from apertures.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/spectroscopy/index.html#module-sofia_redux.spectroscopy.extspec" title="sofia_redux.spectroscopy.extspec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.spectroscopy.extspec</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.flat_correct">
<span class="sig-name descname"><span class="pre">flat_correct</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.flat_correct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.flat_correct" title="Permalink to this definition">¶</a></dt>
<dd><p>Calibrate and flat correct science data.</p>
<p>Input data must have FLAT extensions attached.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.calibrate" title="sofia_redux.instruments.exes.calibrate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.calibrate</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.get_filename">
<span class="sig-name descname"><span class="pre">get_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prodtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.get_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.get_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an output filename from an input header.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>header</strong><span class="classifier">astropy.io.fits.Header</span></dt><dd><p>Header to create filename from.</p>
</dd>
<dt><strong>filenum</strong><span class="classifier">str or list, optional</span></dt><dd><p>List of file numbers to concatenate for filename.</p>
</dd>
<dt><strong>prodtype</strong><span class="classifier">str, optional</span></dt><dd><p>Three letter product type designator.</p>
</dd>
<dt><strong>update</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, the FILENAME key will be added or updated
in the header.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>The output name.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.get_filenum">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_filenum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.get_filenum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.get_filenum" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a file number from an EXES file name.</p>
<p>Formats expected are for raw EXES files (e.g. sirius.sci.10001.fits)
or for intermediate processed files (e.g.
F0001_EX_SPE_0101123_EXEELONEXEECHL_COA_10001-10002.fits.
In either case, the field just before the .fits is expected to
contain the file number.</p>
<p>If the input file references a range of files, e.g. ‘10001-10002’,
the first and last file numbers are returned in a list. Otherwise,
a single integer is returned.  If neither pattern is found,
‘UNKNOWN’ is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>FITS file name, raw or intermediate.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>filenum</strong><span class="classifier">str or list of str</span></dt><dd><p>Integer file numbers referenced in the input file name.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load input data to make it available to reduction steps.</p>
<p>The process is:</p>
<ul class="simple">
<li><p>Call the parent load method to initialize data
reduction variables.</p></li>
<li><p>Use the first loaded FITS header that is not a flat or dark file
to set the observation configuration for the reduction set.</p></li>
<li><p>Use the product type in the base header to determine the
data processing recipe.</p></li>
<li><p>Load parameters for all steps.</p></li>
<li><p>Load the data immediately if it is a 1D spectrum that needs
visualization only; otherwise, just load the raw headers and
defer loading the data from the FITS files.</p></li>
</ul>
<p>After this step, the input attribute is populated as required
for the first pipeline step in the recipe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">list of str or str</span></dt><dd><p>Input file paths to load.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load FITS data into memory and standardize headers.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.readhdr" title="sofia_redux.instruments.exes.readhdr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.readhdr</span></code></a> to standardize
headers and load expected default values.</p>
<p>If the sky_spec parameter is set, product types and names
are updated for sky spectrum extraction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load_fits">
<span class="sig-name descname"><span class="pre">load_fits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.load_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Load FITS data into the input attribute.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.locate_apertures">
<span class="sig-name descname"><span class="pre">locate_apertures</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.locate_apertures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.locate_apertures" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically find aperture centers.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/spectroscopy/index.html#module-sofia_redux.spectroscopy.findapertures" title="sofia_redux.spectroscopy.findapertures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.spectroscopy.findapertures</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.make_flat">
<span class="sig-name descname"><span class="pre">make_flat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.make_flat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.make_flat" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a processed flat file.</p>
<p>If the input data is already a processed flat, it is passed
through without modification.  Otherwise, <code class="xref py py-obj docutils literal notranslate"><span class="pre">exes.makeflat</span></code> is
called to process the flat file.</p>
<p>If multiple unprocessed flat files are provided, they are
mean-combined before processing. If multiple processed flat
files are provided, only the first one is used.</p>
<p>The output data from this step includes only the science files
with new flat extensions attached. Any flat or dark files are
dropped from further processing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.make_profiles">
<span class="sig-name descname"><span class="pre">make_profiles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.make_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.make_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce spatial profile fits from rectified images.</p>
<p>The rectified images and profiles are stored in self.input
for continued processing.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/spectroscopy/index.html#module-sofia_redux.spectroscopy.mkspatprof" title="sofia_redux.spectroscopy.mkspatprof"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.spectroscopy.mkspatprof</span></code></a> and
<a class="reference internal" href="../sofia_redux/spectroscopy/index.html#module-sofia_redux.spectroscopy.rectify" title="sofia_redux.spectroscopy.rectify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.spectroscopy.rectify</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.merge_orders">
<span class="sig-name descname"><span class="pre">merge_orders</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.merge_orders"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.merge_orders" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge all spectral orders.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/spectroscopy/index.html#module-sofia_redux.spectroscopy.mergespec" title="sofia_redux.spectroscopy.mergespec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.spectroscopy.mergespec</span></code></a> to merge the
1D spectra and <a class="reference internal" href="../sofia_redux/toolkit/index.html#module-sofia_redux.toolkit.image.coadd" title="sofia_redux.toolkit.image.coadd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.toolkit.image.coadd</span></code></a> to combine
the 2D spectral images.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.refine_wavecal">
<span class="sig-name descname"><span class="pre">refine_wavecal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.refine_wavecal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.refine_wavecal" title="Permalink to this definition">¶</a></dt>
<dd><p>Refine wavecal by setting a new central wavenumber.</p>
<p>User input should identify the order and pixel position of
a known spectral feature as well as the calibrated wavenumber
for that feature. This information is used to derive a new
central wavenumber.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.wavecal" title="sofia_redux.instruments.exes.wavecal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.wavecal</span></code></a> to update the
wavelength calibration from the central wavenumber.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.register_viewers">
<span class="sig-name descname"><span class="pre">register_viewers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.register_viewers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.register_viewers" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new QADViewer, ProfileViewer, and SpectralViewer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.set_apertures">
<span class="sig-name descname"><span class="pre">set_apertures</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.set_apertures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.set_apertures" title="Permalink to this definition">¶</a></dt>
<dd><p>Set aperture radii.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/spectroscopy/index.html#module-sofia_redux.spectroscopy.getapertures" title="sofia_redux.spectroscopy.getapertures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.spectroscopy.getapertures</span></code></a> and
<a class="reference internal" href="../sofia_redux/spectroscopy/index.html#module-sofia_redux.spectroscopy.mkapmask" title="sofia_redux.spectroscopy.mkapmask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.spectroscopy.mkapmask</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.set_display_data">
<span class="sig-name descname"><span class="pre">set_display_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.set_display_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.set_display_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Store display data for viewer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>raw</strong><span class="classifier">bool</span></dt><dd><p>If True, display data is taken from self.rawfiles.
If False, display data is taken from self.input.</p>
</dd>
<dt><strong>filenames</strong><span class="classifier">list of str, optional</span></dt><dd><p>If provided and <code class="xref py py-obj docutils literal notranslate"><span class="pre">raw</span></code> is False, file names will be
passed to the viewer instead of self.input.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.specmap">
<span class="sig-name descname"><span class="pre">specmap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.specmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.specmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a quick-look spectral plot.</p>
<p>Calls <a class="reference internal" href="sofia_redux.visualization.quicklook.make_spectral_plot.html#sofia_redux.visualization.quicklook.make_spectral_plot" title="sofia_redux.visualization.quicklook.make_spectral_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.visualization.quicklook.make_spectral_plot</span></code></a>.</p>
<p>The output from this step is identical to the input, so is
not saved.  As a side effect, a PNG file is saved to disk to the
same base name as the input file, with a ‘.png’ extension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.subtract_background">
<span class="sig-name descname"><span class="pre">subtract_background</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.subtract_background"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.subtract_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract background along columns.</p>
<p>Calls <a class="reference internal" href="sofia_redux.spectroscopy.extspec.col_subbg.html#sofia_redux.spectroscopy.extspec.col_subbg" title="sofia_redux.spectroscopy.extspec.col_subbg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.spectroscopy.extspec.col_subbg</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.subtract_nods">
<span class="sig-name descname"><span class="pre">subtract_nods</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.subtract_nods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.subtract_nods" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract B nods from A nods for background correction.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.diff_arr" title="sofia_redux.instruments.exes.diff_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.diff_arr</span></code></a> to do the array
subtraction.</p>
<p>If desired, for INSTMODE = NOD_OFF_SLIT, <code class="xref py py-obj docutils literal notranslate"><span class="pre">exes.cirrus</span></code>
may be additionally called to correct for residual background.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.undistort">
<span class="sig-name descname"><span class="pre">undistort</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.undistort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.undistort" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for optical distortion.</p>
<p>Calls <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.tort" title="sofia_redux.instruments.exes.tort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.tort</span></code></a> to do the distortion
correction and <a class="reference internal" href="../sofia_redux/instruments/exes/index.html#module-sofia_redux.instruments.exes.wavecal" title="sofia_redux.instruments.exes.wavecal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.instruments.exes.wavecal</span></code></a> to generate
wavenumber and spatial calibration images.</p>
<p>After this step, all spectral images are rotated as needed
to align the spectral axis with the x-axis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.update_output">
<span class="sig-name descname"><span class="pre">update_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prodtype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.update_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.update_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Update output FITS file after a pipeline step.</p>
<p>Sets the PRODTYPE key, adds a HISTORY message with
the pipeline step name, and updates the FILENAME
key with a new filename, appropriate to the prodtype.
The new filename is returned from the function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>hdul</strong><span class="classifier">astropy.io.fits.HDUList</span></dt><dd><p>Output FITS HDUList.</p>
</dd>
<dt><strong>filenum</strong><span class="classifier">str or list</span></dt><dd><p>File number(s) to use in the filename.</p>
</dd>
<dt><strong>prodtype</strong><span class="classifier">str</span></dt><dd><p>Product type for the completed step.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>File base name for the output product.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.update_sofia_keys">
<span class="sig-name descname"><span class="pre">update_sofia_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.update_sofia_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.update_sofia_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Update required SOFIA header keywords.</p>
<p>Keywords added or updated are:</p>
<blockquote>
<div><ul class="simple">
<li><p>PROCSTAT: set to LEVEL_2</p></li>
<li><p>ASSC_AOR: copied from AOR_ID</p></li>
<li><p>ASSC_OBS: copied from OBS_ID</p></li>
<li><p>ASSC_MSN: copied from MISSN-ID</p></li>
<li><p>OBS_ID: prepended with ‘P_’</p></li>
<li><p>PIPELINE: set to pipe_name</p></li>
<li><p>PIPEVERS: set to pipe_version</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>header</strong><span class="classifier"><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v5.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits.Header</span></code></a></span></dt><dd><p>Header to update.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.write_output">
<span class="sig-name descname"><span class="pre">write_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/pipeline/sofia/exes_reduction.html#EXESReduction.write_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.write_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an output FITS file to disk.</p>
<p>Outname is joined to self.output_directory, before writing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>hdul</strong><span class="classifier">astropy.io.fits.HDUList</span></dt><dd><p>FITS HDUList to write.</p>
</dd>
<dt><strong>outname</strong><span class="classifier">str</span></dt><dd><p>File basename to write.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>Full path to the output file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">EXESReduction</a><ul>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction"><code class="docutils literal notranslate"><span class="pre">EXESReduction</span></code></a><ul>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.clean_badpix"><code class="docutils literal notranslate"><span class="pre">EXESReduction.clean_badpix()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.coadd_pairs"><code class="docutils literal notranslate"><span class="pre">EXESReduction.coadd_pairs()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.coadd_readouts"><code class="docutils literal notranslate"><span class="pre">EXESReduction.coadd_readouts()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.combine_spectra"><code class="docutils literal notranslate"><span class="pre">EXESReduction.combine_spectra()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.concatenate_filenum"><code class="docutils literal notranslate"><span class="pre">EXESReduction.concatenate_filenum()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.convert_units"><code class="docutils literal notranslate"><span class="pre">EXESReduction.convert_units()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.correct_calibration"><code class="docutils literal notranslate"><span class="pre">EXESReduction.correct_calibration()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.debounce"><code class="docutils literal notranslate"><span class="pre">EXESReduction.debounce()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.despike"><code class="docutils literal notranslate"><span class="pre">EXESReduction.despike()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.extract_spectra"><code class="docutils literal notranslate"><span class="pre">EXESReduction.extract_spectra()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.flat_correct"><code class="docutils literal notranslate"><span class="pre">EXESReduction.flat_correct()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.get_filename"><code class="docutils literal notranslate"><span class="pre">EXESReduction.get_filename()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.get_filenum"><code class="docutils literal notranslate"><span class="pre">EXESReduction.get_filenum()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load"><code class="docutils literal notranslate"><span class="pre">EXESReduction.load()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load_data"><code class="docutils literal notranslate"><span class="pre">EXESReduction.load_data()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.load_fits"><code class="docutils literal notranslate"><span class="pre">EXESReduction.load_fits()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.locate_apertures"><code class="docutils literal notranslate"><span class="pre">EXESReduction.locate_apertures()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.make_flat"><code class="docutils literal notranslate"><span class="pre">EXESReduction.make_flat()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.make_profiles"><code class="docutils literal notranslate"><span class="pre">EXESReduction.make_profiles()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.merge_orders"><code class="docutils literal notranslate"><span class="pre">EXESReduction.merge_orders()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.refine_wavecal"><code class="docutils literal notranslate"><span class="pre">EXESReduction.refine_wavecal()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.register_viewers"><code class="docutils literal notranslate"><span class="pre">EXESReduction.register_viewers()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.set_apertures"><code class="docutils literal notranslate"><span class="pre">EXESReduction.set_apertures()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.set_display_data"><code class="docutils literal notranslate"><span class="pre">EXESReduction.set_display_data()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.specmap"><code class="docutils literal notranslate"><span class="pre">EXESReduction.specmap()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.subtract_background"><code class="docutils literal notranslate"><span class="pre">EXESReduction.subtract_background()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.subtract_nods"><code class="docutils literal notranslate"><span class="pre">EXESReduction.subtract_nods()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.undistort"><code class="docutils literal notranslate"><span class="pre">EXESReduction.undistort()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.update_output"><code class="docutils literal notranslate"><span class="pre">EXESReduction.update_output()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.update_sofia_keys"><code class="docutils literal notranslate"><span class="pre">EXESReduction.update_sofia_keys()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.write_output"><code class="docutils literal notranslate"><span class="pre">EXESReduction.write_output()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.pipeline.sofia.exes_reduction.EXESReduction.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>