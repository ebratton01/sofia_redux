<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>telluric_correct &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="wrap_telluric_correct" href="sofia_redux.instruments.fifi_ls.telluric_correct.wrap_telluric_correct.html" />
    <link rel="prev" title="apply_atran" href="sofia_redux.instruments.fifi_ls.telluric_correct.apply_atran.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.instruments.fifi_ls.telluric_correct.wrap_telluric_correct.html" title="wrap_telluric_correct">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.instruments.fifi_ls.telluric_correct.apply_atran.html" title="apply_atran">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/fifils/developers/developers.html" accesskey="U">FIFI-LS Redux Developer’s Manual</a> &#187;</li>
      
      <li>telluric_correct</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="telluric-correct">
<h1>telluric_correct<a class="headerlink" href="#telluric-correct" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.instruments.fifi_ls.telluric_correct.telluric_correct">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.instruments.fifi_ls.telluric_correct.</span></span><span class="sig-name descname"><span class="pre">telluric_correct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atran_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_wv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/fifi_ls/telluric_correct.html#telluric_correct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.fifi_ls.telluric_correct.telluric_correct" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct spectra for atmospheric absorption features.</p>
<p>The procedure is:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Identify ATRAN file to use.  Smooth it to the spectral
resolution of the input file.</p></li>
<li><p>Interpolate the atmospheric transmission data onto the wavelength
value of each spexel. Divide the data at each point by the
transmission value.</p></li>
<li><p>Create FITS file and (optionally) write results to disk.</p></li>
</ol>
</div></blockquote>
<p>The output FITS file contains FLUX, STDDEV, LAMBDA, XS, YS, RA, and DEC
arrays in the same dimensions as the input. Additionally,
UNCORRECTED_FLUX and UNCORRECTED_STDDEV image extensions are appended,
containing a copy of the input FLUX and STDDEV arrays. An interpolated
ATRAN extension is also appended, matching the dimensions of LAMBDA.
The full unsmoothed transmission data is also appended as an image
extension, in a n_atran x 2 array, for reference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>FITS file to be telluric corrected.  Should have been
generated by fifi_ls.combine_grating_scans.</p>
</dd>
<dt><strong>atran_dir</strong><span class="classifier">str, optional</span></dt><dd><p>Path to a directory containing ATRAN reference FITS files.
If not provided, the default set of files packaged with the
pipeline will be used.</p>
</dd>
<dt><strong>cutoff</strong><span class="classifier">float, optional</span></dt><dd><p>Used as the fractional transmission below which data will
be set to NaN. Set to 0 to keep all data.</p>
</dd>
<dt><strong>use_wv</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, water vapor values from the header will be used
to select the correct ATRAN file.</p>
</dd>
<dt><strong>skip_corr</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, telluric correction will not be applied, but ATRAN
spectra will still be attached to the output file.</p>
</dd>
<dt><strong>write</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, write to disk and return the path to the output
file.  If False, return the HDUL.  The output filename is
created from the input filename, with the suffix ‘SCM’
replaced with ‘TEL’.</p>
</dd>
<dt><strong>outdir</strong><span class="classifier">str, optional</span></dt><dd><p>Directory path to write output.  If None, output files
will be written to the same directory as the input files.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>fits.HDUList or str</dt><dd><p>Either the HDU (if write is False) or the filename of the output file
(if write is True)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">telluric_correct</a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.fifi_ls.telluric_correct.telluric_correct"><code class="docutils literal notranslate"><span class="pre">telluric_correct()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.instruments.fifi_ls.telluric_correct.telluric_correct.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>