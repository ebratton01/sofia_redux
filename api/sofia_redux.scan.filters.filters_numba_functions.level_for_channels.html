<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>level_for_channels &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="level" href="sofia_redux.scan.filters.filters_numba_functions.level.html" />
    <link rel="prev" title="dft_filter_frequency_channel" href="sofia_redux.scan.filters.filters_numba_functions.dft_filter_frequency_channel.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.scan.filters.filters_numba_functions.level.html" title="level">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.scan.filters.filters_numba_functions.dft_filter_frequency_channel.html" title="dft_filter_frequency_channel">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../sofia_redux/scan/index.html" accesskey="U">sofia_redux.scan: Scan Mode Algorithms for SOFIA Pipelines</a> &#187;</li>
      
      <li>level_for_channels</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="level-for-channels">
<h1>level_for_channels<a class="headerlink" href="#level-for-channels" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.scan.filters.filters_numba_functions.level_for_channels">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.scan.filters.filters_numba_functions.</span></span><span class="sig-name descname"><span class="pre">level_for_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeling_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_flag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/filters/filters_numba_functions.html#level_for_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.filters.filters_numba_functions.level_for_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Level a given signal over all frames for the given channel indices.</p>
<p>The resulting operation subtracts the mean for each channel from the frame
data.  The mean is calculated using only valid samples, but is subtracted
from all samples.  If there are no valid samples for a given channel,  its
data will be zeroed.  Valid samples are those that are marked as a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">valid_frame</span></code>, is not a <code class="xref py py-obj docutils literal notranslate"><span class="pre">modeling_frame</span></code>, and has a zero valued
<code class="xref py py-obj docutils literal notranslate"><span class="pre">sample_flag</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>signal</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The signal data to level of shape (n_channels, &gt;=n_frames).  Is updated
in-place.</p>
</dd>
<dt><strong>valid_frame</strong><span class="classifier">numpy.ndarray (bool)</span></dt><dd><p>A boolean mask where <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> excludes a frame from being included in
the average signal calculation.  Should be of shape (n_frames,).</p>
</dd>
<dt><strong>modeling_frame</strong><span class="classifier">numpy.ndarray (bool)</span></dt><dd><p>A boolean mask marking modeling frames with <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.  These frames will
not be included in the average signal calculation.  Should be of shape
(n_frames,).</p>
</dd>
<dt><strong>sample_flag</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The flag mask of shape (n_frames, all_channels) where any nonzero value
will exclude that given channel and frame from being included in the
averaging calculation.</p>
</dd>
<dt><strong>channel_indices</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The channel indices for which <a class="reference external" href="https://docs.python.org/3/library/signal.html#module-signal" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal</span></code></a> is applicable and maps
n_channels onto all_channels.  An array of shape (n_channels,).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">level_for_channels</a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.filters.filters_numba_functions.level_for_channels"><code class="docutils literal notranslate"><span class="pre">level_for_channels()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.scan.filters.filters_numba_functions.level_for_channels.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>