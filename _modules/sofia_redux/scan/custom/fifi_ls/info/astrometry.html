<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sofia_redux.scan.custom.fifi_ls.info.astrometry &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/plot_directive.css" />
    
    <script src="../../../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../../../../../" id="documentation_options" src="../../../../../../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../../../../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../../../../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../../../../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../../../../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sofia_redux.scan.custom.fifi_ls.info.astrometry</h1><div class="highlight"><pre>
<span></span># Licensed under a 3-clause BSD style license - see LICENSE.rst

from astropy import units

from sofia_redux.scan.coordinate_systems.coordinate_2d import Coordinate2D
from sofia_redux.scan.coordinate_systems.equatorial_coordinates import \
    EquatorialCoordinates
from sofia_redux.scan.custom.sofia.info.astrometry import SofiaAstrometryInfo
from sofia_redux.scan.coordinate_systems.epoch.epoch import Epoch

__all__ = [&#39;FifiLsAstrometryInfo&#39;]


degree = units.Unit(&#39;degree&#39;)
arcsec = units.Unit(&#39;arcsec&#39;)


<div class="viewcode-block" id="FifiLsAstrometryInfo"><a class="viewcode-back" href="../../../../../../api/sofia_redux.scan.custom.fifi_ls.info.astrometry.FifiLsAstrometryInfo.html#sofia_redux.scan.custom.fifi_ls.info.astrometry.FifiLsAstrometryInfo">[docs]</a>class FifiLsAstrometryInfo(SofiaAstrometryInfo):

    def __init__(self):
        &quot;&quot;&quot;
        Initialize astrometry information for FIFI-LS observations.

        An extension of the SOFIA astrometry information with additional
        handling for FIFI-LS.
        &quot;&quot;&quot;
        super().__init__()
        self.scan_equatorial = EquatorialCoordinates()
        self.scan_equatorial.set_singular()
        self.scan_equatorial.nan()
        self.delta_map = Coordinate2D(unit=&#39;arcsec&#39;)
        self.delta_map.set_singular()
        self.delta_map.zero()
        self.obs_equatorial = EquatorialCoordinates()
        self.obs_equatorial.set_singular()
        self.obs_equatorial.nan()

<div class="viewcode-block" id="FifiLsAstrometryInfo.apply_configuration"><a class="viewcode-back" href="../../../../../../api/sofia_redux.scan.custom.fifi_ls.info.astrometry.FifiLsAstrometryInfo.html#sofia_redux.scan.custom.fifi_ls.info.astrometry.FifiLsAstrometryInfo.apply_configuration">[docs]</a>    def apply_configuration(self):
        &quot;&quot;&quot;
        Update astrometry information with the FITS header configuration data.

        Returns
        -------
        None
        &quot;&quot;&quot;
        # No object coordinates are available
        super().apply_configuration()
        self.is_nonsidereal = False</div>

<div class="viewcode-block" id="FifiLsAstrometryInfo.parse_astrometry"><a class="viewcode-back" href="../../../../../../api/sofia_redux.scan.custom.fifi_ls.info.astrometry.FifiLsAstrometryInfo.html#sofia_redux.scan.custom.fifi_ls.info.astrometry.FifiLsAstrometryInfo.parse_astrometry">[docs]</a>    def parse_astrometry(self):
        &quot;&quot;&quot;
        Parse and apply coordinate related keywords from the FITS header.

        The following FITS header keywords are used::

          KEY       DESCRIPTION
          --------  -----------
          EQUINOX   The equinox of the observation (year)
          OBSRA     The right-ascension of the observed source (hours)
          OBSDEC    The declination of the observed source (degrees)

        The modified Julian date (MJD) is calculated, and precessions are
        initialized relative to the J2000 equinox.

        Returns
        -------
        None
        &quot;&quot;&quot;
        if self.options is None:
            return
        if &quot;EQUINOX&quot; in self.options:
            self.epoch = Epoch.get_epoch(self.options.get_float(&quot;EQUINOX&quot;))

        scan_ra = self.options.get_hms_time(&#39;OBSRA&#39;, angle=True)
        scan_dec = self.options.get_dms_angle(&#39;OBSDEC&#39;)
        self.requested_equatorial = EquatorialCoordinates(
            [scan_ra, scan_dec], unit=&#39;degree&#39;, epoch=self.epoch)
        self.equatorial = self.requested_equatorial.copy()
        self.scan_equatorial = self.requested_equatorial.copy()

        obs_lambda = self.options.get_float(&#39;OBSLAM&#39;, default=0) * degree
        obs_beta = self.options.get_float(&#39;OBSBET&#39;, default=0) * degree
        self.obs_equatorial = EquatorialCoordinates(
            [obs_lambda, obs_beta], epoch=self.epoch)

        map_lambda = self.options.get_float(&#39;DLAM_MAP&#39;, default=0) * arcsec
        map_beta = self.options.get_float(&#39;DBET_MAP&#39;, default=0) * arcsec
        self.delta_map = Coordinate2D([map_lambda, map_beta])

        self.scan_equatorial.subtract_offset(self.delta_map)

        self.calculate_precessions(self.equatorial.epoch)</div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>