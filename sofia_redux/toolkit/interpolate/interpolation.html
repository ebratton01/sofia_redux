<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Interpolation Schemes &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    
    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Resampling (sofia_redux.toolkit.resampling)" href="../resampling/index.html" />
    <link rel="prev" title="Interpolate (sofia_redux.toolkit.interpolate)" href="index.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="../resampling/index.html" title="Resampling (sofia_redux.toolkit.resampling)">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="index.html" title="Interpolate (sofia_redux.toolkit.interpolate)">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../../index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../index.html" >sofia_redux.toolkit: Shared Utilities for SOFIA Pipelines</a> &#187;</li>
      <li><a href="index.html" accesskey="U">Interpolate (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.toolkit.interpolate</span></code>)</a> &#187;</li>
      
      <li>Interpolation Schemes</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p><a class="reference internal" href="../index.html#module-sofia_redux.toolkit.interpolate.interpolate" title="sofia_redux.toolkit.interpolate.interpolate"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sofia_redux.toolkit.interpolate.interpolate</span></code></a> contains algorithms allowing
interpolation from a regular grid in N-dimensions along with error propagation,
and 1-dimensional functions for spline, sinc, and domain interpolation.
Many algorithms were inspired by, or expanded upon, base IDL functions that
were extremely useful, but never fully implemented in the major Python
libraries.</p>
<p>The <a class="reference internal" href="../../../api/sofia_redux.toolkit.interpolate.interpolate.Interpolate.html#sofia_redux.toolkit.interpolate.interpolate.Interpolate" title="sofia_redux.toolkit.interpolate.interpolate.Interpolate"><code class="xref py py-class docutils literal notranslate"><span class="pre">Interpolate</span></code></a> class allows interpolation of values from those
supplied on a regular grid.  Interpolants are derived from N-dimensional
grids of samples, optionally supplied with 1-dimensional ordinates for each
dimension.  NaNs may be ignored or propagated as desired.</p>
<section id="interpolation-schemes">
<h1>Interpolation Schemes<a class="headerlink" href="#interpolation-schemes" title="Permalink to this heading">¶</a></h1>
<p>Currently there are three interpolation schemes: linear, nearest neighbor and
cubic.  Linear interpolation is achieved by taking the weighted average of the
two neighboring points for each interpolant over each dimension using the
following weights:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\begin{eqnarray}
w_0 &amp; = \frac{x - x_0}{x_1 - x_0} \\
w_1 &amp; = \frac{x_1 - x}{x_1 - x_0}
\end{eqnarray}</div></div></blockquote>
<p>Cubic interpolation is achieved by applying a convolution operator
across each dimension using the following kernel:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}W(x) = \begin{cases}
 (a+2)|x|^3-(a+3)|x|^2+1 &amp; \text{for } |x| \leq 1, \\
 a|x|^3-5a|x|^2+8a|x|-4a &amp; \text{for } 1 &lt; |x| &lt; 2, \\
 0                       &amp; \text{otherwise},
\end{cases}\end{split}\]</div>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is usually set to -0.5 (default) or -0.75.  Setting
<span class="math notranslate nohighlight">\(a = -0.5\)</span> produces third-order convergence with respect to the sampling
interval of the original grid.  Note that accurate interpolation requires that each
interpolant is bounded by samples in each dimension such that there are two
samples to the “left” and “right”, i.e., 4 samples per dimension.</p>
<p>The following plot shows nearest neighbor, linear, and cubic interpolation
(left to right) interpolating from a coarse regular grid to a finer
resolution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">sofia_redux.toolkit.interpolate.interpolate</span> <span class="kn">import</span> <span class="n">Interpolate</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">zz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">xx</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">yy</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                       <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;3d&#39;</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">xout</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">yout</span> <span class="o">=</span> <span class="n">xout</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">xxout</span><span class="p">,</span> <span class="n">yyout</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xout</span><span class="p">,</span> <span class="n">yout</span><span class="p">)</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;nipy_spectral&#39;</span>

<span class="n">interpolator</span> <span class="o">=</span> <span class="n">Interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">z_nearest</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">xxout</span><span class="p">,</span> <span class="n">yyout</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Nearest&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">xxout</span><span class="p">,</span> <span class="n">yyout</span><span class="p">,</span> <span class="n">z_nearest</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                   <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">interpolator</span> <span class="o">=</span> <span class="n">Interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">z_linear</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">xxout</span><span class="p">,</span> <span class="n">yyout</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Linear&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">xxout</span><span class="p">,</span> <span class="n">yyout</span><span class="p">,</span> <span class="n">z_linear</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                   <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">interpolator</span> <span class="o">=</span> <span class="n">Interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="n">z_cubic</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">xxout</span><span class="p">,</span> <span class="n">yyout</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Cubic&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">xxout</span><span class="p">,</span> <span class="n">yyout</span><span class="p">,</span> <span class="n">z_cubic</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                   <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/f0eaa5f0b2f1e9f59d4dbf8b2a3dc680/interpolation-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/5e32e6999dc6be38871917bc2b02f7ac/interpolation-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/e3fe8ee01609ad9f30b876fd4fc4a521/interpolation-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/96ac516527f7c0a07327abf201f41beb/interpolation-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/interpolation-1.png" class="plot-directive" src="../../../_images/interpolation-1.png" />
</figure>
</section>
<section id="edge-effects">
<h1>Edge effects<a class="headerlink" href="#edge-effects" title="Permalink to this heading">¶</a></h1>
<p>Accurate interpolation requires 4 samples for cubic interpolation and 2 samples
for linear interpolation bounding each interpolant per dimension.  This
requirement cannot be met for interpolants close to the edge of the grid, so
in these cases, the grid is effectively padded with values to allow an
approximation to be calculated.  The “mode” keyword determines the method by
which this is accomplished.  Available methods are:</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Mode</p></th>
<th class="head"><p>Left pad</p></th>
<th class="head"><p>Samples</p></th>
<th class="head"><p>Right pad</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>nearest</p></td>
<td><p>1 1 1 1</p></td>
<td><p>1 2 3 4</p></td>
<td><p>4 4 4 4</p></td>
</tr>
<tr class="row-odd"><td><p>reflect</p></td>
<td><p>4 3 2 1</p></td>
<td><p>1 2 3 4</p></td>
<td><p>4 3 2 1</p></td>
</tr>
<tr class="row-even"><td><p>mirror</p></td>
<td><p>4 3 2</p></td>
<td><p>1 2 3 4</p></td>
<td><p>3 2 1</p></td>
</tr>
<tr class="row-odd"><td><p>wrap</p></td>
<td><p>1 2 3 4</p></td>
<td><p>1 2 3 4</p></td>
<td><p>1 2 3 4</p></td>
</tr>
<tr class="row-even"><td><p>constant</p></td>
<td><p>x x x x</p></td>
<td><p>1 2 3 4</p></td>
<td><p>x x x x</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Where numbers represent sample value indices in a single dimension and x
indicates a user supplied value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">cval</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sofia_redux.toolkit.interpolate</span> <span class="kn">import</span> <span class="n">Interpolate</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>

<span class="n">interpolator</span> <span class="o">=</span> <span class="n">Interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">y_nearest</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>

<span class="n">interpolator</span> <span class="o">=</span> <span class="n">Interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">cval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_constant</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>

<span class="n">interpolator</span> <span class="o">=</span> <span class="n">Interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;wrap&#39;</span><span class="p">)</span>
<span class="n">y_wrap</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Edge Modes&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y_nearest</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y_constant</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;constant=1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y_wrap</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;wrap&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/b40b4ec42d88cfa42be80e7d87a65054/interpolation-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/ca0faf30835f8a3015593cacbed78516/interpolation-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/e76d378fadcd5552dccbbe46f0842a29/interpolation-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/88d290166e4dc8ec579011cbf98608fa/interpolation-2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/interpolation-2.png" class="plot-directive" src="../../../_images/interpolation-2.png" />
</figure>
<p>The above plot gives a basic idea on how edge effects can manifest and
the influence of the edge “mode”.  Cubic interpolation is used as it is most
sensitive to any edge effects.  The edge shown is at <span class="math notranslate nohighlight">\(x &lt; 0\)</span>, outside
the sample domain, which clearly has an affect on interpolants where
<span class="math notranslate nohighlight">\(x &lt; 1\)</span>.  Here, the “nearest” edge mode best represents the actual
samples, while the “wrap” mode provides a poor fit as missing values were
replaced with those from the other end of the sample array.</p>
</section>
<section id="linear-interpolation-error-propagation">
<h1>Linear Interpolation Error Propagation<a class="headerlink" href="#linear-interpolation-error-propagation" title="Permalink to this heading">¶</a></h1>
<p>If using linear interpolation in 1-dimension or Delaunay triangulation in
N-dimensions, errors may be propagated using the function <a class="reference internal" href="../../../api/sofia_redux.toolkit.interpolate.interpolate.interp_error.html#sofia_redux.toolkit.interpolate.interpolate.interp_error" title="sofia_redux.toolkit.interpolate.interpolate.interp_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">interp_error()</span></code></a>
in N-dimensions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sofia_redux.toolkit.interpolate</span> <span class="kn">import</span> <span class="n">interp_error</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">points_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">301</span><span class="p">)</span>
<span class="n">i_error_1d</span> <span class="o">=</span> <span class="n">interp_error</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">points_out</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points_out</span><span class="p">,</span> <span class="n">i_error_1d</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;1-D Linear Interpolation Error&quot;</span><span class="p">)</span>

<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span><span class="o">.</span><span class="n">T</span>
<span class="n">xg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">points_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">xg</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
<span class="n">i_error</span> <span class="o">=</span> <span class="n">interp_error</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">points_out</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">i_error</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Delaunay triangulation error inside single grid cell&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/93f4fd125b6042ca79fe3a3ea0437ce4/interpolation-3.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/be7b04d393a2be3285330db51f98426c/interpolation-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/08e104c51995718ac57402dae8d118c8/interpolation-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/e0b784db4cbdf8546178d78e7c258195/interpolation-3.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/interpolation-3.png" class="plot-directive" src="../../../_images/interpolation-3.png" />
</figure>
</section>
<section id="sinc-interpolation">
<h1>Sinc Interpolation<a class="headerlink" href="#sinc-interpolation" title="Permalink to this heading">¶</a></h1>
<p>1-dimensional sinc interpolation is available using the <a class="reference internal" href="../../../api/sofia_redux.toolkit.interpolate.interpolate.sincinterp.html#sofia_redux.toolkit.interpolate.interpolate.sincinterp" title="sofia_redux.toolkit.interpolate.interpolate.sincinterp"><code class="xref py py-func docutils literal notranslate"><span class="pre">sincinterp()</span></code></a>
function.  The actual function uses modified sinc interpolation such that</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\begin{eqnarray}
y(t) &amp; = &amp; \sum_{i = i_{t} - N/2}^{i_{t} + N/2}{
y_{i} . sinc(x(t_{i})) .
exp \left\{ \left( \frac{x(t_{i})}{\alpha} \right)^{2} \right\}
} \\
i_{t} &amp; = &amp; max(i \, | \, x_{i} \leq x(t)) \\
x(t_{i}) &amp; = &amp; \frac{x(t) - x_{i_{t}}}{x_{i_{t} + 1} - x_{i_{t}}} + i \\
\end{eqnarray}</div></div></blockquote>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is the dampening factor (default = 3.25) and may be
disabled by setting <span class="math notranslate nohighlight">\(\alpha=0\)</span>.  Note that the sampling interval is
determined by the kernel width <span class="math notranslate nohighlight">\(N\)</span> (default = 21) and is dependant on the
distribution of the samples themselves, rather than being explicitly set by the
user.  This modified version of the function allows for better handling of
non-periodic band-limited functions, irregular data, and NaN handling.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sofia_redux.toolkit.interpolate</span> <span class="kn">import</span> <span class="n">sincinterp</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span>
<span class="n">xout</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">yout</span> <span class="o">=</span> <span class="n">sincinterp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xout</span><span class="p">)</span>
<span class="n">truth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">xout</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">scipy_try</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">xout</span><span class="p">,</span> <span class="n">yout</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
         <span class="n">xout</span><span class="p">,</span> <span class="n">truth</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">xout</span><span class="p">,</span> <span class="n">scipy_try</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;sincinterp&#39;</span><span class="p">,</span> <span class="s1">&#39;truth&#39;</span><span class="p">,</span> <span class="s1">&#39;scipy&#39;</span><span class="p">],</span>
           <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sinc Upsampling&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/e933cacd3c5331f48a0c13054dd9f2e8/interpolation-4.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/a80735f99efd92150ac01731d1cbf641/interpolation-4.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/7c649a9dae0abd769d7fecb88874b0ab/interpolation-4.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/ce6c482fe24aab41de35501f7888ae19/interpolation-4.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/interpolation-4.png" class="plot-directive" src="../../../_images/interpolation-4.png" />
</figure>
<p>The above plot shows a comparison of <a class="reference internal" href="../../../api/sofia_redux.toolkit.interpolate.interpolate.sincinterp.html#sofia_redux.toolkit.interpolate.interpolate.sincinterp" title="sofia_redux.toolkit.interpolate.interpolate.sincinterp"><code class="xref py py-func docutils literal notranslate"><span class="pre">sincinterp()</span></code></a> with
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.resample.html#scipy.signal.resample" title="(in SciPy v1.11.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.resample()</span></code></a>.  <a class="reference internal" href="../../../api/sofia_redux.toolkit.interpolate.interpolate.sincinterp.html#sofia_redux.toolkit.interpolate.interpolate.sincinterp" title="sofia_redux.toolkit.interpolate.interpolate.sincinterp"><code class="xref py py-func docutils literal notranslate"><span class="pre">sincinterp()</span></code></a> provides a very close fit
to the actual truth, while the FFT sinc interpolation method used by
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.resample.html#scipy.signal.resample" title="(in SciPy v1.11.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.resample()</span></code></a> shows an obvious deviation due to the assumption
of a periodic function.</p>
</section>
<section id="tensioned-spline-interpolation">
<h1>Tensioned Spline Interpolation<a class="headerlink" href="#tensioned-spline-interpolation" title="Permalink to this heading">¶</a></h1>
<p>The <a class="reference internal" href="../../../api/sofia_redux.toolkit.interpolate.interpolate.spline.html#sofia_redux.toolkit.interpolate.interpolate.spline" title="sofia_redux.toolkit.interpolate.interpolate.spline"><code class="xref py py-func docutils literal notranslate"><span class="pre">spline()</span></code></a> function performs tensioned cubic spline interpolation,
recreating the functionality of the IDL spline function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sofia_redux.toolkit.interpolate</span> <span class="kn">import</span> <span class="n">spline</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">x</span>

<span class="n">tensions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">xout</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">fits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">tensions</span><span class="p">),</span> <span class="n">xout</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tensions</span><span class="p">):</span>
    <span class="n">fits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xout</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tensions</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xout</span><span class="p">,</span> <span class="n">fits</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Tensioned Splines&quot;</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Samples&#39;</span><span class="p">]</span>
<span class="n">legend</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;sigma = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">tensions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tensions</span><span class="p">))]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/6ff580666b81597e38a3157d09690fd9/interpolation-5.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/f8063c5142cc02b2323d5b46a28ef21f/interpolation-5.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/de3052a8a6b56d304013499186b35b49/interpolation-5.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/1d93b65488e5166984c2738dea69b6e0/interpolation-5.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/interpolation-5.png" class="plot-directive" src="../../../_images/interpolation-5.png" />
</figure>
<p>The above plot shows the effect of tension (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma</span></code>) on the spline fit. For
low tension, it is effectively a cubic spline fit.  For higher tensions, the
fit is closer to polynomial interpolation.</p>
</section>
<section id="domain-interpolation">
<h1>Domain Interpolation<a class="headerlink" href="#domain-interpolation" title="Permalink to this heading">¶</a></h1>
<p><a class="reference internal" href="../../../api/sofia_redux.toolkit.interpolate.interpolate.tabinv.html#sofia_redux.toolkit.interpolate.interpolate.tabinv" title="sofia_redux.toolkit.interpolate.interpolate.tabinv"><code class="xref py py-func docutils literal notranslate"><span class="pre">tabinv()</span></code></a> is used to find the effective index of a function value in an
ordered 1-dimensional vector using linear interpolation.  The function in
question should be monotonically increasing or decreasing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sofia_redux.toolkit.interpolate</span> <span class="kn">import</span> <span class="n">tabinv</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">tabinv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">==</span> <span class="mf">2.5</span>
<span class="k">assert</span> <span class="n">tabinv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.25</span><span class="p">)</span> <span class="o">==</span> <span class="mf">5.25</span>
</pre></div>
</div>
<p>A binary search is used to find the values x[i] and x[i+1] where:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[i_{t} = \frac{x(t) - x_{i}}{x_{i + 1} - x_{i}} + i\]</div>
</div></blockquote>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Interpolation Schemes</a></li>
<li><a class="reference internal" href="#edge-effects">Edge effects</a></li>
<li><a class="reference internal" href="#linear-interpolation-error-propagation">Linear Interpolation Error Propagation</a></li>
<li><a class="reference internal" href="#sinc-interpolation">Sinc Interpolation</a></li>
<li><a class="reference internal" href="#tensioned-spline-interpolation">Tensioned Spline Interpolation</a></li>
<li><a class="reference internal" href="#domain-interpolation">Domain Interpolation</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../../_sources/sofia_redux/toolkit/interpolate/interpolation.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>