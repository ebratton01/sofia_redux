<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Usage &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    
    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="icon" href="../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Configuration" href="scan_configuration.html" />
    <link rel="prev" title="Main Classes" href="scan_architecture.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="scan_configuration.html" title="Configuration">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="scan_architecture.html" title="Main Classes">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="index.html" accesskey="U">sofia_redux.scan: Scan Mode Algorithms for SOFIA Pipelines</a> &#187;</li>
      
      <li>Usage</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">Â¶</a></h1>
<p>The scan package can perform reductions from the Python command line
interface using the
<a class="reference internal" href="../../api/sofia_redux.scan.reduction.reduction.Reduction.html#sofia_redux.scan.reduction.reduction.Reduction" title="sofia_redux.scan.reduction.reduction.Reduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reduction</span></code></a> object.
Each object must be initialized with the name of the observing instrument.
The reduction must then be run on one or more input files using the
<a class="reference internal" href="../../api/sofia_redux.scan.reduction.reduction.Reduction.html#sofia_redux.scan.reduction.reduction.Reduction.run" title="sofia_redux.scan.reduction.reduction.Reduction.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Reduction.run()</span></code></a>
method.</p>
<p>The following example using the <code class="xref py py-mod docutils literal notranslate"><span class="pre">example</span></code> instrument to create a
simulated FITS file and perform a simple reduction.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sofia_redux.scan.reduction.reduction</span> <span class="kn">import</span> <span class="n">Reduction</span>

<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.wcs</span> <span class="kn">import</span> <span class="n">WCS</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">astropy_mpl_style</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">astropy_mpl_style</span><span class="p">)</span>

<span class="n">work_path</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;scan_example&#39;</span><span class="p">)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">work_path</span><span class="p">,</span> <span class="s1">&#39;simulated_data.fits&#39;</span><span class="p">)</span>

<span class="c1"># Initialize the reduction for the example instrument</span>
<span class="n">reduction</span> <span class="o">=</span> <span class="n">Reduction</span><span class="p">(</span><span class="s1">&#39;example&#39;</span><span class="p">)</span>

<span class="c1"># Create a simulated data file</span>
<span class="n">reduction</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">write_simulated_hdul</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span> <span class="n">scan_type</span><span class="o">=</span><span class="s1">&#39;daisy&#39;</span><span class="p">,</span>
    <span class="n">n_oscillations</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">radial_period</span><span class="o">=</span><span class="mi">12</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">second</span><span class="p">,</span>
    <span class="n">ra</span><span class="o">=</span><span class="s1">&#39;17h45m39.60213s&#39;</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="s1">&#39;-29d00m22.0000s&#39;</span><span class="p">,</span>
    <span class="n">source_type</span><span class="o">=</span><span class="s1">&#39;single_gaussian&#39;</span><span class="p">,</span> <span class="n">constant_speed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">s2n</span><span class="o">=</span><span class="mf">30.0</span><span class="p">)</span>

<span class="c1"># Perform the reduction</span>
<span class="n">hdul</span> <span class="o">=</span> <span class="n">reduction</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="n">work_path</span><span class="p">,</span>
                     <span class="n">blacklist</span><span class="o">=</span><span class="s1">&#39;correlated.bias&#39;</span><span class="p">)</span>

<span class="c1"># Display the results</span>
<span class="c1"># The contents of the output FITS file and the hdul above are identical.</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">work_path</span><span class="p">,</span> <span class="s1">&#39;Simulation.Simulation.1.fits&#39;</span><span class="p">)</span>
<span class="n">image_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Right Ascension&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Declination&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/1e6757115d5230df3927bea687e99a7b/scan_usage-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/82572d816d4d0469c14512d7df3a95ac/scan_usage-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/1d4412324c06fde34af0f9800b84ba66/scan_usage-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/23f73f76b8a7339f87db0525a0e5d1a6/scan_usage-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/scan_usage-1.png" class="plot-directive" src="../../_images/scan_usage-1.png" />
</figure>
<p>The exact nature of the reduction depends heavily on the
<a class="reference internal" href="scan_configuration.html#scan-configuration"><span class="std std-ref">configuration</span></a> which may be read from default
files, or passed in as optional keyword arguments.  The keys and values
should correspond to those listed in the <a class="reference internal" href="scan_configuration.html#scan-glossary"><span class="std std-ref">glossary</span></a>.
A nested dictionary may be directly passed in, and/or a flattened dot
separated set of options may also be supplied.  For example, all of the
reductions below will run using the same configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">reduction</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">correlated</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sky&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gainrange&#39;</span><span class="p">:</span> <span class="s1">&#39;0.1:1&#39;</span><span class="p">}},</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">reduction</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">correlated</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sky.gainrange&#39;</span><span class="p">:</span> <span class="s1">&#39;0.1:1&#39;</span><span class="p">},</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">reduction</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;correlated.sky.gainrange&#39;</span><span class="p">:</span> <span class="s1">&#39;0.1:1&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;deep&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>Note that configuration options passed in this way will remain locked by
default for the remainder of the reduction.  For more flexible options, please
consider creating a separate configuration file.</p>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Usage</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../_sources/sofia_redux/scan/scan_usage.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>