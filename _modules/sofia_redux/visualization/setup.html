<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sofia_redux.visualization.setup &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    
    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sofia_redux.visualization.setup</h1><div class="highlight"><pre>
<span></span># Licensed under a 3-clause BSD style license - see LICENSE.rst

from logging import FileHandler

from sofia_redux.visualization import log
from sofia_redux.visualization.utils.logger \
    import StatusLogger, DialogLogger, StreamLogger

__all__ = [&#39;Setup&#39;]


<div class="viewcode-block" id="Setup"><a class="viewcode-back" href="../../../api/sofia_redux.visualization.setup.Setup.html#sofia_redux.visualization.setup.Setup">[docs]</a>class Setup(object):
    &quot;&quot;&quot;
    Setup GUI controls and callbacks.
    &quot;&quot;&quot;

    def __init__(self, parent):
        &quot;&quot;&quot;Initialize GUI setup.&quot;&quot;&quot;
        self.parent = parent
        self.view = parent.view

<div class="viewcode-block" id="Setup.setup_all"><a class="viewcode-back" href="../../../api/sofia_redux.visualization.setup.Setup.html#sofia_redux.visualization.setup.Setup.setup_all">[docs]</a>    def setup_all(self):
        &quot;&quot;&quot;Call all setup actions.&quot;&quot;&quot;
        self.setup_menu_bar()
        self.setup_controls()
        self.setup_line_controls()
        self.setup_model_controls()
        self.setup_order_controls()
        self.setup_mouse_events()
        self.setup_signals()
        self.setup_messages()</div>

<div class="viewcode-block" id="Setup.setup_menu_bar"><a class="viewcode-back" href="../../../api/sofia_redux.visualization.setup.Setup.html#sofia_redux.visualization.setup.Setup.setup_menu_bar">[docs]</a>    def setup_menu_bar(self):
        &quot;&quot;&quot;Connect menu bar to callbacks.&quot;&quot;&quot;
        # menu bar is still TBD
        self.view.menubar.hide()</div>

<div class="viewcode-block" id="Setup.setup_controls"><a class="viewcode-back" href="../../../api/sofia_redux.visualization.setup.Setup.html#sofia_redux.visualization.setup.Setup.setup_controls">[docs]</a>    def setup_controls(self):
        &quot;&quot;&quot;Connect control panel events to callbacks.&quot;&quot;&quot;
        # default: hide a couple control panels
        # self.view.order_panel.hide()
        self.view.axis_panel.hide()
        self.view.plot_panel.hide()
        self.view.analysis_panel.hide()

        # order panel has TBD functionality; hide it for now
        # self.view.order_panel_frame.hide()

        # connect signals
        # self.view.hightlight_pane_checkbox.toggled.connect(
        #     self.view.toggle_pane_highlight)

        self.view.x_property_selector.activated.connect(self.view.set_field)
        self.view.y_property_selector.activated.connect(self.view.set_field)
        self.view.x_unit_selector.activated.connect(self.view.set_unit)
        self.view.y_unit_selector.activated.connect(self.view.set_unit)
        self.view.x_scale_linear_button.toggled.connect(self.view.set_scale)
        self.view.y_scale_linear_button.toggled.connect(self.view.set_scale)
        self.view.x_scale_log_button.toggled.connect(self.view.set_scale)
        self.view.y_scale_log_button.toggled.connect(self.view.set_scale)
        self.view.x_limit_min.editingFinished.connect(self.view.set_limits)
        self.view.x_limit_max.editingFinished.connect(self.view.set_limits)
        self.view.y_limit_min.editingFinished.connect(self.view.set_limits)
        self.view.y_limit_max.editingFinished.connect(self.view.set_limits)
        self.view.enable_overplot_checkbox.toggled.connect(
            self.view.toggle_overplot)
        self.view.axes_selector.currentIndexChanged.connect(
            self.view.update_controls)

        # zoom controls
        self.view.x_zoom_button.clicked.connect(
            lambda: self.view.start_selection(&#39;x_zoom&#39;))
        self.view.y_zoom_button.clicked.connect(
            lambda: self.view.start_selection(&#39;y_zoom&#39;))
        self.view.box_zoom_button.clicked.connect(
            lambda: self.view.start_selection(&#39;b_zoom&#39;))
        self.view.reset_zoom_button.clicked.connect(
            self.view.reset_zoom)

        # panel collapsing
        self.view.collapse_controls_button.clicked.connect(
            self.view.toggle_controls)
        self.view.collapse_cursor_button.clicked.connect(
            self.view.toggle_cursor)
        self.view.collapse_file_choice_button.clicked.connect(
            self.view.toggle_file_panel)
        self.view.collapse_order_button.clicked.connect(
            self.view.toggle_order_panel)
        self.view.collapse_axis_button.clicked.connect(
            self.view.toggle_axis_panel)
        self.view.collapse_plot_button.clicked.connect(
            self.view.toggle_plot_panel)
        self.view.collapse_analysis_button.clicked.connect(
            self.view.toggle_analysis_panel)

        # cursor enabling
        self.view.cursor_checkbox.clicked.connect(
            self.view.enable_cursor_position)
        self.view.cursor_popout_button.clicked.connect(
            self.view.popout_cursor_position)

        # analysis
        self.view.open_fit_results_button.clicked.connect(
            self.view.open_fits_results)
        self.view.open_ref_data_button.clicked.connect(
            self.view.open_ref_data)</div>

<div class="viewcode-block" id="Setup.setup_line_controls"><a class="viewcode-back" href="../../../api/sofia_redux.visualization.setup.Setup.html#sofia_redux.visualization.setup.Setup.setup_line_controls">[docs]</a>    def setup_line_controls(self):
        &quot;&quot;&quot;Connect control panel to plot callbacks.&quot;&quot;&quot;
        # pane controls
        self.view.add_pane_button.clicked.connect(self.view.add_pane)
        self.view.remove_pane_button.clicked.connect(self.view.remove_pane)

        # plot controls
        self.view.color_cycle_selector.currentTextChanged.connect(
            self.view.select_color_cycle)
        self.view.plot_type_selector.currentTextChanged.connect(
            self.view.select_plot_type)
        self.view.marker_checkbox.toggled.connect(
            self.view.toggle_markers)
        self.view.grid_checkbox.toggled.connect(
            self.view.toggle_grid)
        self.view.error_checkbox.toggled.connect(
            self.view.toggle_error)
        self.view.dark_mode_checkbox.toggled.connect(
            self.view.toggle_dark_mode)</div>

<div class="viewcode-block" id="Setup.setup_model_controls"><a class="viewcode-back" href="../../../api/sofia_redux.visualization.setup.Setup.html#sofia_redux.visualization.setup.Setup.setup_model_controls">[docs]</a>    def setup_model_controls(self):
        &quot;&quot;&quot;Connect control panel to model callbacks.&quot;&quot;&quot;
        self.view.add_file_button.clicked.connect(self.parent.add_data)
        self.view.remove_file_button.clicked.connect(self.parent.remove_data)</div>

<div class="viewcode-block" id="Setup.setup_order_controls"><a class="viewcode-back" href="../../../api/sofia_redux.visualization.setup.Setup.html#sofia_redux.visualization.setup.Setup.setup_order_controls">[docs]</a>    def setup_order_controls(self):
        &quot;&quot;&quot;Connect order controls to view callbacks.&quot;&quot;&quot;
        self.view.pane_selector.currentIndexChanged.connect(
            self.view.pane_order_selector_changed)
        self.view.all_panes_checkbox.stateChanged.connect(
            self.view.all_panes_checking)

        self.view.all_filenames_checkbox.stateChanged.connect(
            self.view.all_filenames_selection_changed)

        self.view.on_orders_selector.returnPressed.connect(
            self.view.on_orders_changed)
        self.view.all_enabled_orders_button.clicked.connect(
            self.view.enable_all_orders)

        self.view.off_orders_selector.returnPressed.connect(
            self.view.off_orders_changed)
        self.view.all_disabled_orders_button.clicked.connect(
            self.view.disable_all_orders)

        self.view.remove_file_from_pane_button.clicked.connect(
            self.view.remove_file_from_pane)</div>

<div class="viewcode-block" id="Setup.setup_mouse_events"><a class="viewcode-back" href="../../../api/sofia_redux.visualization.setup.Setup.html#sofia_redux.visualization.setup.Setup.setup_mouse_events">[docs]</a>    def setup_mouse_events(self):
        &quot;&quot;&quot;Connect mouse events to callbacks.&quot;&quot;&quot;
        self.view.loaded_files_table.itemDoubleClicked.connect(
            self.parent.display_selected_model)
        self.view.figure_widget.canvas.mpl_connect(
            &#39;button_press_event&#39;, self.view.figure_clicked)</div>

<div class="viewcode-block" id="Setup.setup_signals"><a class="viewcode-back" href="../../../api/sofia_redux.visualization.setup.Setup.html#sofia_redux.visualization.setup.Setup.setup_signals">[docs]</a>    def setup_signals(self):
        &quot;&quot;&quot;Connect signals to callbacks.&quot;&quot;&quot;
        self.view.signals.atrophy.connect(self.view.atrophy)
        self.view.signals.atrophy_controls.connect(self.view.atrophy_controls)
        self.view.signals.atrophy_bg_full.connect(
            self.view.atrophy_background_full)
        self.view.signals.atrophy_bg_partial.connect(
            self.view.atrophy_background_partial)
        # self.view.signals.refresh_order_list.connect(
        #     self.view.refresh_order_list)
        self.view.signals.on_orders_changed.connect(
            self.view.on_orders_changed)
        self.view.signals.off_orders_changed.connect(
            self.view.off_orders_changed)

        self.view.signals.axis_limits_changed.connect(
            self.view.axis_limits_changed)
        self.view.signals.axis_scale_changed.connect(
            self.view.axis_scale_changed)
        self.view.signals.axis_unit_changed.connect(
            self.view.axis_unit_changed)
        self.view.signals.axis_field_changed.connect(
            self.view.axis_field_changed)
        self.view.filename_table.cellClicked.connect(
            self.view.filename_table_selection_changed)

        self.view.signals.current_pane_changed.connect(
            self.view.current_pane_changed)
        self.view.signals.model_selected.connect(
            self.parent.display_selected_model)
        self.view.signals.model_removed.connect(
            self.parent.remove_data)
        self.view.signals.end_zoom_mode.connect(
            self.view.clear_selection)
        self.view.signals.end_cursor_recording.connect(
            self.view.end_selection)
        self.view.signals.clear_fit.connect(self.view.clear_fit)
        self.view.signals.toggle_fit_visibility.connect(
            self.view.toggle_fit_visibility)
        self.view.signals.update_reference_lines.connect(
            self.view.update_reference_lines)
        self.view.signals.unload_reference_model.connect(
            self.view.unload_reference_model)
        self.view.signals.obtain_raw_model.connect(
            self.parent.get_model_backup)</div>

<div class="viewcode-block" id="Setup.setup_messages"><a class="viewcode-back" href="../../../api/sofia_redux.visualization.setup.Setup.html#sofia_redux.visualization.setup.Setup.setup_messages">[docs]</a>    def setup_messages(self):
        &quot;&quot;&quot;Add filters to pass log messages to GUI handlers.&quot;&quot;&quot;

        # make sure terminal matches parent setting;
        # remove any old GUI or file handlers
        for hand in log.handlers:
            if isinstance(hand, StreamLogger):
                try:
                    hand.setLevel(self.parent.log_level)
                except ValueError:  # pragma: no cover
                    pass
            elif (isinstance(hand, StatusLogger)
                    or isinstance(hand, DialogLogger)
                    or isinstance(hand, FileHandler)):
                log.removeHandler(hand)

        # INFO goes to status bar
        logger = StatusLogger(self.view.statusbar)
        logger.setLevel(&#39;INFO&#39;)
        log.addHandler(logger)

        # WARNING/ERROR goes to dialog box
        logger = DialogLogger(self.view)
        logger.setLevel(&#39;WARNING&#39;)
        log.addHandler(logger)</div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>