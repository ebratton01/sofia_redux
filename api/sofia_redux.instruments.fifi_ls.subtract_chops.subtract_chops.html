<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>subtract_chops &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="wrap_subtract_chops" href="sofia_redux.instruments.fifi_ls.subtract_chops.wrap_subtract_chops.html" />
    <link rel="prev" title="subtract_extensions" href="sofia_redux.instruments.fifi_ls.subtract_chops.subtract_extensions.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.instruments.fifi_ls.subtract_chops.wrap_subtract_chops.html" title="wrap_subtract_chops">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.instruments.fifi_ls.subtract_chops.subtract_extensions.html" title="subtract_extensions">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/fifils/developers/developers.html" accesskey="U">FIFI-LS Redux Developer’s Manual</a> &#187;</li>
      
      <li>subtract_chops</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="subtract-chops">
<h1>subtract_chops<a class="headerlink" href="#subtract-chops" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.instruments.fifi_ls.subtract_chops.subtract_chops">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.instruments.fifi_ls.subtract_chops.</span></span><span class="sig-name descname"><span class="pre">subtract_chops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chop0_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/fifi_ls/subtract_chops.html#subtract_chops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.fifi_ls.subtract_chops.subtract_chops" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract chops of ramp-fitted data.</p>
<p>One HDUL/file is created for a chop pair, containing n_scan
binary table extensions, each containing DATA and STDDEV data
cubes of shape (18, 5, 5).  The output filename is created
from the input filename with the suffix ‘RP0’ replaced with
‘CSB’.</p>
<p>The procedure is:</p>
<blockquote>
<div><ol class="arabic">
<li><p>Check chop amplitude: if zero, assume observation was taken
in no-chop mode and return without subtracting chops</p></li>
<li><p>Identify chop 1 file corresponding to input chop 0 file and
read both from disk.</p></li>
<li><p>For each extension, subtract OFF data from ON data.</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>symmetric mode: For A nods, chop 1 is subtracted from
chop 0.  For B nods, chop 0 is subtracted from chop 1.
This should result in positive source flux in the
resulting output, whether nod A or B, so that files can
be simply added in the nod-combination algorithm.</p></li>
<li><p>asymmetric mode: chop 0 is subtracted from chop 1,
regardless of nod position.  Sky files are subtracted
from sources files in the nod-combination algorithm.</p></li>
</ol>
</div></blockquote>
</li>
<li><p>Propagate the error as the square root of the sum of the
input variances.</p></li>
<li><p>(optional) Create FITS file and write to disk.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chop0_file</strong><span class="classifier">str</span></dt><dd><p>File path to the chop 0 file (<em>RP0</em>.fits).  The chop 1
file is assumed to have the same root and directory
location, with the designator RP1 in place of RP0.</p>
</dd>
<dt><strong>outdir</strong><span class="classifier">str, optional</span></dt><dd><p>Directory path to write output.  If None, output files
will be written to the same directory as the input files.</p>
</dd>
<dt><strong>add_only</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, chop files will be added rather than subtracted.
This is intended to be used for flat files only.</p>
</dd>
<dt><strong>write</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, write to disk and return the path to the output
file.  If False, return the HDUL.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>fits.HDUList or str</dt><dd><p>Either the HDU (if write is False) or the filename of the output file
(if write is True)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">subtract_chops</a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.fifi_ls.subtract_chops.subtract_chops"><code class="docutils literal notranslate"><span class="pre">subtract_chops()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.instruments.fifi_ls.subtract_chops.subtract_chops.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>