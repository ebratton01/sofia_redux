<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>resample &#8212; sofia_redux v1.3.4.dev0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=602f4d50"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="perform_scan_reduction" href="sofia_redux.instruments.fifi_ls.resample.perform_scan_reduction.html" />
    <link rel="prev" title="make_hdul" href="sofia_redux.instruments.fifi_ls.resample.make_hdul.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://www.sofia.usra.edu/"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.instruments.fifi_ls.resample.perform_scan_reduction.html" title="perform_scan_reduction">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.instruments.fifi_ls.resample.make_hdul.html" title="make_hdul">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev0</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/fifils/developers/developers.html" accesskey="U">FIFI-LS Redux Developer’s Manual</a> &#187;</li>
      
      <li>resample</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="resample">
<h1>resample<a class="headerlink" href="#resample" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.instruments.fifi_ls.resample.resample">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.instruments.fifi_ls.resample.</span></span><span class="sig-name descname"><span class="pre">resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filenames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_wave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctype1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RA---TAN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctype2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DEC--TAN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctype3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'WAVE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oversample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_weighting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_uncorrected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_coordinates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">naif_id_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NAIF_ID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">insert_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/fifi_ls/resample.html#resample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.fifi_ls.resample.resample" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample unevenly spaced FIFI-LS pixels to regular grid.</p>
<p>Spatial and spectral pixels from all dither positions are
resampled onto a regular grid.</p>
<p>The procedure is:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Read input files</p></li>
<li><p>Define output grid based on input parameter values or values from
file data.</p></li>
<li><p>Resample data: perform local polynomial fits at each
output grid point.</p></li>
<li><p>Correct flux for change to pixel size.  Factor is new pixel area
(dx^2) / input pixel size (12” red, 6” blue).</p></li>
<li><p>Update header for new WCS, from OBSRA/OBSDEC and offsets, Update
PROCSTAT to LEVEL_4 if input data comes from multiple missions.</p></li>
<li><p>Create FITS file and write results to disk.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filenames</strong><span class="classifier">array_like of str</span></dt><dd><p>File paths to FITS data to be resampled.</p>
</dd>
<dt><strong>target_x</strong><span class="classifier">float, optional</span></dt><dd><p>The target right ascension (hourangle).  The default is the mid-point
of all RA values in the combined data.</p>
</dd>
<dt><strong>target_y</strong><span class="classifier">float, optional</span></dt><dd><p>The target declination (degree).  The default is the mid-point of all
DEC values in the combined data.</p>
</dd>
<dt><strong>target_wave</strong><span class="classifier">float, optional</span></dt><dd><p>The center wavelength (um).  The default is the mid-point of all
wavelength values in the combined data.</p>
</dd>
<dt><strong>ctype1</strong><span class="classifier">str, optional</span></dt><dd><p>The coordinate frame for the x spatial axis using FITS standards.</p>
</dd>
<dt><strong>ctype2</strong><span class="classifier">str, optional</span></dt><dd><p>The coordinate frame for the y spatial axis using FITS standards.</p>
</dd>
<dt><strong>ctype3</strong><span class="classifier">str, optional</span></dt><dd><p>The coordinate frame for the w spectral axis using FITS standards.</p>
</dd>
<dt><strong>interp</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, alternate algorithm will be used for spatial resampling
(interpolation / mean combine, rather than local polynomial fits).</p>
</dd>
<dt><strong>oversample</strong><span class="classifier">array_like of int or float, optional</span></dt><dd><p>Number of pixels to sample mean FWHM with, in the
(spatial, spectral) dimensions.
Default is (5.0, 8.0).</p>
</dd>
<dt><strong>spatial_size</strong><span class="classifier">float, optional</span></dt><dd><p>Output pixel size, in the spatial dimensions.
Units are arcsec.  If specified, the corresponding oversample
parameter will be ignored.</p>
</dd>
<dt><strong>spectral_size</strong><span class="classifier">float, optional</span></dt><dd><p>Output pixel size, in the spectral dimension.
Units are um.  If specified, the corresponding oversample
parameter will be ignored.</p>
</dd>
<dt><strong>window</strong><span class="classifier">array_like of float, optional</span></dt><dd><p>Region to consider for local polynomial fits, given as a factor
of the mean FWHM, in the (x, y, w) dimensions. Default is
(3.0, 3.0, 0.5).</p>
</dd>
<dt><strong>adaptive_threshold</strong><span class="classifier">array_like of float, optional</span></dt><dd><p>If &gt; 0, determines how the adaptive smoothing algorithm
will attempt to fit data.  The optimal value is 1.  Will
automatically enable both distance and error weighting.  For
dimensions that have adaptive smoothing enabled, <code class="xref py py-obj docutils literal notranslate"><span class="pre">smoothing</span></code>
should be set to the Gaussian width of the data in units of <code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code>.
For other dimensions not using adaptive smoothing, <code class="xref py py-obj docutils literal notranslate"><span class="pre">smoothing</span></code>
has the usual definition. Adaptive smoothing is disabled by
default: (0.0, 0.0, 0.0).</p>
</dd>
<dt><strong>adaptive_algorithm</strong><span class="classifier">{‘scaled’, ‘shaped’}, optional</span></dt><dd><p>Determines the type of variation allowed for the adaptive kernel.
If ‘scaled’, only the kernel size is allowed to vary.  If ‘shaped’,
kernel shape may also vary.</p>
</dd>
<dt><strong>error_weighting</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, errors will be used to weight the flux fits.</p>
</dd>
<dt><strong>smoothing</strong><span class="classifier">array_like of float, optional</span></dt><dd><p>Radius over which to smooth the input data, specified as a
factor of the mean FWHM, if distance weights are being used.
Default is (2.0, 2.0, 0.25).</p>
</dd>
<dt><strong>order</strong><span class="classifier">array_like or int, optional</span></dt><dd><p>(nfeatures,) array of single integer value specifying the
polynomial fit order for each dimension (x, y, w).</p>
</dd>
<dt><strong>robust</strong><span class="classifier">float, optional</span></dt><dd><p>Rejection threshold for input data to local fits, given as a
factor of the standard deviation.</p>
</dd>
<dt><strong>neg_threshold</strong><span class="classifier">float, optional</span></dt><dd><p>First-pass rejection threshold for negative input data, given
as a factor of the standard deviation; if None or &lt;= 0,
first-pass rejection will not be performed.</p>
</dd>
<dt><strong>fit_threshold</strong><span class="classifier">float, optional</span></dt><dd><p>Rejection threshold for output fit values, given as a factor
of the standard deviation in the input data.  If exceeded,
weighted mean value is used in place of fit.</p>
</dd>
<dt><strong>edge_threshold</strong><span class="classifier">float or array_like or float</span></dt><dd><p>If set to a value &gt; 0 and &lt; 1, edges of the fit will be masked out
according to <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_algorithm</span></code>. Values close to zero will result in
a high degree of edge clipping, while values close to 1 ckip edges
to a lesser extent. The clipping threshold is a fraction of window.
An array may be used to specify values for each dimension.</p>
</dd>
<dt><strong>append_weights: bool, optional</strong></dt><dd><p>If set, distance weights will be appended as an additional
extension.</p>
</dd>
<dt><strong>skip_uncorrected: bool, optional</strong></dt><dd><p>If set, the uncorrected flux cube will not be computed, even
if present in the input data.  This option is primarily intended
for testing or quicklook, when the full data product is not needed.</p>
</dd>
<dt><strong>write</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, write to disk and return the path to the output
file.  The output filename is created from the input filename,
with the product type suffix replaced with ‘WXY’.</p>
</dd>
<dt><strong>outdir</strong><span class="classifier">str, optional</span></dt><dd><p>Directory path to write output.  If None, output files
will be written to the same directory as the input files.</p>
</dd>
<dt><strong>jobs</strong><span class="classifier">int, optional</span></dt><dd><p>Specifies the maximum number of concurrently running jobs.
Values of 0 or 1 will result in serial processing.  A negative
value sets jobs to <code class="xref py py-obj docutils literal notranslate"><span class="pre">n_cpus</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">jobs</span></code> such that -1 would use
all cpus, and -2 would use all but one cpu.</p>
</dd>
<dt><strong>check_memory</strong><span class="classifier">bool, optional</span></dt><dd><p>If set, expected memory use will be checked and used to limit
the number of jobs if necessary.</p>
</dd>
<dt><strong>scan_reduction</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, run a scan reduction first before performing the resampling
step.  This may be a very time consuming operation, but may also remove
many correlated noise signals from the data.</p>
</dd>
<dt><strong>save_scan</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the output from the scan algorithm, prior to resampling,
will be saved to disk.</p>
</dd>
<dt><strong>scan_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Optional keyword arguments to pass into the scan reduction.</p>
</dd>
<dt><strong>detector_coordinates</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, reduce using detector coordinates instead of RA/DEC.  if
<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, will attempt to auto-detect based on OBSLAM/OBSDEC header
values (<a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> if all OBSLAM/DEC = 0, <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> otherwise).</p>
</dd>
<dt><strong>naif_id_key</strong><span class="classifier">str, optional</span></dt><dd><p>The name of the NAIF ID keyword.  If present in the header, should
indicate the associated file contains a nonsidereal observation.</p>
</dd>
<dt><strong>insert_source</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, will perform a full scan reduction (if applicable) and
reinsert the source after.  Otherwise, the reduction is used to
calculate gains, offsets, and correlations which will then be
applied to the original data. If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, note that timestream
filtering will not be applied to the correction and should therefore
be excluded from the scan reduction runtime parameters in order to
reduce processing pressure.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>fits.HDUList or str</dt><dd><p>Either the HDU (if write is False) or the filename of the output
file (if write is True).  The output contains the following
extensions: FLUX, ERROR, WAVELENGTH, X, Y, RA, DEC,
TRANSMISSION, RESPONSE, EXPOSURE_MAP.  The following extensions
will be appended if possible: UNCORRECTED_FLUX, UNCORRECTED_ERROR,
UNSMOOTHED_TRANSMISSION.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">resample</a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.fifi_ls.resample.resample"><code class="docutils literal notranslate"><span class="pre">resample()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.instruments.fifi_ls.resample.resample.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.1.2. &nbsp;
    Last built 13 Aug 2023. <br/>
  </p>
</footer>
  </body>
</html>